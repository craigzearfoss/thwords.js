$(document).ready(function(){$(".game-link").on("click",function(e){return ga("Game","select",$(this).data("id")+": "+$(this).data("name")),!0});var e=document.location.toString();$("#embed-link").val('<iframe height="440" width="420" src="'+e+(e.indexOf("?")<0?"?":"&")+'e=1" frameborder="0" allowfullscreen></iframe>'),$("#btn-embed-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-embed",$("#embed-link").val())}catch(n){}$("#container-link-link").hide(),$("#container-embed-link").show(),$("#embed-link").select()}),$("#close-embed-link").on("click",function(e){e.preventDefault(),$("#container-embed-link").hide()});var t=document.location.toString();$("#link-link").val(t+(t.indexOf("?")<0?"?":"&")+"s=1"),$("#btn-link-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-link",$("#link-link").val())}catch(n){}$("#container-embed-link").hide(),$("#container-link-link").show(),$("#link-link").select()}),$("#close-link-link").on("click",function(e){e.preventDefault(),$("#container-link-link").hide()})}),$(document).ready(function(){!function(){function e(e){if(!e)return"";for(var t="",o=0;o<e.length;o++)t+=uo[e.charAt(o)]||e.charAt(o);return t}function t(){yo.addToTotal("move",1),yo.addToCount("move",1),yo.setProperty("move-remaining",yo.move.max-yo.move.total),yo.store(),yo.setProperty("hitStreak-current",yo.hitStreak.current+1,!0),mo.hitStreak.current>mo.hitStreak["long"]&&yo.setProperty("hitStreak-long",yo.hitStreak["long"]+1,!0),ae()}function o(e){var e=parseInt(e);try{yo.addToCount("point",e)}catch(t){console.log(t),ho.ga("Error","addPoints",t.toString())}ae()}function n(){for(var e=!0,t=0;t<yo.thwords.tls.length;t++)s(t)||(e=!1);return e}function s(e,t){t=t||!1;try{for(var o=0;o<yo.thwords.tls[e].length;o++)if(!yo.thwords.tls[e][o].s)return t&&$("#answer-"+e).removeClass("solved").addClass("wrong"),!1}catch(n){console.log(n),ho.ga("Error","allTilesSolved",n.toString())}return $("#answer-"+e).hasClass("solved")||($("#answer-"+e).addClass("solved"),yo.addToCount("thword",1,!0)),$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show"),!0}function a(){window.onbeforeunload=function(){return!$.isEmptyObject(mo)&&"undefined"!=typeof mo.status&&mo.status?"If you leave this page you will lose your current game?":void 0},$(".quit-game").on("click",function(e){e.preventDefault(),te()}),$(".save-and-exit-game").on("click",function(e){e.preventDefault(),ke()}),$(".select-foreign-thword").on("click",function(e){e.preventDefault(),Co(this)}),$(".start-game").on("click",function(e){e.preventDefault(),Ve(this)&&Ge()}),je()}function r(){$("#btn-close-ad").on("click",function(e){e.preventDefault(),$("#ad-content").removeClass("show").addClass("hide"),$("#overlay-ad").removeClass("show").addClass("hide")}),$("#btn-topic-feedback-cancel").on("click",function(e){e.preventDefault(),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}),$("#btn-topic-feedback-submit-comment").on("click",function(e){e.preventDefault();try{yo.ga(yo.id+": "+yo.name,"topic-comment",yo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-comment").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-feedback-submit-problem").on("click",function(e){e.preventDefault();try{yo.ga(yo.id+": "+yo.name,"topic-problem",yo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-problem").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-dislike").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?z("You already said you liked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?z("You already said you dislike this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof yo.topic.id&&yo.topic.id>0&&(yo.ga(yo.id+": "+yo.name,"topic-dislike",yo.topic.id+": "+yo.topic.name),z("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-like").addClass("disabled"))}catch(t){}}),$("#btn-topic-like").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?z("You already said you disliked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?z("You already said you like this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof yo.topic.id&&yo.topic.id>0&&(yo.ga(yo.id+": "+yo.name,"topic-like",yo.topic.id+": "+yo.topic.name),z("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-dislike").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-easy").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?(z("You already said this topic was too hard.",{type:"fail",timeout:2e3}),alert("You already said this topic was too hard.")):$(this).hasClass("clicked")?z("You already said this topic was too easy.",{type:"fail",timeout:2e3}):("undefined"!=typeof yo.topic.id&&yo.topic.id>0&&(yo.ga(yo.id+": "+yo.name,"topic-too-easy",yo.topic.id+": "+yo.topic.name),z("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-hard").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-hard").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?z("You already said this topic was too easy.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?z("You already said this topic was too hard.",{type:"fail",timeout:2e3}):("undefined"!=typeof yo.topic.id&&yo.topic.id>0&&(yo.ga(yo.id+": "+yo.name,"topic-too-hard",yo.topic.id+": "+yo.topic.name),z("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-easy").addClass("disabled"))}catch(t){}}),$("#btn-topic-comment").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?z("You have already submitted a comment on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("hide").addClass("show"),$("#topic-feedback-instr-problem").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-comment").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-problem").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#btn-topic-problem").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?z("You have already reported a problem on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("show").addClass("hide"),$("#topic-feedback-instr-problem").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-comment").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-problem").removeClass("hide").addClass("show"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#hamburger").on("click",function(e){e.preventDefault(),J()}),$("#menuContentLayer").on("click",function(e){e.preventDefault(),p()}),$(".new-game").on("click",function(e){Yt()}),$(".overlay-continue-btn").on("click",function(e){e.preventDefault(),Z()}),$(".play-topic-again").on("click",function(e){e.preventDefault(),W()}),$(".process-char").on("click",function(e){e.preventDefault(),$(this).data("idx")&&V($(this).data("idx"))}),$(".show-about-overlay").on("click",function(e){e.preventDefault(),Le()}),$(".show-bonus").on("click",function(e){e.preventDefault(),Y()}),$(".show-debug-data-overlay").on("click",function(e){e.preventDefault(),Pe()}),$(".show-game-stats-overlay").on("click",function(e){e.preventDefault(),Me()}),$(".show-general-feedback-overlay").on("click",function(e){e.preventDefault(),_e()}),$(".show-help-overlay").on("click",function(e){e.preventDefault(),Ee()}),$(".show-high-scores-overlay").on("click",function(e){e.preventDefault(),qe()}),$(".show-round-stats-overlay").on("click",function(e){e.preventDefault(),Be()}),$(".show-settings-overlay").on("click",function(e){e.preventDefault(),Qe()}),$(".show-tile-values-overlay").on("click",function(e){e.preventDefault(),Fe()}),$(".visit-thwords-com").on("click",function(e){e.preventDefault(),window.open("http://thwords.com"),p()})}function l(){return"undefined"==typeof yo.bonusQuestions||"undefined"==typeof yo.bonusQuestions.questions?0:yo.bonusQuestions.questions.length}function c(){n()?nt():yo.move.total>=yo.move.max&&H()}function d(){var e=new Date;e.setTime(e.getTime()-288e5),$.cookie("Woggle-play",null,{path:"/",expires:e}),$.cookie("Woggle-round",null,{path:"/",expires:e}),$.cookie("Woggle-game",null,{path:"/",expires:e})}function u(){$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),$("#overlay-div-container").removeClass().addClass("standard").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",pt.overlayBackgroundOpacity)}function p(){$("#container").unbind("touchmove"),$("#container").animate({marginLeft:["-1","easeOutExpo"]},{duration:700,complete:function(){$("#content").css("width","auto"),$("#menuContentLayer").css("display","none"),$("nav").css("opacity",0),$("#content").css("min-height","auto"),$("nav").css("display","none")}})}function h(){z("Loading Categories ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+ho.getApiDomain()+so.replace(/\/$/,"")+"/category/get?callback=?&rn=1&mx=3&gi="+yo.id+"&al="+yo.lang+"&sl="+yo.adjustedSkillLevel()+"&kl="+yo.adjustedKnowledgeLevel();ho.ga("API",ho.getApiDomain(),e),yo.ga(yo.id+": "+yo.name,"fetch-categories","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=ce(e);$("#game-panel-choose").html(t),$(".select-category").bind("click",function(e){e.preventDefault(),$o(this)}),De("choose",!0),mo.status>0&&De("score",!1),X()},error:function(t){console.log("Get Error 1000: url: "+e),ho.ga("Error","createCategorySelectList","url: "+e),confirm("Could not fetch categories. Try again?")&&(ho.nextApiDomain(),h())}})}function g(){z("Loading Lessons ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+ho.getApiDomain()+so.replace(/\/$/,"")+"/lesson/get?callback=?&rn=1&mx=3&gi="+yo.id+"&al="+yo.lang+"&sl="+yo.adjustedSkillLevel()+"&kl="+yo.adjustedKnowledgeLevel();ho.ga("API",ho.getApiDomain(),e),yo.ga(yo.id+": "+yo.name,"fetch-lessons","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=de(e);$("#game-panel-choose").html(t),$(".select-subject").bind("click",function(e){e.preventDefault(),wo(this)}),De("choose",!0),mo.status>0&&De("score",!1),X()},error:function(t){console.log("Get Error 1001: url: "+e),ho.ga("Error","createLessonSelectList","url: "+e),confirm("Could not fetch lessons. Try again?")&&(ho.nextApiDomain(),g())}})}function f(){z("Loading Subjects ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+ho.getApiDomain()+so.replace(/\/$/,"")+"/subject/get?callback=?rn=1&mx=3&gi="+yo.id+"&al="+yo.lang+"&sl="+yo.adjustedSkillLevel()+"&kl="+yo.adjustedKnowledgeLevel()+"&ci="+(0===yo.category.choose?0:yo.category.id);ho.ga("API",ho.getApiDomain(),e),yo.ga(yo.id+": "+yo.name,"fetch-subjects","url: "+e),e+="?"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&yo.category.choose>0)yo.ga("Warning","no-subjects-found-for-category","url: "+e),alert("No subjects found.\n\nPlease select another category."),h();else if($.isEmptyObject(t))confirm("No subjects found.\n\nTry again?")&&(ho.nextApiDomain(),f());else{var o=ue(t);$("#game-panel-choose").html(o),$(".select-subject").bind("click",function(e){e.preventDefault(),ko(this)}),De("choose",!0),mo.status>0&&De("score",!1),X()}},error:function(t){console.log("Get Error 1002: url: "+e),ho.ga("Error","createSubjectSelectList","url: "+e),confirm("Could not fetch subjects. Try again?")&&(ho.nextApiDomain(),f())}})}function m(){z("Loading Topics ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+ho.getApiDomain()+so.replace(/\/$/,"")+"/topic/get?callback=?&rn=1&mx=3&gi="+yo.id+"&al="+yo.lang+"&sl="+yo.adjustedSkillLevel()+"&kl="+yo.adjustedKnowledgeLevel()+"&ci="+(0===yo.category.choose?0:yo.category.id)+"&ui="+(0===yo.subject.choose?0:yo.subject.id);ho.ga("API",ho.getApiDomain(),e),yo.ga(yo.id+": "+yo.name,"fetch-topics","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&yo.subject.choose>0)yo.ga("Warning","no-topic-found-for-subject","url: "+e),alert("No topics found.\n\nPlease select another subject."),f();else if($.isEmptyObject(t)&&yo.subject.choose>0)yo.ga("Warning","no-topic-found-for-category","url: "+e),alert("No topics found.\n\nPlease select another category."),h();else if($.isEmptyObject(t))confirm("No topics found.\n\nTry again?")&&(ho.nextApiDomain(),m());else{var o=pe(t);$("#game-panel-choose").html(o),$(".select-topic").bind("click",function(e){e.preventDefault(),Co(this)}),De("choose",!0),mo.status>0&&De("score",!1),X()}},error:function(t){console.log("Get Error 1003: url: "+e),ho.ga("Error","createTopicSelectList","url: "+e),confirm("Could not fetch topics. Try again?")&&(ho.nextApiDomain(),m())}})}function v(e){for(var t=e.slice(0).sort(),o=[],n=0;n<e.length-1;n++)t[n+1]==t[n]&&o.push(t[n]);return o.length>0?!0:!1}function y(e){e=e||{},z("Loading Thwords ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var t="http://"+ho.getApiDomain()+so.replace(/\/$/,"")+"/game-play/get?callback=?&gi="+yo.id+"&sl="+yo.skillLevel+"&kl="+yo.knowledgeLevel+"&ci="+(yo.getProperty("category-choose")<0?yo.getProperty("category-id"):e.category_id||0)+"&ui="+(yo.getProperty("subject-choose")<0?yo.getProperty("subject-id"):e.subject_id||0)+"&ti="+(yo.getProperty("topic-choose")<0?yo.getProperty("topic-id"):e.topic_id||0)+"&li="+(yo.getProperty("lesson-choose")<0?yo.getProperty("lesson-id"):e.lesson_id||0)+"&al="+yo.lang;ho.ga("API",ho.getApiDomain(),t),yo.ga(yo.id+": "+yo.name,"fetch-play","url: "+t),t+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:t,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){z("Creating Tiles ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0}),F(e),X()},error:function(o){console.log("Get Error 1004: url: "+t),ho.ga("Error","fetchPlay","url: "+t),confirm("Could not fetch Thwords. Try again?")&&(ho.nextApiDomain(),y(e))}})}function b(){for(var e=ho.tileFlipDelay,t=0;t<yo.thwords.tls.length;t++)for(var o=0;o<yo.thwords.tls[t].length;o++)yo.thwords.tls[t][o].f&&(ho.tileFlipDelay?(no.push([t,o]),setTimeout(function(){Oe()},e),e+=ho.tileFlipDelay):w(t,o))}function w(e,t){var n=(yo.thwords.tls[e][t].l||"??",yo.thwords.tls[e][t].v||0);$("#tile-"+e+"-"+t).addClass("solved"),yo.push("tile-flipped",[e,t],!1),Ue(e,t),o(n)}function k(){mo.ga(mo.id+": "+mo.name,"game-over","points: "+mo.point.count+", rounds: "+vo.count+", plays: "+yo.count),mo.setProperty("status",0),mo.setProperty("save-status",0),se(),Se("new-game",!0),R(Mustache.render(wt,{title:"Game Over",details:""})+he(),{type:"fail"})}function C(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)}),t=new Date;return t.setTime(t.getTime()+63072e6),$.cookie("Thwords-Session",e,{path:"/",expires:t}),e}function x(){return'<iframe height="440" width="420" src="'+q({e:1})+'" frameborder="0" allowfullscreen></iframe>'}function j(e){var t={};return $.each(ut,function(o,n){if(n.id==e)for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])}),t}function T(e){for(var t=0;t<oo.length;t++)if(e==oo[t].value)return oo[t].abbrev;return"?"}function O(e){for(var t=0;t<oo.length;t++)if(e==oo[t].value)return oo[t].name;return"?"}function L(e){return"undefined"!=typeof Zt[e]?Zt[e]:!1}function S(){var e=[];return $.each(Zt,function(t,o){"en"!=t&&(e[e.length]={value:t,name:o})}),e}function P(e){e=e||7;var t=I(e);return j(t)}function I(e){return e=e||7,5==e?Vt[Math.floor(Math.random()*Vt.length)]:[6,8].indexOf(e)>-1?4:Kt[Math.floor(Math.random()*Kt.length)]}function D(){return 4==yo.getProperty("id")?mo.getProperty("abbrev")+": "+L(yo.getProperty("lang"))+" Thwords":mo.getProperty("abbrev")+": "+yo.getProperty("name")}function _(){return 4==yo.getProperty("id")?mo.getProperty("abbrev")+": "+L(yo.getProperty("lang")):mo.getProperty("abbrev")+": "+yo.getProperty("shortName")}function E(e){return e=e||eo,e[Math.floor(Math.random()*e.length)]}function q(e){parms=e||{},"undefined"==typeof mo||$.isEmptyObject(mo)||("undefined"!=typeof mo.lang&&mo.lang.length>0&&(e.al=mo.lang),"undefined"!=typeof mo.skillLevel&&parseInt(mo.skillLevel)>0&&(e.sl=mo.skillLevel),"undefined"!=typeof mo.knowledgeLevel&&parseInt(mo.knowledgeLevel)>0&&(e.kl=mo.knowledgeLevel),"undefined"!=typeof mo.category.choose&&parseInt(mo.category.choose)<0&&parseInt(mo.category.id)>0&&(e.cc=-1,e.ci=mo.category.id),"undefined"!=typeof mo.subject.choose&&parseInt(mo.subject.choose)<0&&parseInt(mo.subject.id)>0&&(e.uc=-1,e.ui=mo.subject.id),"undefined"!=typeof mo.topic.choose&&parseInt(mo.topic.choose)<0&&parseInt(mo.topic.id)>0&&(e.tc=-1,e.ti=mo.topic.id),"undefined"!=typeof mo.lesson.choose&&parseInt(mo.lesson.choose)<0&&parseInt(mo.lesson.id)>0&&(e.lc=-1,e.li=mo.lesson.id),Xt.indexOf(mo.id)>-1&&"undefined"!=typeof go.langs&&(e.ap=go.langs.join("|")));var t=document.location.toString().split(/[?#]/)[0];if(t=t.replace("/next/","/play/"),!$.isEmptyObject(e)){var o="";$.each(e,function(e,t){o+="&"+e+"="+encodeURIComponent(t)}),o.length>0&&(t+=(t.indexOf("?")<0?"?":"&")+o.substr(1))}return t}function N(e){for(var t=0;t<to.length;t++)if(e==to[t].value)return to[t].abbrev;return"?"}function Q(e){for(var t=0;t<to.length;t++)if(e==to[t].value)return to[t].name;return"?"}function M(e){for(var t=window.location.search.substring(1),o=t.split("&"),n=0;n<o.length;n++){var s=o[n].split("=");if(s[0]==e)return decodeURIComponent(s[1])}return null}function B(e){e=e||!1;for(var t=window.location.search.substring(1),o=t.split("&"),n=[],s={},a=0;a<o.length;a++){var i=o[a].split("=");if("undefined"!=typeof i[0]&&i[0].length>0){if("ap"==i[0])var r=decodeURIComponent(i[1]).split("|");else var r=decodeURIComponent(i[1]);n[n.length]={name:i[0],value:r},s[i[0]]=r}}return e?s:n}function A(e){$("#game-panel-"+e).removeClass("show").addClass("hide")}function F(e){if(!$.isEmptyObject(e)){try{"undefined"!=typeof e.ti&&parseInt(e.ti)>0&&yo.ga(yo.id+": "+yo.name,"load-topic",e.ti+": "+("undefined"!=typeof e.tn?e.tn:"")),"undefined"!=typeof e.ui&&parseInt(e.ui)>0&&yo.ga(yo.id+": "+yo.name,"load-subject",e.ui+": "+("undefined"!=typeof e.un?e.un:"")),"undefined"!=typeof e.ci&&parseInt(e.ci)>0&&yo.ga(yo.id+": "+yo.name,"load-category",e.ci+": "+("undefined"!=typeof e.cn?e.cn:"")),"undefined"!=typeof e.li&&parseInt(e.li)>0&&yo.ga(yo.id+": "+yo.name,"load-lesson",e.li+": "+("undefined"!=typeof e.ln?e.ln:""))}catch(t){try{yo.ga(yo.id+": "+yo.name,"loadPlay",t.toString()+", data: "+JSON.stringify(e))}catch(t){}}"undefined"!=typeof e.tz&&!$.isEmptyObject(e.tz),"undefined"!=typeof e.qz&&!$.isEmptyObject(e.qz),"undefined"!=typeof e.su&&!$.isEmptyObject(e.su);var o={category:{id:yo.category.id,count:yo.category.count},lesson:{id:yo.lesson.id,count:yo.lesson.count},subject:{id:yo.subject.id,count:yo.subject.count},topic:{id:yo.topic.id,count:yo.topic.count}};for(var n in e)if(e.hasOwnProperty(n))switch(n){case"pt":yo.setProperty("point-total",0,!1,!1),yo.addToTotal("point",e[n],!0,!1);break;case"zt":yo.setProperty("thword-total",0,!1,!1),yo.addToTotal("thword",e[n],!0,!1);break;default:yo.setProperty(n,e[n],!1,!1)}o.category.id>0&&yo.category.id==o.category.id?yo.addToCount("category",1):(yo.setProperty("category-count",1),yo.category.played.indexOf(yo.category.id)<0&&yo.push("category-played",yo.category.id)),o.lesson.id>0&&yo.lesson.id==o.lesson.id?yo.addToCount("lesson",1):(yo.setProperty("lesson-count",1),yo.lesson.played.indexOf(yo.lesson.id)<0&&yo.push("lesson-played",yo.lesson.id)),o.subject.id>0&&yo.subject.id==o.subject.id?yo.addToCount("subject",1):(yo.setProperty("subject-count",1),yo.subject.played.indexOf(yo.subject.id)<0&&yo.push("subject-played",yo.subject.id)),o.topic.id>0&&yo.topic.id==o.topic.id?yo.addToCount("topic",1):(yo.setProperty("topic-count",1),yo.topic.played.indexOf(yo.topic.id)<0&&yo.push("topic-played",yo.topic.id)),mo.store(),vo.store(),yo.store()}De("topic",!0),De("score"),$.isEmptyObject(yo.thwords)?$.isEmptyObject(yo.quiz)?alert("No Thwords or quizzes found."):alert("QUIZ - these have not been implemented yet."):(yo.adjustedBonusOn()&&($.isEmptyObject(yo.bonusQuestions)||"undefined"==typeof yo.bonusQuestions.q||0===yo.bonusQuestions.q.length)&&yo.generateBonusQuestions(),xe(),De("chars"),Ce(),De("answers"),b()),mo.store(),vo.store(),yo.store()}function H(){yo.ga(yo.id+": "+yo.name,"play-lose","topic "+yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-play-lose","topic "+yo.topic.id+": "+yo.topic.name),$(".thw-rack").not(".solved-thword").addClass("wrong-thword"),ne();for(var e=0;e<yo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");if(A("chars"),yo.bonus.on>0&&l()>0&&yo.save.status<0){if(yo.setProperty("status",0),yo.setProperty("save-status",1,!0),yo.addToTotal("save",1,!0),l()>1){$("#btn-show-bonus").html("BONUS QUESTIONS");var t="Game Over",o="However, you can continue your game if you answer all of the following bonus questions correctly."}else{$("#btn-show-bonus").html("BONUS QUESTION");var t="Game Over",o="However, you can continue your game if you answer the following bonus question correctly."}var n=Mustache.render(wt,{title:t,details:o});R(n,{type:"fail",position:"top"}),Se("show-bonus",!0)}else De("feedback",!1),we();De("start")}function G(e,t){t=t||!1;var o=yo.thwords.chs[e].m.length;if(!t)for(var n=0;n<yo.thwords.chs[e].m.length;n++){var s=yo.thwords.chs[e].m[n][0],a=yo.thwords.chs[e].m[n][1];yo.thwords.tls[s][a].f&&o--}return o}function Y(){yo.addToTotal("bonus",1,!0);var e=U();if(e){switch(e.type){case"mc":case"tf":case"yn":var t=Mustache.render(Lt,e);break;case"tx":var o=e.answer.indexOf(" ");if(0>o)e.prefix="";else{var n=e.answer.slice(0,o+1);yo.thwords.cs.p.indexOf(n)>-1&&yo.adjustedSkillLevel()<3?(e.prefix=n,e.answer=e.answer.slice(o+1)):e.prefix=""}var t=Mustache.render(St,e);break;default:alert("Invalid question type")}$("#game-panel-bonus").html(t),$.each($(".question-answer"),function(){$(this).removeClass("hide").addClass("show")}),$(".question-answer").bind("click",function(e){$(this).hasClass("done")||(e.preventDefault(),bo(this))}),$("#submit-question-answer").on("click",function(e){e.preventDefault(),Re(this)}),$("#question-response").on("keypress",function(e){13==e.which&&(e.preventDefault(),Re($("#submit-question-answer")))}),$(".next-question").on("click",function(e){e.preventDefault(),Y()}),"tx"==e.type&&$("#question-response").focus(),De("score",!0),De("bonus",!1)}else Ye()}function J(){$("nav").css("display","block"),$("#content").css("min-height",$(window).height()),$("nav").css("opacity",1);var e=$("#content").width();$("#content").css("width",e),$("#menuContentLayer").css("display","block"),$("#container").bind("touchmove",function(e){e.preventDefault()}),$("#container").animate({marginLeft:["30%","easeOutExpo"]},{duration:700})}function z(e,t){$("#overlay-btn-container").hasClass("show")&&X(),t=t||{};var o=t.type||"standard",n=t["class"]||"",s=t.data||{},a=t.clickable||!0,i="undefined"!=typeof t.timeout?t.timeout:ho.overlayButtonDelay,r="undefined"!=typeof t.opacity?t.opacity:pt.overlayBackgroundOpacity,l=document.createElement("button");$(l).attr("id","overlay-btn"),$(l).addClass("btn").addClass("thw-btn").addClass("overlay-btn").addClass(o).addClass("show"),n&&$(l).addClass(n),$(l).html(e),$.each(s,function(e,t){$(l).attr("data-"+e,t)}),a&&$(l).on("click",function(e){X()}),r!==!1&&($("#overlay-background").css("opacity",r),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-btn-container").html("").append(l).removeClass("hide").addClass("show"),i&&(Ut=setTimeout(function(){X()},i))}function R(e,t){t=t||{},ho=ho||{},pt=pt||{};var o=t.type||"standard",n="undefined"!=typeof t.timeout?t.timeout:ho.overlayDivDelay||0,s=t["class"]||"",a=t.data||{},i=t.label||"Continue",r=t.position||"bottom",l=t.bindAction||!1,c=t.hideNav||!1,d="undefined"!=typeof t.opacity?t.opacity:pt.overlayBackgroundOpacity||.5;if(c&&$("#overlay-div-nav").addClass("hide"),$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),"top"==r?$("#overlay-div-content-top").html(e):$("#overlay-div-content").html(e),$("#overlay-continue-btn").text(i),$("#overlay-continue-btn").removeClass().addClass("btn").addClass("thw-btn").addClass("overlay-continue-btn").addClass("show"),s&&$("#overlay-continue-btn").addClass(s),$.each(a,function(e,t){$("#overlay-continue-btn").attr("data-"+e,t)}),d!==!1&&($("#overlay-background").css("opacity",d),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-div-container").removeClass().addClass(o).addClass("show"),s&&$("#overlay-div-container").addClass(s),l)switch(l){}n&&(Wt=setTimeout(function(){Z()},n))}function W(){yo.ga(yo.id+": "+yo.name,"topic-repeat","topic "+yo.topic.id+": "+yo.topic.name),yo.setProperties({status:1,save_status:0}),yo.setProperty("count",yo.count+1),$(".strike-xs").html(""),y({topic_id:yo.topic.id})}function U(){try{if(l()<0)return!1;if("undefined"!=typeof yo.bonusQuestions||"undefined"!=typeof yo.bonusQuestions.questions){if("undefined"==typeof yo.bonusQuestions.idx)return yo.bonusQuestions.idx=99999,!1;if("undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx]&&yo.bonusQuestions.idx<=yo.bonus.total){var e={idx:yo.bonusQuestions.idx,title:yo.bonusQuestions.title?yo.bonusQuestions.title:yo.bonusQuestions.questions.length>0?"Bonus Questions":"Bonus Question",instructions:yo.bonusQuestions.label?yo.bonusQuestions.label:"Select the answer that best matches."};if(e.type="undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx].t?yo.bonusQuestions.questions[yo.bonusQuestions.idx].t:!1,e.question="undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx].q?yo.bonusQuestions.questions[yo.bonusQuestions.idx].q:"",e.answer="undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx].a?yo.bonusQuestions.questions[yo.bonusQuestions.idx].a:"",e.points="undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx].p?yo.bonusQuestions.questions[yo.bonusQuestions.idx].p:1,e.options=[],"undefined"!=typeof yo.bonusQuestions.questions[yo.bonusQuestions.idx].o)for(var t=0;t<yo.bonusQuestions.questions[yo.bonusQuestions.idx].o.length;t++)e.options[e.options.length]={text:yo.bonusQuestions.questions[yo.bonusQuestions.idx].o[t],option:t};return yo.bonusQuestions.idx=yo.bonusQuestions.idx+1,e}return yo.bonus.idx=99999,!1}return!1}catch(o){return console.log(o),ho.ga("Error","popNextBonusQuestion",o.toString()),!1}}function K(e){if("undefined"==typeof e.idx||"undefined"==typeof e.option||"undefined"==typeof e.correct)return yo.ga("Error","bonus-processing-problem",JSON.stringify(e)),alert("Can't process bonus."),!1;switch(idx=e.idx||0,option=e.option||0,correct=e.correct||0,yo.bonusQuestions.questions[idx].t){case"tx":break;case"mc":case"tf":case"yn":default:var t=option==correct?!0:!1;t?$("#question-answer-"+idx+"-"+correct).addClass("correct"):($("#question-answer-"+idx+"-"+option).addClass("wrong"),$("#question-answer-"+idx+"-"+correct).addClass("correct"))}if($.each($(".question-answer"),function(){$(this).addClass("done")}),$("#question-title").addClass("hide"),$("#question-instructions").addClass("hide"),yo.bonusQuestions.idx<yo.bonusQuestions.questions.length)Se("next-question",!0);else if($("#btn-next-question").removeClass("show").addClass("hide"),yo.bonus.count==yo.bonus.total){if(yo.ga(yo.id+": "+yo.name,"bonus-win","topic "+yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-bonus-win","topic "+yo.topic.id+": "+yo.topic.name),yo.save.status>0){yo.ga(yo.id+": "+yo.name,"save-win","topic "+yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-save-win","topic "+yo.topic.id+": "+yo.topic.name),yo.addToCount("save",1,!0),yo.setProperty("save-status",-1,!0);var o=Mustache.render(kt,{});R(o,{msgType:"success","class":"show-start-panel",timeout:0,position:"top"})}Se("next-round",!0),Ne()}else yo.ga(yo.id+": "+yo.name,"bonus-lose","topic "+yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-bonus-lose","topic "+yo.topic.id+": "+yo.topic.name),yo.save.status>0?(yo.ga(yo.id+": "+yo.name,"save-lose","topic "+yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-save-lose","topic "+yo.topic.id+": "+yo.topic.name),yo.setProperty("save-status",0,!0),we()):(Se("next-round",!0),Ne());De("start"),De("feedback",!1)}function V(e){if("undefined"==typeof e)return!1;lt=!0,yo.push("char-played",e,!1);var n=ho.tileFlipDelay;if(G(e)>0){t();for(var s=0;s<yo.thwords.chs[e].m.length;s++)ho.tileFlipDelay?(no.push([yo.thwords.chs[e].m[s][0],yo.thwords.chs[e].m[s][1]]),setTimeout(function(){Oe()},n),n+=ho.tileFlipDelay):w(yo.thwords.chs[e].m[s][0],yo.thwords.chs[e].m[s][1])}else{ze();var a=yo.thwords.chs[e].v-11;o(a)}0==no.length&&yo.status>0&&c(),lt=!1}function X(){clearTimeout(Ut),$("#overlay-btn-container").removeClass("show").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",pt.overlayBackgroundOpacity);var e=$("#overlay-btn");$(e).hasClass("process-char")&&"undefined"!=typeof $(e).attr("data-idx")?V($(e).data("idx")):$(e).hasClass("process-bonus")&&"undefined"!=typeof $(e).attr("data-correct")&&K({idx:$(e).data("idx"),option:$(e).data("option"),correct:$(e).data("correct")})}function Z(){clearTimeout(Wt),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-div-container").removeClass("show").addClass("hide"),$("#overlay-div-nav").removeClass("hide"),$("#overlay-continue-btn").hasClass("process-char")&&"undefined"!=typeof $("#overlay-continue").attr("data-idx")?V($("#overlay-continue-btn").data("idx")):$("#overlay-continue-btn").hasClass("next-round")?Ye():$("#overlay-continue-btn").hasClass("show-start-panel")&&De("start"),u()}function ee(){var e=B();if(e.length>0){ho.validationOff(),mo.validationOff(),vo.validationOff(),yo.validationOff();for(var t=0;t<e.length;t++)ho.setProperty(e[t].name,e[t].value,!0),yo.setProperty(e[t].name,e[t].value,!0);ho.validationOn(),mo.validationOn(),vo.validationOn(),yo.validationOn()}}function te(){
    p(),confirm("If you quit you will lose your current game.\n\nIf you want to keep your game use the Save and Exit option. \n\nAre you sure you want to quit?")&&(yo.ga(yo.id+": "+yo.name,"game-quit","points: "+mo.point.total+", rounds: "+vo.count+", plays: "+yo.count),se(),yo.setProperty("status",0,!0),yo.setProperty("save-status",0,!0),d(),document.location.href="/play")}function oe(e,t){var o=yo.thwords.tls[e][t].l||"??";yo.thwords.tls[e][t].v||0;$("#tile-"+e+"-"+t).first().html(o)}function ne(){for(var e=(ho.tileFlipDelay,0);e<yo.thwords.tls.length;e++){for(var t=0;t<yo.thwords.tls[e].length;t++)0==yo.thwords.tls[e][t].s&&oe(e,t);s(e,!0)}}function se(){try{var e={gi:mo.id,gg:mo.slug,gr:mo.random,sa:mo.status,cc:mo.category.choose,ci:mo.category.choose<0?mo.category.id:0,uc:mo.subject.choose,ui:mo.subject.choose<0?mo.subject.id:0,tc:mo.topic.choose,ti:mo.lesson.choose<0?mo.topic.id:0,lc:mo.lesson.choose,li:mo.lesson.choose<0?mo.lesson.id:0,pb:mo.bonus.on,rd:yo.count,al:mo.lang,sl:mo.skillLevel,kl:mo.knowledgeLevel,zt:mo.thword.total,zc:mo.thword.count,zp:mo.thword.percent,mm:mo.move.max,mt:mo.move.total,mc:mo.move.count,mp:mo.move.percent,pt:mo.point.total,pc:mo.point.count,pp:mo.point.percent,bt:mo.bonus.total,bc:mo.bonus.count,bp:mo.bonus.percent,ps:mo.save.on,st:mo.save.total,sc:mo.save.count,sp:mo.save.percent,hc:mo.hitStreak.current,hl:mo.hitStreak["long"],uid:go.id,uun:go.username,una:go.name,uem:go.email,sid:go.sessionId,gid:fo.id,gna:fo.name};try{yo.ga(yo.id+": "+yo.name,"record-stats","data: "+JSON.stringify(e))}catch(t){}statsDomain=ho.getStatsDomain();var o="http://"+statsDomain+so.replace(/\/$/,"")+"/results/save?callback=?";ho.ga("API",statsDomain,o),$.ajax({type:"POST",url:o,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",data:e,success:function(e){console.log("Game successfully recorded.")},error:function(t){try{yo.ga("Error","record-stats","data: "+JSON.stringify(e))}catch(t){}console.log("Record Stats Error:")}})}catch(t){console.log(t),ho.ga("Error","recordFinalStats",t.toString())}}function ae(){mo.point.count<0?$(".game-point-count").each(function(){$(this).addClass("negative")}):$(".game-point-count").each(function(){$(this).removeClass("negative")}),$("#moves-left").removeClass("txt-fail").removeClass("txt-danger"),parseInt(yo.move.remaining)<2?$("#moves-left").addClass("txt-fail"):parseInt(yo.move.remaining)<3&&$("#moves-left").addClass("txt-danger"),$(".round-moves-left-text").text(1==parseInt(yo.move.remaining)?"move left":"moves left");var e="";for(i=0;i<yo.move.strikes;i++)e+="X";$(".strike-xs").html(e)}function ie(){var e={version:ct,copyright:dt};return Mustache.render(ht,e)}function re(){if($.isEmptyObject(yo)||$.isEmptyObject(yo.thwords)||"undefined"==typeof yo.thwords.ans)alert("Thword answers not found.");else for(var e={answers:[]},t=0;t<yo.thwords.ans.length;t++)e.answers[e.answers.length]={idx:t,answer:yo.thwords.ans[t],aux1:yo.thwords.aux1[t],aux2:yo.thwords.aux2[t],tileRack:ye(t)};return Mustache.render(gt,e)}function le(){var e={chars:[]};return $.isEmptyObject(yo)||$.isEmptyObject(yo.thwords.chs)||$.each(yo.thwords.chs,function(t,o){e.chars[e.chars.length]={idx:t,label:o.l,"class":1==o.f?" chosen":""},1==o.f&&yo.push("char-played",t,!1)}),Mustache.render(ft,e)}function ce(e){var t=0,o={categories:e,lang:yo.lang,idx:function(){return t++}};return Mustache.render(mt,o)}function de(e){var t=0,o={lessons:e,lang:yo.lang,idx:function(){return t++}};return Mustache.render(vt,o)}function ue(e){var t=0,o={subjects:e,lang:yo.lang,idx:function(){return t++}};return Mustache.render(yt,o)}function pe(e){var t=0,o={topics:e,lang:yo.lang,idx:function(){return t++}};return Mustache.render(bt,o)}function he(){var e={rounds:vo.count,plays:yo.count,thword:{total:mo.thword.total,count:mo.thword.count,percent:0!=mo.thword.total?parseFloat(mo.thword.percent).toFixed(2):""},move:{total:mo.move.total,count:mo.move.count,percent:0!=mo.move.total?parseFloat(mo.move.percent).toFixed(2):"",strikes:mo.move.strikes},point:{total:mo.point.total,count:mo.point.count,percent:0!=mo.point.percent?parseFloat(mo.point.percent).toFixed(2):""},hitStreak:{"long":mo.hitStreak["long"],current:mo.hitStreak.current},bonus:{total:mo.bonus.total,count:mo.bonus.count,percent:0!=mo.bonus.total?parseFloat(mo.bonus.percent).toFixed(2):""},save:{total:mo.save.total,count:mo.save.count,percent:0!=mo.save.total?parseFloat(mo.save.percent).toFixed(2):""}};return Mustache.render(Ct,e)}function ge(){return Mustache.render(xt,{})}function fe(){return Mustache.render(jt,{})}function me(){var e={plays:yo.count,thword:{total:yo.thword.total,count:yo.thword.count,percent:0!=yo.thword.total?parseFloat(yo.thword.percent).toFixed(2):""},move:{total:yo.move.total,count:yo.move.count,percent:0!=yo.move.total?parseFloat(yo.move.percent).toFixed(2):"",strikes:yo.move.strikes,remaining:yo.move.remaining},point:{total:yo.point.total,count:yo.point.count,percent:0!=yo.point.total?parseFloat(yo.point.percent).toFixed(2):""},hitStreak:{"long":yo.hitStreak["long"],current:yo.hitStreak.current},bonus:{total:yo.bonus.total,count:yo.bonus.count,percent:0!=yo.bonus.total?parseFloat(yo.bonus.percent).toFixed(2):""},save:{total:yo.save.total,count:yo.save.count,percent:0!=yo.save.total?parseFloat(yo.save.percent).toFixed(2):""}};return Mustache.render(Pt,e)}function ve(){return Mustache.render(It,{skillLevelOptions:to,knowledgeLevelOptions:oo,settings:ho,game:mo,user:go,skillLevel:Q(yo.skillLevel),knowledgeLevel:O(yo.knowledgeLevel),chooseCategory:mo.category.choose>0?"Yes":"No",chooseSubject:mo.subject.choose>0?"Yes":"No",chooseTopic:mo.topic.choose>0?"Yes":"No",chooseLesson:mo.lesson.choose>0?"Yes":"No",bonusOnOptions:mo.bonus.on>0?"Yes":"No"})}function ye(e){for(var t=e%2?"odd-row":"even-row",o={idx:e,"class":t,tiles:[]},n=0;n<yo.thwords.tls[e].length;n++)o.tiles[o.tiles.length]={pos:n,label:yo.thwords.tls[e][n].l};return Mustache.render(_t,o)}function be(){var e={tiles:[],prematureMsgClass:"hide"};return"undefined"!=typeof yo.thwords.chs?$.each(yo.thwords.chs,function(t,o){var n=o.l;!$.isEmptyObject(yo.thwords.cs.eq[o.l])&&yo.thwords.cs.eq[o.l].length>0&&(n+=" ("+yo.thwords.cs.eq[o.l].join(", ")+")"),e.tiles[e.tiles.length]={label:n,right:o.v,wrong:11-o.v}}):e.prematureMsgClass="show",Mustache.render(Et,e)}function $e(){$("#btn-topic-like").removeClass("clicked").removeClass("disabled"),$("#btn-topic-dislike").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-easy").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-hard").removeClass("clicked").removeClass("disabled"),$("#btn-topic-comment").removeClass("clicked").removeClass("disabled"),$("#btn-topic-problem").removeClass("clicked").removeClass("disabled")}function we(){mo.ga(vo.id+": "+vo.name,"round-over","points: "+vo.point.count+", plays: "+yo.count),vo.setProperty("status",0),vo.setProperty("save-status",0),k()}function ke(){window.onbeforeunload=function(){},p(),yo.ga(yo.id+": "+yo.name,"game-exit","points: "+mo.point.total+", rounds: "+vo.count+", plays: "+yo.count),document.location.href="/play"}function Ce(){if($.isEmptyObject(yo)||"undefined"==typeof yo.thwords.ans){try{yo.ga(yo.id+": "+yo.name,"thword-answers-not-found","undefined"!=typeof yo.thwords?JSON.stringify(yo.thwords):"url"+document.location.href)}catch(e){}alert("No answers found.")}else{var t=re();$("#game-panel-answers").html($.parseHTML(t))}}function xe(){var e=le();$("#game-panel-chars").html(e),$(".char").bind("click",function(e){return e.preventDefault(),lt||no.length>0?!1:void xo(this)})}function je(){var e=document.location.toString().split(/[?#]/)[0];"/"===e.slice(-1)&&(e=e.substring(0,e.length-1)),$(".next-round-link").attr("href",e.toString().replace("/play/","/next/")+"?"+Math.floor(1e8*Math.random()+1)),0===parseInt(ho.getProperty("showAds"))?$(".next-round-link").on("click",function(e){e.preventDefault(),Je()}):$(".next-round-link").on("click",function(e){window.onbeforeunload=function(){}})}function Te(){if(vo.random){var e=P(vo.id);4!=e.id||!vo.random&&"en"!=yo.lang?e.lang="en":e.lang=E(yo.langs.length?yo.langs:eo),yo.setProperties(e,!1),$(".game-name").html(D()),$(".game-shortName").html(_())}}function Oe(){var e=no.shift();w(e[0],e[1]),0==no.length&&c()}function Le(){ga("send","event","Global","panel-view","About"),p(),R(ie(),{type:"standard"})}function Se(e,t){t&&$(".btn").removeClass("show").addClass("hide"),$("#btn-"+e).removeClass("hide").addClass("show")}function Pe(){p(),R($("#debug-data").html(),{type:"standard"})}function Ie(){$(".in-game-only").each(function(){$(this).removeClass("hide").addClass("show")})}function De(e,t){t=t||!1,t&&$(".game-panel").each(function(){$(this).removeClass("show").addClass("hide")}),$("#game-panel-"+e).removeClass("hide").addClass("show"),st()&&($("#game-panel-stats").removeClass("hide").addClass("show"),$("#game-panel-debug").removeClass("hide").addClass("show"))}function _e(){ga("send","event","Global","panel-view","Feedback"),p(),R(ge(),{type:"standard",label:"Cancel"}),$("#btn-general-feedback-cancel").on("click",function(e){e.preventDefault(),u()}),$("#btn-general-feedback-submit").on("click",function(e){e.preventDefault(),$("#general-feedback-text").val().length>0&&ho.ga("Feedback",$("#general-feedback-subject").val(),$("#general-feedback-text").val()),u()})}function Ee(){ga("send","event","Global","panel-view","Help"),p(),R(fe(),{type:"standard"})}function qe(e){ga("send","event","Global","panel-view","High Scores"),e=e||{},e.gameId="undefined"!=typeof e.gameId?e.gameId:mo.id,e.lang="undefined"!=typeof e.lang?e.lang:mo.lang?mo.lang:"en",e.knowledgeLevel="undefined"!=typeof e.knowledgeLevel?e.knowledgeLevel:mo.knowledgeLevel,e.skillLevel="undefined"!=typeof e.skillLevel?e.skillLevel:yo.skillLevel,e.categoryId="undefined"!=typeof e.categoryId?e.categoryId:0,e.group="undefined"!=typeof e.group?e.group:fo.id,p(),R(Mustache.render(Ot,{}),{type:"standard"});var t="";e.gameId&&(t+="&gi="+e.gameId),e.knowledgeLevel&&(t+="&kl="+e.knowledgeLevel),e.skillLevel&&(t+="&sl="+e.skillLevel),e.lang&&(t+="&al="+e.lang),"undefined"!=typeof e.categoryId&&(t+="&ci="+e.categoryId),e.group&&(t+="&grp="+e.group),t.replace(/^&/,"");var o=ho.getStatsDomain(),n="http://"+o+so.replace(/\/$/,"")+"/high-scores/get?callback=?"+t;ho.ga("API",o,n),yo.ga(yo.id+": "+yo.name,"high-scores-get","url: "+n),n+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:n,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if($.isEmptyObject(t))var o="<h2>No scores found.</h2>";else{var n=[];$.each(t,function(e,t){t.tp=t.tp?parseFloat(t.tp).toFixed(2):"",t.mp=t.mp?parseFloat(t.mp).toFixed(2):"",t.pp=t.pp?parseFloat(t.pp).toFixed(2):"",t.bp=t.bp?parseFloat(t.bp).toFixed(2):null,t.sp=t.sp?parseFloat(t.sp).toFixed(2):null,t.sla=N(t.sl),t.kla=T(t.kl),t.tca=t.tc>0?"Y":"N",t.pba=t.pb>0?"Y":"N",n[n.length]=t})}var o=Mustache.render(Tt,{scores:n});R(o,{type:"standard"}),$("#high-score-game").val(e.gameId+"-"+e.lang+"-"+e.categoryId),$("#high-score-skill-level").val(e.skillLevel),$("#high-score-game").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};qe(o)}),$("#high-score-skill-level").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};qe(o)})},error:function(e){console.log("Get Error 1005: url: "+n),ho.ga("Error","fetchHighScores","url: "+n),R("<p>There was a problem retrieving the high scores.</p><p>Try again later</p>",{type:"standard"})}})}function Ne(){yo.topic.choose&&yo.topic.count<yo.topic.max&&Se("play-topic-again")}function Qe(){ga("send","event","Global","panel-view","Settings"),p(),R(ve(),{hideNav:!0,type:"standard"}),$("#save-settings").on("click",function(e){try{yo.ga("Settings","save",""),go.name=$("#settings-user-name").val(),go.store()}catch(t){}Z()}),$("#cancel-settings").on("click",function(e){Z()})}function Me(){ga("send","event","Global","panel-view","Game Stats"),p(),R(he(),{type:"standard"})}function Be(){ga("send","event","Global","panel-view","Round Stats"),p(),R(me(),{type:"standard"})}function Ae(){var e=Mustache.render(Dt,{user:go,skillLevelOptions:to,knowledgeLevelOptions:oo,chooseCategoryOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseSubjectOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseTopicOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseLessonOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],bonusOnOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],langOptions:S()});if($("#start-game-settings").html(e),Xt.indexOf(mo.id)<0)$("#start-settings-langs").remove();else if("undefined"!==go.langs&&go.langs.constructor===Array)for(var t=0;t<go.langs.length;t++)$("#start-langs option[value="+go.langs[t]+"]").attr("selected",!0);if($("#start-skill-level").val(mo.skillLevel),$("#start-knowledge-level").val(mo.knowledgeLevel),$("#start-settings-knowledge-level").remove(),mo.category.choose<=0&&$("#start-settings-category").remove(),$("#start-settings-category").remove(),mo.subject.choose<=0&&$("#start-settings-subject").remove(),$("#start-settings-subject").remove(),mo.topic.choose<=0&&$("#start-settings-topic").remove(),$("#start-settings-topic").remove(),mo.lesson.choose<=0&&$("#start-settings-lesson").remove(),$("#start-settings-lesson").remove(),mo.bonus.on>0?$("#start-bonus-on").val(mo.bonus.on):$("#start-settings-bonus-on").remove(),$("#start-settings-bonus-on").remove(),!$.isEmptyObject(Qt)&&"undefined"!=typeof Qt.s&&parseInt(Qt.s)>0){if("undefined"!=typeof Qt.la){var o=!1;$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&($(this).data("lang")==mo.lang?($(this).removeClass("hide").addClass("show"),o=!0):$(this).removeClass("show").addClass("hide"))}),o?$.each($(".lang-explanation-text"),function(){$(this).removeClass("show").addClass("hide")}):$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&$(this).removeClass("hide").addClass("show")})}if("undefined"!=typeof Qt.ap&&Qt.ap.length>0){for(var n=[],t=0;t<Qt.ap.length;t++){var s=L(Qt.ap[t]);s!==!1&&(n[n.length]=L(Qt.ap[t]))}n.length>1&&$("#start-settings-langs").html('<p class="label">Languages</p><p style="margin-bottom: 16px;">'+n.join(", ")+"</p>")}"undefined"!=typeof Qt.gs&&$("#start-settings-skillLevel").html('<p class="label">Skill Level: '+Q(mo.skillLevel)+"</p>"),"undefined"!=typeof Qt.gk&&$("#start-settings-knowledgeLevel").html('<p class="label">Knowledge Level: '+O(mo.knowledgeLevel)+"</p>"),"undefined"!=typeof Qt.cc&&$("#start-settings-category").html('<p class="label">Category: '+(mo.category.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Qt.uc&&$("#start-settings-subject").html('<p class="label">Subject: '+(mo.subject.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Qt.tc&&$("#start-settings-topic").html('<p class="label">Topic: '+(mo.topic.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Qt.lc&&$("#start-settings-lesson").html('<p class="label">Lesson: '+(mo.lesson.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Qt.pb&&$("#start-settings-bonus-on").html('<p class="label">Bonus Questions: '+(mo.bonus.om>0?"Yes":"No")+"</p>")}}function Fe(){try{yo.ga(yo.id+": "+yo.name,"panel-view","Tile Values")}catch(e){}p(),R(be(),{type:"standard"})}function He(e){for(var t,o,n=e.length;n;t=Math.floor(Math.random()*n),o=e[--n],e[n]=e[t],e[t]=o);return e}function Ge(){mo.ga(mo.id+": "+mo.name,"game-start","user: "+go.name),yo.setProperties({status:0,save_status:0}),mo.setProperties({status:1},!1),mo.setProperty("count",mo.count+1),mo.ga(mo.id+": "+mo.name,"game-count",mo.count),mo.ga(mo.id+": "+mo.name,"game-count-"+mo.skillLevel+"-knowledge-"+mo.knowledgeLevel,mo.count),De("start",!0),Je()}function Ye(){$(".strike-xs").html(""),yo.setProperties({status:1,save_status:0}),yo.setProperty("count",yo.count+1),Te(),yo.ga(yo.id+": "+yo.name,"play-start","user: "+go.name),yo.ga(yo.id+": "+yo.name,"play-count",yo.count),yo.ga(yo.id+": "+yo.name,"play-count-"+yo.skillLevel+"-knowledge-"+yo.knowledgeLevel,yo.count),yo.adjustedChooseCategory()>0?h():yo.adjustedChooseSubject()>0?f():yo.adjustedChooseTopic()>0?m():yo.adjustedChooseLesson()>0?g():y({})}function Je(){vo.ga(vo.id+": "+vo.name,"round-start","user: "+go.name),vo.setProperties({status:1,save_status:0}),vo.setProperty("count",vo.count+1),vo.ga(vo.id+": "+vo.name,"round-count",vo.count),vo.ga(vo.id+": "+vo.name,"round-count-"+vo.skillLevel+"-knowledge-"+vo.knowledgeLevel,vo.count),Ye()}function ze(){yo.addToTotal("move",1),yo.setProperty("move-strikes",yo.move.strikes+1,!0),yo.setProperty("move-remaining",yo.move.max-yo.move.total),yo.store(),yo.setProperty("hitStreak-current",0,!0),ae()}function Re(e){if($("#question-response").length){var t=parseInt($(e).data("idx")),o=parseInt($(e).data("option")),n=We($("#question-response-prefix").text()+$("#question-response").val(),yo.bonusQuestions.questions[t].a,!0),s=yo.bonusQuestions.questions[t].p;$("#question-response").attr("disabled","disabled"),n?($("#question-response").addClass("success"),$("#question-response").html(yo.bonusQuestions.questions[t].a),z("Correct",{type:"success","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:ho.overlayButtonDelay})):($("#question-response").addClass("fail"),$("#text-question-answer").html("Answer: "+yo.bonusQuestions.questions[t].a).removeClass("hide").addClass("show"),z(Mustache.render(qt,{correctAnswer:yo.bonusQuestions.questions[t].a}),{type:"error","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:5e3}))}else{alert("question-response field not found.");try{ga.play("Error","bonus-input-missing","question-response input text field not found. : "+JSON.stringify(yo.bonusQuestions))}catch(a){}}}function We(t,o,n){var s=t,a=o;return n="undefined"!=typeof n?n:!1,s=s.trim(),a=a.trim(),s=s.toLowerCase(),a=a.toLowerCase(),n&&(s=e(s),a=e(a)),0===s.localeCompare(a)?1:0}function Ue(e,t,o){o=o||!0,yo.thwords.tls[e][t].s=o?1:0}function Ke(){st()&&($("#game-panel-debug").css("background-color","#e8e8e8").css("color","#000").css("border","solid 1px #000").css("padding","12px"),$("#game-panel-debug").html("<b>Play</b><hr>"+JSON.stringify(yo,null,4)+"<br><br><b>Round</b><hr>"+JSON.stringify(vo,null,4)+"<br><br><b>Game</b><hr>"+JSON.stringify(mo,null,4)+"<br><br><b>Settings</b><hr>"+JSON.stringify(ho,null,4)+"<br><br><b>Group</b><hr>"+JSON.stringify(fo,null,4)+"<br><br><b>User</b><hr>"+JSON.stringify(go,null,4)+"<br><br><b>Session</b>: "+ao))}function Ve(e){e=e||{};var t=[],o={},n={};return $.isEmptyObject(e)||(n.id="undefined"!=typeof $(e).data("id")?$(e).data("id"):mo.id,n.name="undefined"!=typeof $(e).data("name")?$(e).data("name"):mo.name,n.lang="undefined"!=typeof $(e).data("lang")?$(e).data("lang"):mo.lang,"undefined"==typeof Zt[n.lang]&&(t[t.length]="Invalid lang "+n.lang+".")),$("#start-langs").length&&(n.langs=$("#start-langs").val(),!$("#start-langs").val()||[5,6,7,8].indexOf(mo.id)>-1&&$("#start-langs").val().length<2?t[t.length]="Please select at least two langs":(n.langs=$("#start-langs").val(),o.langs=n.langs)),$("#start-user-name").length&&(o.name=$("#start-user-name").val()),$("#start-skill-level").length&&(n.skillLevel=parseInt($("#start-skill-level").val())),$("#start-knowledge-level").length&&(n.knowledgeLevel=parseInt($("#start-knowledge-level").val())),$("#start-choose-category").length&&(n["category-choose"]=Ze(parseInt($("#start-choose-category").val()),mo.id)),$("#start-choose-subject").length&&(n["subject-choose"]=tt(parseInt($("#start-choose-subject").val()),mo.id)),$("#start-choose-topic").length&&(n["topic-choose"]=ot(parseInt($("#start-choose-topic").val()),mo.id)),$("#start-choose-lesson").length&&(n["lesson-choose"]=et(parseInt($("#start-choose-lesson").val()),mo.id)),$("#start-bonus-on").length&&(n["bonus-on"]=parseInt($("#start-bonus-on").val())),t.length?(alert(t.join("\n\n")),!1):($.isEmptyObject(o)||(go.setProperties(o),go.ga("User","start","user:"+go.name)),$.isEmptyObject(n)||(yo.setProperties(n,!0),"undefined"!=typeof n.id&&mo.ga(mo.id+": "+mo.name,"game-user","user: "+go.name)),Xe(),Ke(),!0)}function Xe(){$("#embed-link").val(x()),$("#link-link").val(q({s:1}))}function Ze(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function et(e,t){return e=parseInt(e),t=t||!1,0}function tt(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function ot(e,t){return e=parseInt(e),t=t||!1,e}function nt(){yo.ga(yo.id+": "+yo.name,"play-win",yo.topic.id+": "+yo.topic.name),yo.ga(yo.id+": "+yo.name,"skill"+yo.skillLevel+"-knowledge"+yo.knowledgeLevel+"-play-win",yo.topic.id+": "+yo.topic.name);for(var e=0;e<yo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");A("chars");var t={msg:"Congratulations",score:yo.point.count,perfectScore:yo.point.count==yo.point.total?1:0},o=Mustache.render($t,t)+he();R(o,{type:"success"}),yo.bonus.on>0&&l()>0?($("#btn-show-bonus").html(l()>1?"BONUS QUESTIONS":"BONUS QUESTION"),Se("show-bonus",!0),De("start")):(Se("next-round",!0),Ne(),De("start"),De("feedback",!1))}function st(){var e=$.cookie("debug")||0;return parseInt(e)?!0:!1}function at(e){e&&(0==e?($.removeCookie("debug"),$("#show-debug-data").addClass("hide").removeClass("show")):($.cookie.json,$.cookie("debug",1),$("#show-debug-data").addClass("show").removeClass("hide")))}function it(e,t,o,n){"use strict";t=t||{},o=o||{},this._initialized=!1,this._name=e,this._cookie=t.cookie||"Woggle-"+this._name,this._cookie.replace(/\W/g,""),this._parent=t.parent||{},this._autoStore=t.autoStore||1,this._initialProperties=o||{},this._validation=1,this._ts=Date.now(),this.addToCount=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToCount method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-count");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("total")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-count","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToCount(e,t,o,n),this.updateTimeStamp(),!0)},this.addToTotal=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToTotal method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-total");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("count")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-total","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToTotal(e,t,o,n),this.updateTimeStamp(),!0)},this.autoStore=function(e){return"undefined"!=typeof e?(this._autoStore=e,this):this._autoStore},this.ga=function(e,t,o){try{ga("send","event",e||this._name,t,o)}catch(n){}},this.getCookie=function(){return $.cookie(this._cookie)},this.getProperty=function(e){if(e.indexOf("-")>=0)var t=e.split("-");else var t=e.split("_");return this.hasOwnProperty(t[0])?2===t.length?this[t[0]].hasOwnProperty(t[1])?this[t[0]][t[1]]:(alert("2. Invalid "+this._name+" property "+e+"."),null):this[e]:(alert("Invalid "+this._name+" property "+e+"."),null)},this.getPropertyName=function(e,t){"undefined"==typeof t&&(t=!0);for(var e=e.replace("_","-"),o=!1,n=0;n<this._initialProperties.length;n++)if(e===this._initialProperties[n][0]||"undefined"!=typeof this._initialProperties[n][2]&&e===this._initialProperties[n][2]){o=this._initialProperties[n][0];break}if(o!==!1&&t){var s=o.split("-");if(2===s.length){if(!this.hasOwnProperty(s[0])||!this[s[0]].hasOwnProperty(s[1]))return!1}else if(!this.hasOwnProperty(s[0]))return!1}return o},this.load=function(e){if(e=e||[],!$.isEmptyObject(e))for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t],!1,!1);this._autoStore&&this.store()},this.name=function(e){return"undefined"!=typeof e?(this._name=e,this):this._name},this.parseJSON=function(e){e=e||!1;for(var t={},o=0;o<this._initialProperties.length;o++)t[e?this._initialProperties[o][2]:this._initialProperties[o][0]]=this.getProperty(this._initialProperties[o][0]);return t},this.push=function(e,t,o){o=o||!1;var n=this.getPropertyName(e);if(n===!1)return alert("Invalid "+this._name+" property "+e+" in append method."),!1;var s=n.split("-");if(2===s.length){if(this[s[0]][s[1]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][s[1]][this[s[0]][s[1]].length]=t,this[s[0]][s[1]].length>100&&this[s[0]][s[1]].length.shift(),this.reflowProperty(n)}else{if(this[s[0]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][this[s[0]].length]=t,this[s[0]].length>100&&this[s[0]].length.shift(),this.reflowProperty(n)}return this._autoStore&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.push(e,t,o),this.updateTimeStamp(),!0},this.reflow=function(){for(var e=0;e<this._initialProperties.length;e++)this.reflowProperty(this._initialProperties[e][0])},this.reflowProperty=function(e){var t=this.getPropertyName(e);if(t!==!1){var o=this.getProperty(t);$("."+this._name+"-"+t).text(o)}},this.setProperties=function(e,t){"undefined"==typeof t&&(t=!0);var o=!1;for(var n in e)e.hasOwnProperty(n)&&(o=this.setProperty(n,e[n],t,!1)||o);return o&&this._autoStore&&this.store(),this.updateTimeStamp(),o},this.setProperty=function(e,t,o,n){"undefined"==typeof o&&(o=!1),"undefined"==typeof n&&(n=!0);var s=!1,a=this.getPropertyName(e,!1);if(a===!1)return this._validation>0&&alert("3. Invalid "+this._name+" property "+e+"."),s;if(a.indexOf("-")<0)var i=a.split("_");else var i=a.split("-");if(2===i.length){if(this.hasOwnProperty(i[0])){if(!this[i[0]].hasOwnProperty(i[1])&&this.initialized)return alert("5. Invalid "+this._name+" property "+e+"."),s}else{if(this._initialized)return alert("4. Invalid "+this._name+" property "+e+"."),s;this[i[0]]={}}this[i[0]][i[1]]!==t&&(s=!0),this[i[0]][i[1]]=t}else{if(!this.hasOwnProperty(i[0])&&this.initialized)return alert("6. Invalid "+this._name+" property "+e+"."),!1;this[i[0]]!==t&&(s=!0),this[i[0]]=t}return s&&(this.reflowProperty(e,t),n&&this._autoStore&&this.store()),o&&this.hasOwnProperty("_parent")&&"undefined"!=typeof this._parent.setProperty&&this._parent.setProperty(e,t,o,n),this.updateTimeStamp(),s},this.store=function(){var e=new Date;e.setTime(e.getTime()+63072e6),$.cookie.json,$.cookie(this._cookie,this.stringify(!0),{path:"/",expires:e})},this.stringify=function(e){return JSON.stringify(this.parseJSON(e||!1))},this.updateTimeStamp=function(){this._ts=Date.now(),"undefined"!=typeof this.timeStamp&&(this.timeStamp=this._ts)},this.validationOff=function(){this._validation=0},this.validationOn=function(){this._validation=1};for(var s=0;s<this._initialProperties.length;s++)this.setProperty(this._initialProperties[s][0],this._initialProperties[s][1],!1,!1);"undefined"!=typeof n?this.load(n):this._autoStore&&this.store(),this._initialized=!0,this.updateTimeStamp()}if(at(M("debug")||!1),r(),"undefined"==typeof woggle||$.isEmptyObject(woggle))return $("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1;if("undefined"==typeof woggle.game||"undefined"==typeof woggle.game.id){try{ho.ga("Error","invalid-woggle",document.location.href+", woggle: "+woggle.stringify())}catch(rt){}return alert("Invalid woggle object."),$("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1}var lt=!1,ct="1.0.1",dt=2015,ut=[{id:1,name:"Thwords",shortName:"Thwords",abbrev:"TH",slug:"thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:2,name:"Thword Plays",shortName:"Thword Plays",abbrev:"TP",slug:"thword-plays",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:3,name:"Anti-Thwords",shortName:"Anti-Thwords",abbrev:"AT",slug:"anti-thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:4,name:"Foreign Thwords",shortName:"Foreign Thwords",abbrev:"FT",slug:"foreign-thwords",description:null,details:null,lang:"es",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:5,name:"Random Thwords",shortName:"Random Thwords",abbrev:"RT",slug:"random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:0,save_on:0},{id:6,name:"Random Foreign Thwords",shortName:"Random Foreign",abbrev:"RFT",slug:"random-foreign-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:7,name:"Totally Random Thwords",shortName:"Totally Random",abbrev:"TRT",slug:"totally-random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:8,name:"Language Drills",shortName:"Language Drills",abbrev:"LD",slug:"language-drills",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1}],pt={overlayBackgroundOpacity:.5},ht=document.getElementById("about-template").innerHTML,gt=document.getElementById("answers-template").innerHTML,ft=document.getElementById("char-rack-template").innerHTML,mt=document.getElementById("choose-category-template").innerHTML,vt=document.getElementById("choose-lesson-template").innerHTML,yt=document.getElementById("choose-subject-template").innerHTML,bt=document.getElementById("choose-topic-template").innerHTML,$t=document.getElementById("congrats-msg-template").innerHTML,wt=document.getElementById("end-of-game-overlay-template").innerHTML,kt=document.getElementById("game-save-template").innerHTML,Ct=document.getElementById("game-stats-template").innerHTML,xt=document.getElementById("general-feedback-template").innerHTML,jt=document.getElementById("help-template").innerHTML,Tt=document.getElementById("high-scores-template").innerHTML,Ot=(document.getElementById("initializing-template").innerHTML,document.getElementById("loading-template").innerHTML),Lt=(document.getElementById("question-fill-in-the-blank-template").innerHTML,document.getElementById("question-multiple-choice-template").innerHTML),St=(document.getElementById("question-multi-select-template").innerHTML,document.getElementById("question-sequence-template").innerHTML,document.getElementById("question-text-template").innerHTML),Pt=document.getElementById("round-stats-template").innerHTML,It=document.getElementById("settings-template").innerHTML,Dt=document.getElementById("start-settings-template").innerHTML,_t=document.getElementById("tile-rack-template").innerHTML,Et=document.getElementById("tile-values-template").innerHTML,qt=document.getElementById("wrong-answer-template").innerHTML,Nt=j(woggle.game.id);if($.isEmptyObject(Nt)){try{ho.ga("Error","undefined-game-id",document.location.href+" : "+JSON.stringify(woggle));
}catch(rt){}return alert("Game "+woggle.game.id+" not defined."),!1}var Qt=B(!0),Mt=$.cookie("Woggle-settings");Mt=Mt?$.parseJSON(Mt):{};var Bt=$.cookie("Woggle-user");Bt=Bt?$.parseJSON(Bt):{};var At=$.cookie("Woggle-group");At=At?$.parseJSON(At):{};var Ft=$.cookie("Woggle-game");Ft=Ft?$.parseJSON(Ft):{};var Ht=$.cookie("Woggle-round");Ht=Ht?$.parseJSON(Ht):{};var Gt=$.cookie("Woggle-play");Gt=Gt?$.parseJSON(Gt):{};var Yt=!0;if(!($.isEmptyObject(Mt)||$.isEmptyObject(Bt)||$.isEmptyObject(At)||$.isEmptyObject(Ft)||$.isEmptyObject(Ht)||$.isEmptyObject(Gt))&&"undefined"!=typeof Ft.id&&"undefined"!=typeof Ft.ga&&parseInt(Ft.ga)>0)if(Ft.id==woggle.game.id)Yt=!1;else{if(!confirm("You currently have an active game of "+Ft.gn+".\n\nIf you continue you will lose that game.\n\nDo you want to start this new game anyway?"))return document.location.href=Ft.ur,!1;Yt=!0}var Jt="en";"undefined"!=typeof Ft.al&&(Jt=Ft.al);var zt=2;"undefined"!=typeof Ft.gs&&(zt=Ft.gs);var Rt=2;"undefined"!=typeof Ft.gk&&(Rt=Ft.gk),$("#container-content").removeClass("show").addClass("hide"),$("#container-initializing").removeClass("hide").addClass("show");try{ga("send","event","Game","initialize","woggle: "+JSON.stringify(woggle))}catch(rt){}var Wt,Ut,Kt=[1,2,3,4],Vt=[1,2,3],Xt=[6,7,8],Zt={de:"German",en:"English",es:"Spanish",fr:"French",is:"Icelandic",it:"Italian",pl:"Polish",pt:"Portuguese",ru:"Russian",tr:"Turkish",uk:"Ukrainian"},eo=["de","es","fr","is","it","pl","pt","ru","tr","uk"],to=[{value:1,name:"Novice",abbrev:"N"},{value:2,name:"Amateur",abbrev:"A"},{value:3,name:"Pro",abbrev:"P"},{value:4,name:"Expert",abbrev:"E"}],oo=[{value:0,name:"Elementary",abbrev:"el"},{value:1,name:"High School",abbrev:"hs"},{value:2,name:"College",abbrev:"co"},{value:3,name:"Graduate",abbrev:"gr"},{value:4,name:"Doctorate",abbrev:"do"},{value:5,name:"Genius",abbrev:"ge"},{value:6,name:"Super Genius",abbrev:"g+"}],no=[],so="/api/",ao=C(),io=[["sessionId",ao,"se"],["domain",document.domain,"dm"],["apiDomain",null,"ad"],["apiDomains",[document.domain],"as"],["statsDomain",null,"sd"],["showAds",1,"ads"],["overlayDivDelay",0,"odd"],["overlayButtonDelay",500,"obd"],["tileFlipDelay",300,"tfd"],["timeStamp",Date.now(),"ts"]],ro=[["sessionId",ao,"se"],["id",null,"id"],["name",null,"na"],["username",null,"un"],["email",null,"em"],["lang","en","al"],["langs",[],"ap"],["timeStamp",Date.now(),"ts"]],lo=[["sessionId",ao,"se"],["id",null,"id"],["name",null,"na"],["timeStamp",Date.now(),"ts"]],co=[["sessionId",ao,"se"],["id",-1,"id"],["status",-1,"ga"],["count",0,"go"],["name","Thwords","gn"],["shortName","Thwords","sn"],["abbrev","TH","ab"],["description",null,"gd"],["details",null,"gt"],["slug","thwords","gg"],["url",window.location.href,"ur"],["random",0,"gr"],["lang","en","al"],["langs",eo,"ap"],["knowledgeLevel",2,"gk"],["skillLevel",2,"gs"],["maxPlays",-1,"gm"],["category-choose",0,"cc"],["category-id",0,"ci"],["category-name",null,"cn"],["category-max",1,"cm"],["category-count",0,"co"],["category-played",[],"cp"],["subject-choose",0,"uc"],["subject-id",0,"ui"],["subject-name",null,"un"],["subject-max",1,"um"],["subject-count",0,"uo"],["subject-played",[],"up"],["topic-choose",0,"tc"],["topic-id",0,"ti"],["topic-name",null,"tn"],["topic-lang","en","tl"],["topic-description",null,"td"],["topic-details",null,"tt"],["topic-max",1,"tm"],["topic-count",0,"to"],["topic-played",[],"tp"],["lesson-choose",0,"lc"],["lesson-id",0,"li"],["lesson-name",null,"ln"],["lesson-max",1,"lm"],["lesson-count",0,"lo"],["lesson-played",[],"lp"],["thword-total",0,"zt"],["thword-count",0,"zc"],["thword-percent",null,"zp"],["move-max",0,"mm"],["move-total",0,"mt"],["move-count",0,"mc"],["move-percent",null,"mp"],["move-strikes",0,"mx"],["move-remaining",0,"mr"],["point-total",0,"pt"],["point-count",0,"pc"],["point-percent",null,"pp"],["bonus-on",1,"pb"],["bonus-total",0,"bt"],["bonus-count",0,"bc"],["bonus-value",0,"bv"],["bonus-percent",null,"bp"],["save-on",1,"ps"],["save-status",-1,"sa"],["save-total",0,"st"],["save-count",0,"sc"],["save-percent",null,"sp"],["hitStreak-current",0,"hc"],["hitStreak-long",0,"hl"],["thwords",{},"tz"],["char-played",[],"ch"],["tile-flipped",[],"tf"],["quiz",{},"qz"],["survey",{},"su"],["bonusQuestions",{},"bq"],["timeStamp",Date.now(),"ts"]],uo={"":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"c","":"e","":"e","":"e","":"e","":"e","":"e","":"g","":"i","":"i","":"i","":"i","":"i","":"i","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"s","":"u","":"u","":"u","":"u","":"u","":"y"};if(Yt){for(var po in Nt)Nt.hasOwnProperty(po)&&"undefined"==typeof woggle.game[po]&&(woggle.game[po]=Nt[po]);var ho=new it("settings",{},io,Mt);$.isEmptyObject(woggle.settings)||$.each(woggle.settings,function(e,t){ho.setProperty(e,t)});var go=new it("user",{},ro,Bt),fo=new it("group",{},lo,At),mo=new it("game",{},co,woggle.game||{}),vo=new it("round",{parent:mo},co,woggle.game||{}),yo=new it("play",{parent:vo},co,woggle.game||{});yo.setProperty("lang",Jt,!0),yo.setProperty("skillLevel",zt,!0),yo.setProperty("knowledgeLevel",Rt,!0)}else var ho=new it("settings",{},io,Mt),go=new it("user",{},ro,Bt),fo=new it("group",{},lo,At),mo=new it("game",{},co,Ft),vo=new it("round",{parent:mo},co,Ht),yo=new it("play",{parent:vo},co,Gt);ho.getApiDomain=function(){return this.apiDomain?this.apiDomain:this.nextApiDomain()},ho.nextApiDomain=function(){if(0===this.apiDomains.length)return ho._validation&&(ho.ga("Error","no-apiDomains-specified",document.location.href),alert("No apiDomains specified.")),null;if(1!==this.apiDomains.length&&this.apiDomain){for(var e=0;e<this.apiDomains.length;e++)if(this.apiDomains[e]===this.apiDomain){this.apiDomain=e+1<this.apiDomains.length?this.apiDomains[e+1]:this.apiDomains[0];break}return this.apiDomain}return this.setProperty("apiDomain",this.apiDomains[0]),this.apiDomain},ho.getStatsDomain=function(){return this.statsDomain?this.statsDomain:this.getApiDomain()},yo.adjustedBonusOn=function(){return mo.point.total>1e3?yo.bonus.on:mo.point.total>2e3?0:yo.bonus.on},yo.adjustedChooseCategory=function(){return mo.point.total>2e3?0:yo.category.choose},yo.adjustedChooseLesson=function(){return mo.point.total>2e3?0:yo.lesson.choose},yo.adjustedChooseSubject=function(){return mo.point.total>2e3?0:yo.subject.choose},yo.adjustedChooseTopic=function(){return mo.point.total>2e3?0:yo.topic.choose},yo.adjustedKnowledgeLevel=function(){return mo.point.total>1e3?this.knowledgeLevel<3?this.knowledgeLevel+1:this.knowledgeLevel:mo.point.total>2500?4:this.knowledgeLevel},yo.adjustedSkillLevel=function(){return mo.point.total>1e3?this.skillLevel<3?this.skillLevel+1:this.skillLevel:mo.point.total>2500?4:this.skillLevel},yo.generateQuestion=function(e,t,o){o=o||{};var n="undefined"!=typeof o.points?o.points:1,s={t:"undefined"!=typeof o.qType?o.qType:"mc",q:e,a:null,o:[],c:null,p:n};if(t.constructor.toString().indexOf("Array")>-1){if("undefined"==typeof o.idx)return this.ga("Error","generateQuestions-no-index-specified","answers: "+JSON.stringify(t)),alert("generateQuestions method no index specified, answers: "+JSON.stringify(t)),!1;if("undefined"==typeof t[o.idx])return this.ga("Error","generateQuestions-invalid-idx","answers: "+JSON.stringify(t)),alert("generateQuestions method invalid idx "+o.idx+", answers: "+JSON.stringify(t)),!1;switch(s.a=t[o.idx],s.t){case"tx":s.a=e,s.q=t[o.idx];break;case"tf":case"yn":if(Math.random()<.5)s.c=0,s.q=s.q+" = "+s.a;else{s.c=1;var a="",i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=He(i);for(var r=0;r<i.length;r++)i[r].idx!=o.idx&&(a=i[r].label);s.q=s.q+" = "+a}s.o="tf"==s.t?["True","False"]:["Yes","No"];break;case"mc":default:if(v(t))return!1;var i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=He(i);for(var r=0;r<i.length;r++)s.o[s.o.length]=i[r].label,i[r].idx==o.idx&&(s.c=r)}}else s.t="tx",s.a=t;return s},yo.generateBonusQuestions=function(){if(this.bonusQuestions={},this.bonusQuestions.questions=[],!$.isEmptyObject(yo)&&!$.isEmptyObject(this.thwords)&&"undefined"!=typeof this.thwords.ans&&this.thwords.ans.length>1&&"undefined"!=typeof this.thwords.aux1&&this.thwords.ans.length===this.thwords.aux1.length)if(4==this.id)try{for(var e=[],t=0;t<this.thwords.ans.length;t++){var o=this.generateQuestion(this.thwords.ans[t],this.thwords.aux1,{idx:t,qType:yo.getQuestionType(this.thwords.ans[s],{gameId:this.id,lang:this.lang})});o!==!1&&(e[e.length]=o)}this.bonusQuestions.questions=He(e)}catch(n){console.log(n),this.ga("Error","generateBonusQuestions: multiple",n.toString())}else try{var s=Math.floor(Math.random()*this.thwords.aux1.length);if(this.thwords.aux1[s]){var o=this.generateQuestion(this.thwords.ans[s],this.thwords.aux1,{idx:s,qType:yo.getQuestionType(this.thwords.ans[s])});o!==!1&&(this.bonusQuestions.questions=[o])}}catch(n){this.ga("Error","generateBonusQuestions: single",n.toString()),console.log(n)}this.bonusQuestions.idx=this.bonusQuestions.questions.length>0?0:9999},yo.getQuestionType=function(e,t){e=e||"",t=t||{};var o=("undefined"!=typeof t.gameId?t.gameId:-1,"undefined"!=typeof t.lang?t.lang:"en");if(2==yo.id)return"mc";if(4!=yo.id)return!1;var n=this.adjustedSkillLevel(),s=Math.random();switch(n){case 3:return.2>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=12?"tx":"mc":.4>s?"tf":"mc";case 4:return.4>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=15?"tx":"mc":.6>s?"tf":"mc";case 0:case 1:case 2:default:return.25>s?"tf":"mc"}},st()&&(window.thwordData={settings:ho,user:go,group:fo,game:mo,round:vo,play:yo}),ee(),Xe(),1==M("s")?mo.ga(mo.id+": "+mo.name,"start-shared","url: "+document.location.href):1==M("e")?mo.ga(mo.id+": "+mo.name,"start-embed","url: "+document.location.href):mo.ga(mo.id+": "+mo.name,"start-new","url: "+document.location.href),Ke(),a(),$("#container-content").removeClass("hide").addClass("show"),$("#container-initializing").removeClass("show").addClass("hide"),Ie(),Yt?Ae():Ge();var bo=function(e){var t=parseInt($(e).data("idx")),n=parseInt($(e).data("option")),s=yo.bonusQuestions.questions[t].c,a=yo.bonusQuestions.questions[t].p;if(n==s){o(a),yo.addToCount("bonus",1,!0);var i="Correct";if(["tf","yn"].indexOf(yo.bonusQuestions.questions[t].t)>-1&&yo.bonusQuestions.questions[t].c>0){i+="<p>The right answer is "+yo.bonusQuestions.questions[t].a+".</p>";var r=5e3}else var r=ho.overlayButtonDelay;$("#submit-question-answer").removeClass("show").addClass("hide"),z(i,{type:"success","class":"process-bonus",data:{idx:t,option:n,correct:s,points:a},timeout:r})}else z(Mustache.render(qt,{correctAnswer:yo.bonusQuestions.questions[t].a}),{type:"error","class":"process-bonus",data:{idx:t,option:n,correct:s,points:a},timeout:0})},$o=function(e){if("undefined"==typeof $(e).data("category-id"))return alert("No category selected."),!1;if(parseInt($(e).data("category-id"))>0)var t=parseInt($(e).data("category-id")),o=$(e).text();else var t=0,o="WILD CARD";yo.ga(yo.id+": "+yo.name,"category-select",t+": "+o);try{yo.adjustedChooseSubject()>0?f():yo.adjustedChooseTopic()>0?m():y({category_id:t})}catch(n){console.log(n),ho.ga("Error","selectCategory",n.toString())}},wo=function(e){if("undefined"==typeof $(e).data("lesson-id"))return alert("No lesson selected."),!1;if(parseInt($(e).data("lesson-id"))>0)var t=parseInt($(e).data("lesson-id")),o=$(e).text();else var t=0,o="WILD CARD";yo.ga(yo.id+": "+yo.name,"lesson-select",t+": "+o);try{y({lesson_id:t})}catch(n){console.log(n),ho.ga("Error","selectLesson",n.toString())}},ko=function(e){if("undefined"==typeof $(e).data("subject-id"))return alert("No subject selected."),!1;if(parseInt($(e).data("subject-id"))>0)var t=parseInt($(e).data("subject-id")),o=$(e).text();else var t=0,o="WILD CARD";yo.ga(yo.id+": "+yo.name,"subject-select",t+": "+o);try{yo.adjustedChooseTopic()>0?m():y({subject_id:t})}catch(n){console.log(n),ho.ga("Error","selectSubject",n.toString())}},Co=function(e){if($e(),"undefined"==typeof $(e).data("topic-id"))return alert("No topic selected."),!1;if(parseInt($(e).data("topic-id"))>0)var t=parseInt($(e).data("topic-id")),o=$(e).text();else var t=0,o="WILD CARD";yo.ga(yo.id+": "+yo.name,"topic-select",t+": "+o);try{y({topic_id:t})}catch(n){console.log(n),ho.ga("Error","selectTopic",n.toString())}},xo=function(e){var t=$(e).data("idx")||!1;try{if(t)if($(e).hasClass("chosen"));else{$(e).addClass("chosen");var o=yo.thwords.chs[t].v,n=G(t);if(n>0){var o=o*n,s=n+(1==n?" match!":" matches!");s+="<br>"+o+(1==o?" point.":" points."),z(s,{type:"success","class":"process-char",data:{idx:t},timeout:ho.overlayButtonDelay,opacity:!1})}else{var a=Math.abs(o-11),s="Strike!";s+="<br>You lose "+a+(1==a?" point":" points."),z(s,{type:"fail","class":"process-char",data:{idx:t},timeout:ho.overlayButtonDelay,opacity:!1})}}else alert("No index.")}catch(i){console.log(i),ho.ga("Error","selectChar",i.toString())}}}()});