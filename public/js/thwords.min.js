$(document).ready(function(){$(".game-link").on("click",function(e){return ga("Game","select",$(this).data("id")+": "+$(this).data("name")),!0});var e=document.location.toString();$("#embed-link").val('<iframe height="440" width="420" src="'+e+(e.indexOf("?")<0?"?":"&")+'e=1" frameborder="0" allowfullscreen></iframe>'),$("#btn-embed-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-embed",$("#embed-link").val())}catch(n){}$("#container-link-link").hide(),$("#container-embed-link").show(),$("#embed-link").select()}),$("#close-embed-link").on("click",function(e){e.preventDefault(),$("#container-embed-link").hide()});var t=document.location.toString();$("#link-link").val(t+(t.indexOf("?")<0?"?":"&")+"s=1"),$("#btn-link-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-link",$("#link-link").val())}catch(n){}$("#container-embed-link").hide(),$("#container-link-link").show(),$("#link-link").select()}),$("#close-link-link").on("click",function(e){e.preventDefault(),$("#container-link-link").hide()})}),$(document).ready(function(){!function(){function e(){mo.addToTotal("move",1),mo.addToCount("move",1),mo.setProperty("move-remaining",mo.move.max-mo.move.total),mo.store(),mo.setProperty("hitStreak-current",mo.hitStreak.current+1,!0),go.hitStreak.current>go.hitStreak["long"]&&mo.setProperty("hitStreak-long",mo.hitStreak["long"]+1,!0),se()}function t(e){var e=parseInt(e);try{mo.addToCount("point",e)}catch(t){console.log(t),uo.ga("Error","addPoints",t.toString())}se()}function o(){for(var e=!0,t=0;t<mo.thwords.tls.length;t++)n(t)||(e=!1);return e}function n(e,t){t=t||!1;try{for(var o=0;o<mo.thwords.tls[e].length;o++)if(!mo.thwords.tls[e][o].s)return t&&$("#answer-"+e).removeClass("solved").addClass("wrong"),!1}catch(n){console.log(n),uo.ga("Error","allTilesSolved",n.toString())}return $("#answer-"+e).hasClass("solved")||($("#answer-"+e).addClass("solved"),mo.addToCount("thword",1,!0)),$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show"),!0}function s(){window.onbeforeunload=function(){return!$.isEmptyObject(go)&&"undefined"!=typeof go.status&&go.status?"If you leave this page you will lose your current game?":void 0},$(".quit-game").on("click",function(e){e.preventDefault(),ee()}),$(".save-and-exit-game").on("click",function(e){e.preventDefault(),we()}),$(".select-foreign-thword").on("click",function(e){e.preventDefault(),wo(this)}),$(".start-game").on("click",function(e){e.preventDefault(),Ke(this)&&He()}),xe()}function a(){$("#btn-close-ad").on("click",function(e){e.preventDefault(),$("#ad-content").removeClass("show").addClass("hide"),$("#overlay-ad").removeClass("show").addClass("hide")}),$("#btn-topic-feedback-cancel").on("click",function(e){e.preventDefault(),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}),$("#btn-topic-feedback-submit-comment").on("click",function(e){e.preventDefault();try{mo.ga(mo.id+": "+mo.name,"topic-comment",mo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-comment").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-feedback-submit-problem").on("click",function(e){e.preventDefault();try{mo.ga(mo.id+": "+mo.name,"topic-problem",mo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-problem").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-dislike").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?J("You already said you liked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?J("You already said you dislike this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof mo.topic.id&&mo.topic.id>0&&(mo.ga(mo.id+": "+mo.name,"topic-dislike",mo.topic.id+": "+mo.topic.name),J("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-like").addClass("disabled"))}catch(t){}}),$("#btn-topic-like").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?J("You already said you disliked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?J("You already said you like this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof mo.topic.id&&mo.topic.id>0&&(mo.ga(mo.id+": "+mo.name,"topic-like",mo.topic.id+": "+mo.topic.name),J("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-dislike").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-easy").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?(J("You already said this topic was too hard.",{type:"fail",timeout:2e3}),alert("You already said this topic was too hard.")):$(this).hasClass("clicked")?J("You already said this topic was too easy.",{type:"fail",timeout:2e3}):("undefined"!=typeof mo.topic.id&&mo.topic.id>0&&(mo.ga(mo.id+": "+mo.name,"topic-too-easy",mo.topic.id+": "+mo.topic.name),J("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-hard").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-hard").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?J("You already said this topic was too easy.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?J("You already said this topic was too hard.",{type:"fail",timeout:2e3}):("undefined"!=typeof mo.topic.id&&mo.topic.id>0&&(mo.ga(mo.id+": "+mo.name,"topic-too-hard",mo.topic.id+": "+mo.topic.name),J("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-easy").addClass("disabled"))}catch(t){}}),$("#btn-topic-comment").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?J("You have already submitted a comment on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("hide").addClass("show"),$("#topic-feedback-instr-problem").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-comment").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-problem").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#btn-topic-problem").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?J("You have already reported a problem on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("show").addClass("hide"),$("#topic-feedback-instr-problem").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-comment").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-problem").removeClass("hide").addClass("show"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#hamburger").on("click",function(e){e.preventDefault(),Y()}),$("#menuContentLayer").on("click",function(e){e.preventDefault(),u()}),$(".new-game").on("click",function(e){Gt()}),$(".overlay-continue-btn").on("click",function(e){e.preventDefault(),X()}),$(".play-topic-again").on("click",function(e){e.preventDefault(),R()}),$(".process-char").on("click",function(e){e.preventDefault(),$(this).data("idx")&&K($(this).data("idx"))}),$(".show-about-overlay").on("click",function(e){e.preventDefault(),Oe()}),$(".show-bonus").on("click",function(e){e.preventDefault(),G()}),$(".show-debug-data-overlay").on("click",function(e){e.preventDefault(),Pe()}),$(".show-game-stats-overlay").on("click",function(e){e.preventDefault(),Qe()}),$(".show-general-feedback-overlay").on("click",function(e){e.preventDefault(),_e()}),$(".show-help-overlay").on("click",function(e){e.preventDefault(),De()}),$(".show-high-scores-overlay").on("click",function(e){e.preventDefault(),Ee()}),$(".show-round-stats-overlay").on("click",function(e){e.preventDefault(),Me()}),$(".show-settings-overlay").on("click",function(e){e.preventDefault(),Ne()}),$(".show-tile-values-overlay").on("click",function(e){e.preventDefault(),Be()}),$(".visit-thwords-com").on("click",function(e){e.preventDefault(),window.open("http://thwords.com"),u()})}function r(){return"undefined"==typeof mo.bonusQuestions||"undefined"==typeof mo.bonusQuestions.questions?0:mo.bonusQuestions.questions.length}function l(){o()?ot():mo.move.total>=mo.move.max&&F()}function c(){var e=new Date;e.setTime(e.getTime()-288e5),$.cookie("Woggle-play",null,{path:"/",expires:e}),$.cookie("Woggle-round",null,{path:"/",expires:e}),$.cookie("Woggle-game",null,{path:"/",expires:e})}function d(){$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),$("#overlay-div-container").removeClass().addClass("standard").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",ut.overlayBackgroundOpacity)}function u(){$("#container").unbind("touchmove"),$("#container").animate({marginLeft:["-1","easeOutExpo"]},{duration:700,complete:function(){$("#content").css("width","auto"),$("#menuContentLayer").css("display","none"),$("nav").css("opacity",0),$("#content").css("min-height","auto"),$("nav").css("display","none")}})}function p(){J("Loading Categories ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/category/get?callback=?&rn=1&mx=3&gi="+mo.id+"&al="+mo.lang+"&sl="+mo.adjustedSkillLevel()+"&kl="+mo.adjustedKnowledgeLevel();uo.ga("API",uo.getApiDomain(),e),mo.ga(mo.id+": "+mo.name,"fetch-categories","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=le(e);$("#game-panel-choose").html(t),$(".select-category").bind("click",function(e){e.preventDefault(),yo(this)}),Ie("choose",!0),go.status>0&&Ie("score",!1),V()},error:function(t){console.log("Get Error 1000: url: "+e),uo.ga("Error","createCategorySelectList","url: "+e),confirm("Could not fetch categories. Try again?")&&(uo.nextApiDomain(),p())}})}function h(){J("Loading Lessons ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/lesson/get?callback=?&rn=1&mx=3&gi="+mo.id+"&al="+mo.lang+"&sl="+mo.adjustedSkillLevel()+"&kl="+mo.adjustedKnowledgeLevel();uo.ga("API",uo.getApiDomain(),e),mo.ga(mo.id+": "+mo.name,"fetch-lessons","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=ce(e);$("#game-panel-choose").html(t),$(".select-subject").bind("click",function(e){e.preventDefault(),bo(this)}),Ie("choose",!0),go.status>0&&Ie("score",!1),V()},error:function(t){console.log("Get Error 1001: url: "+e),uo.ga("Error","createLessonSelectList","url: "+e),confirm("Could not fetch lessons. Try again?")&&(uo.nextApiDomain(),h())}})}function g(){J("Loading Subjects ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/subject/get?callback=?rn=1&mx=3&gi="+mo.id+"&al="+mo.lang+"&sl="+mo.adjustedSkillLevel()+"&kl="+mo.adjustedKnowledgeLevel()+"&ci="+(0===mo.category.choose?0:mo.category.id);uo.ga("API",uo.getApiDomain(),e),mo.ga(mo.id+": "+mo.name,"fetch-subjects","url: "+e),e+="?"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&mo.category.choose>0)mo.ga("Warning","no-subjects-found-for-category","url: "+e),alert("No subjects found.\n\nPlease select another category."),p();else if($.isEmptyObject(t))confirm("No subjects found.\n\nTry again?")&&(uo.nextApiDomain(),g());else{var o=de(t);$("#game-panel-choose").html(o),$(".select-subject").bind("click",function(e){e.preventDefault(),$o(this)}),Ie("choose",!0),go.status>0&&Ie("score",!1),V()}},error:function(t){console.log("Get Error 1002: url: "+e),uo.ga("Error","createSubjectSelectList","url: "+e),confirm("Could not fetch subjects. Try again?")&&(uo.nextApiDomain(),g())}})}function f(){J("Loading Topics ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/topic/get?callback=?&rn=1&mx=3&gi="+mo.id+"&al="+mo.lang+"&sl="+mo.adjustedSkillLevel()+"&kl="+mo.adjustedKnowledgeLevel()+"&ci="+(0===mo.category.choose?0:mo.category.id)+"&ui="+(0===mo.subject.choose?0:mo.subject.id);uo.ga("API",uo.getApiDomain(),e),mo.ga(mo.id+": "+mo.name,"fetch-topics","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&mo.subject.choose>0)mo.ga("Warning","no-topic-found-for-subject","url: "+e),alert("No topics found.\n\nPlease select another subject."),g();else if($.isEmptyObject(t)&&mo.subject.choose>0)mo.ga("Warning","no-topic-found-for-category","url: "+e),alert("No topics found.\n\nPlease select another category."),p();else if($.isEmptyObject(t))confirm("No topics found.\n\nTry again?")&&(uo.nextApiDomain(),f());else{var o=ue(t);$("#game-panel-choose").html(o),$(".select-topic").bind("click",function(e){e.preventDefault(),wo(this)}),Ie("choose",!0),go.status>0&&Ie("score",!1),V()}},error:function(t){console.log("Get Error 1003: url: "+e),uo.ga("Error","createTopicSelectList","url: "+e),confirm("Could not fetch topics. Try again?")&&(uo.nextApiDomain(),f())}})}function m(e){for(var t=e.slice(0).sort(),o=[],n=0;n<e.length-1;n++)t[n+1]==t[n]&&o.push(t[n]);return o.length>0?!0:!1}function v(e){e=e||{},J("Loading Thwords ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var t="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/game-play/get?callback=?&gi="+mo.id+"&sl="+mo.skillLevel+"&kl="+mo.knowledgeLevel+"&ci="+(mo.getProperty("category-choose")<0?mo.getProperty("category-id"):e.category_id||0)+"&ui="+(mo.getProperty("subject-choose")<0?mo.getProperty("subject-id"):e.subject_id||0)+"&ti="+(mo.getProperty("topic-choose")<0?mo.getProperty("topic-id"):e.topic_id||0)+"&li="+(mo.getProperty("lesson-choose")<0?mo.getProperty("lesson-id"):e.lesson_id||0)+"&al="+mo.lang;uo.ga("API",uo.getApiDomain(),t),mo.ga(mo.id+": "+mo.name,"fetch-play","url: "+t),t+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:t,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){J("Creating Tiles ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0}),B(e),V()},error:function(o){console.log("Get Error 1004: url: "+t),uo.ga("Error","fetchPlay","url: "+t),confirm("Could not fetch Thwords. Try again?")&&(uo.nextApiDomain(),v(e))}})}function y(){for(var e=uo.tileFlipDelay,t=0;t<mo.thwords.tls.length;t++)for(var o=0;o<mo.thwords.tls[t].length;o++)mo.thwords.tls[t][o].f&&(uo.tileFlipDelay?(oo.push([t,o]),setTimeout(function(){Te()},e),e+=uo.tileFlipDelay):b(t,o))}function b(e,o){var n=(mo.thwords.tls[e][o].l||"??",mo.thwords.tls[e][o].v||0);$("#tile-"+e+"-"+o).addClass("solved"),mo.push("tile-flipped",[e,o],!1),We(e,o),t(n)}function w(){go.ga(go.id+": "+go.name,"game-over","points: "+go.point.count+", rounds: "+fo.count+", plays: "+mo.count),go.setProperty("status",0),go.setProperty("save-status",0),ne(),Le("new-game",!0),z(Mustache.render($t,{title:"Game Over",details:""})+pe(),{type:"fail"})}function k(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)}),t=new Date;return t.setTime(t.getTime()+63072e6),$.cookie("Thwords-Session",e,{path:"/",expires:t}),e}function C(){return'<iframe height="440" width="420" src="'+E({e:1})+'" frameborder="0" allowfullscreen></iframe>'}function x(e){var t={};return $.each(dt,function(o,n){if(n.id==e)for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])}),t}function j(e){for(var t=0;t<to.length;t++)if(e==to[t].value)return to[t].abbrev;return"?"}function T(e){for(var t=0;t<to.length;t++)if(e==to[t].value)return to[t].name;return"?"}function O(e){return"undefined"!=typeof Xt[e]?Xt[e]:!1}function L(){var e=[];return $.each(Xt,function(t,o){"en"!=t&&(e[e.length]={value:t,name:o})}),e}function P(e){e=e||7;var t=S(e);return x(t)}function S(e){return e=e||7,5==e?Kt[Math.floor(Math.random()*Kt.length)]:[6,8].indexOf(e)>-1?4:Ut[Math.floor(Math.random()*Ut.length)]}function I(){return 4==mo.getProperty("id")?go.getProperty("abbrev")+": "+O(mo.getProperty("lang"))+" Thwords":go.getProperty("abbrev")+": "+mo.getProperty("name")}function _(){return 4==mo.getProperty("id")?go.getProperty("abbrev")+": "+O(mo.getProperty("lang")):go.getProperty("abbrev")+": "+mo.getProperty("shortName")}function D(e){return e=e||Zt,e[Math.floor(Math.random()*e.length)]}function E(e){parms=e||{},"undefined"==typeof go||$.isEmptyObject(go)||("undefined"!=typeof go.lang&&go.lang.length>0&&(e.al=go.lang),"undefined"!=typeof go.skillLevel&&parseInt(go.skillLevel)>0&&(e.sl=go.skillLevel),"undefined"!=typeof go.knowledgeLevel&&parseInt(go.knowledgeLevel)>0&&(e.kl=go.knowledgeLevel),"undefined"!=typeof go.category.choose&&parseInt(go.category.choose)<0&&parseInt(go.category.id)>0&&(e.cc=-1,e.ci=go.category.id),"undefined"!=typeof go.subject.choose&&parseInt(go.subject.choose)<0&&parseInt(go.subject.id)>0&&(e.uc=-1,e.ui=go.subject.id),"undefined"!=typeof go.topic.choose&&parseInt(go.topic.choose)<0&&parseInt(go.topic.id)>0&&(e.tc=-1,e.ti=go.topic.id),"undefined"!=typeof go.lesson.choose&&parseInt(go.lesson.choose)<0&&parseInt(go.lesson.id)>0&&(e.lc=-1,e.li=go.lesson.id),Vt.indexOf(go.id)>-1&&"undefined"!=typeof po.langs&&(e.ap=po.langs.join("|")));var t=document.location.toString().split(/[?#]/)[0];if(t=t.replace("/next/","/play/"),!$.isEmptyObject(e)){var o="";$.each(e,function(e,t){o+="&"+e+"="+encodeURIComponent(t)}),o.length>0&&(t+=(t.indexOf("?")<0?"?":"&")+o.substr(1))}return t}function q(e){for(var t=0;t<eo.length;t++)if(e==eo[t].value)return eo[t].abbrev;return"?"}function N(e){for(var t=0;t<eo.length;t++)if(e==eo[t].value)return eo[t].name;return"?"}function Q(e){for(var t=window.location.search.substring(1),o=t.split("&"),n=0;n<o.length;n++){var s=o[n].split("=");if(s[0]==e)return decodeURIComponent(s[1])}return null}function M(e){e=e||!1;for(var t=window.location.search.substring(1),o=t.split("&"),n=[],s={},a=0;a<o.length;a++){var i=o[a].split("=");if("undefined"!=typeof i[0]&&i[0].length>0){if("ap"==i[0])var r=decodeURIComponent(i[1]).split("|");else var r=decodeURIComponent(i[1]);n[n.length]={name:i[0],value:r},s[i[0]]=r}}return e?s:n}function A(e){$("#game-panel-"+e).removeClass("show").addClass("hide")}function B(e){if(!$.isEmptyObject(e)){try{"undefined"!=typeof e.ti&&parseInt(e.ti)>0&&mo.ga(mo.id+": "+mo.name,"load-topic",e.ti+": "+("undefined"!=typeof e.tn?e.tn:"")),"undefined"!=typeof e.ui&&parseInt(e.ui)>0&&mo.ga(mo.id+": "+mo.name,"load-subject",e.ui+": "+("undefined"!=typeof e.un?e.un:"")),"undefined"!=typeof e.ci&&parseInt(e.ci)>0&&mo.ga(mo.id+": "+mo.name,"load-category",e.ci+": "+("undefined"!=typeof e.cn?e.cn:"")),"undefined"!=typeof e.li&&parseInt(e.li)>0&&mo.ga(mo.id+": "+mo.name,"load-lesson",e.li+": "+("undefined"!=typeof e.ln?e.ln:""))}catch(t){try{mo.ga(mo.id+": "+mo.name,"loadPlay",t.toString()+", data: "+JSON.stringify(e))}catch(t){}}"undefined"!=typeof e.tz&&!$.isEmptyObject(e.tz),"undefined"!=typeof e.qz&&!$.isEmptyObject(e.qz),"undefined"!=typeof e.su&&!$.isEmptyObject(e.su);var o={category:{id:mo.category.id,count:mo.category.count},lesson:{id:mo.lesson.id,count:mo.lesson.count},subject:{id:mo.subject.id,count:mo.subject.count},topic:{id:mo.topic.id,count:mo.topic.count}};for(var n in e)if(e.hasOwnProperty(n))switch(n){case"pt":mo.setProperty("point-total",0,!1,!1),mo.addToTotal("point",e[n],!0,!1);break;case"zt":mo.setProperty("thword-total",0,!1,!1),mo.addToTotal("thword",e[n],!0,!1);break;default:mo.setProperty(n,e[n],!1,!1)}o.category.id>0&&mo.category.id==o.category.id?mo.addToCount("category",1):(mo.setProperty("category-count",1),mo.category.played.indexOf(mo.category.id)<0&&mo.push("category-played",mo.category.id)),o.lesson.id>0&&mo.lesson.id==o.lesson.id?mo.addToCount("lesson",1):(mo.setProperty("lesson-count",1),mo.lesson.played.indexOf(mo.lesson.id)<0&&mo.push("lesson-played",mo.lesson.id)),o.subject.id>0&&mo.subject.id==o.subject.id?mo.addToCount("subject",1):(mo.setProperty("subject-count",1),mo.subject.played.indexOf(mo.subject.id)<0&&mo.push("subject-played",mo.subject.id)),o.topic.id>0&&mo.topic.id==o.topic.id?mo.addToCount("topic",1):(mo.setProperty("topic-count",1),mo.topic.played.indexOf(mo.topic.id)<0&&mo.push("topic-played",mo.topic.id)),go.store(),fo.store(),mo.store()}Ie("topic",!0),Ie("score"),$.isEmptyObject(mo.thwords)?$.isEmptyObject(mo.quiz)?alert("No Thwords or quizzes found."):alert("QUIZ - these have not been implemented yet."):(mo.adjustedBonusOn()&&($.isEmptyObject(mo.bonusQuestions)||"undefined"==typeof mo.bonusQuestions.q||0===mo.bonusQuestions.q.length)&&mo.generateBonusQuestions(),Ce(),Ie("chars"),ke(),Ie("answers"),y()),go.store(),fo.store(),mo.store()}function F(){mo.ga(mo.id+": "+mo.name,"play-lose","topic "+mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-play-lose","topic "+mo.topic.id+": "+mo.topic.name),$(".thw-rack").not(".solved-thword").addClass("wrong-thword"),oe();for(var e=0;e<mo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");if(A("chars"),mo.bonus.on>0&&r()>0&&mo.save.status<0){if(mo.setProperty("status",0),mo.setProperty("save-status",1,!0),mo.addToTotal("save",1,!0),r()>1){$("#btn-show-bonus").html("BONUS QUESTIONS");var t="Game Over",o="However, you can continue your game if you answer all of the following bonus questions correctly."}else{$("#btn-show-bonus").html("BONUS QUESTION");var t="Game Over",o="However, you can continue your game if you answer the following bonus question correctly."}var n=Mustache.render($t,{title:t,details:o});z(n,{type:"fail",position:"top"}),Le("show-bonus",!0)}else Ie("feedback",!1),$e();Ie("start")}function H(e,t){t=t||!1;var o=mo.thwords.chs[e].m.length;if(!t)for(var n=0;n<mo.thwords.chs[e].m.length;n++){var s=mo.thwords.chs[e].m[n][0],a=mo.thwords.chs[e].m[n][1];mo.thwords.tls[s][a].f&&o--}return o}function G(){mo.addToTotal("bonus",1,!0);var e=W();if(e){switch(e.type){case"mc":case"tf":case"yn":var t=Mustache.render(Ot,e);break;case"tx":var o=e.answer.indexOf(" ");if(0>o)e.prefix="";else{var n=e.answer.slice(0,o+1);mo.thwords.cs.p.indexOf(n)>-1&&mo.adjustedSkillLevel()<3?(e.prefix=n,e.answer=e.answer.slice(o+1)):e.prefix=""}var t=Mustache.render(Lt,e);break;default:alert("Invalid question type")}$("#game-panel-bonus").html(t),$.each($(".question-answer"),function(){$(this).removeClass("hide").addClass("show")}),$(".question-answer").bind("click",function(e){$(this).hasClass("done")||(e.preventDefault(),vo(this))}),$("#submit-question-answer").on("click",function(e){e.preventDefault(),ze(this)}),$("#question-response").on("keypress",function(e){13==e.which&&(e.preventDefault(),ze($("#submit-question-answer")))}),$(".next-question").on("click",function(e){e.preventDefault(),G()}),"tx"==e.type&&$("#question-response").focus(),Ie("score",!0),Ie("bonus",!1)}else Ge()}function Y(){$("nav").css("display","block"),$("#content").css("min-height",$(window).height()),$("nav").css("opacity",1);var e=$("#content").width();$("#content").css("width",e),$("#menuContentLayer").css("display","block"),$("#container").bind("touchmove",function(e){e.preventDefault()}),$("#container").animate({marginLeft:["30%","easeOutExpo"]},{duration:700})}function J(e,t){$("#overlay-btn-container").hasClass("show")&&V(),t=t||{};var o=t.type||"standard",n=t["class"]||"",s=t.data||{},a=t.clickable||!0,i="undefined"!=typeof t.timeout?t.timeout:uo.overlayButtonDelay,r="undefined"!=typeof t.opacity?t.opacity:ut.overlayBackgroundOpacity,l=document.createElement("button");$(l).attr("id","overlay-btn"),$(l).addClass("btn").addClass("thw-btn").addClass("overlay-btn").addClass(o).addClass("show"),n&&$(l).addClass(n),$(l).html(e),$.each(s,function(e,t){$(l).attr("data-"+e,t)}),a&&$(l).on("click",function(e){V()}),r!==!1&&($("#overlay-background").css("opacity",r),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-btn-container").html("").append(l).removeClass("hide").addClass("show"),i&&(Wt=setTimeout(function(){V()},i))}function z(e,t){t=t||{},uo=uo||{},ut=ut||{};var o=t.type||"standard",n="undefined"!=typeof t.timeout?t.timeout:uo.overlayDivDelay||0,s=t["class"]||"",a=t.data||{},i=t.label||"Continue",r=t.position||"bottom",l=t.bindAction||!1,c=t.hideNav||!1,d="undefined"!=typeof t.opacity?t.opacity:ut.overlayBackgroundOpacity||.5;if(c&&$("#overlay-div-nav").addClass("hide"),$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),"top"==r?$("#overlay-div-content-top").html(e):$("#overlay-div-content").html(e),$("#overlay-continue-btn").text(i),$("#overlay-continue-btn").removeClass().addClass("btn").addClass("thw-btn").addClass("overlay-continue-btn").addClass("show"),s&&$("#overlay-continue-btn").addClass(s),$.each(a,function(e,t){$("#overlay-continue-btn").attr("data-"+e,t)}),d!==!1&&($("#overlay-background").css("opacity",d),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-div-container").removeClass().addClass(o).addClass("show"),s&&$("#overlay-div-container").addClass(s),l)switch(l){}n&&(Rt=setTimeout(function(){X()},n))}function R(){mo.ga(mo.id+": "+mo.name,"topic-repeat","topic "+mo.topic.id+": "+mo.topic.name),mo.setProperties({status:1,save_status:0}),mo.setProperty("count",mo.count+1),$(".strike-xs").html(""),v({topic_id:mo.topic.id})}function W(){try{if(r()<0)return!1;if("undefined"!=typeof mo.bonusQuestions||"undefined"!=typeof mo.bonusQuestions.questions){if("undefined"==typeof mo.bonusQuestions.idx)return mo.bonusQuestions.idx=99999,!1;if("undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx]&&mo.bonusQuestions.idx<=mo.bonus.total){var e={idx:mo.bonusQuestions.idx,title:mo.bonusQuestions.title?mo.bonusQuestions.title:mo.bonusQuestions.questions.length>0?"Bonus Questions":"Bonus Question",instructions:mo.bonusQuestions.label?mo.bonusQuestions.label:"Select the answer that best matches."};if(e.type="undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx].t?mo.bonusQuestions.questions[mo.bonusQuestions.idx].t:!1,e.question="undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx].q?mo.bonusQuestions.questions[mo.bonusQuestions.idx].q:"",e.answer="undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx].a?mo.bonusQuestions.questions[mo.bonusQuestions.idx].a:"",e.points="undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx].p?mo.bonusQuestions.questions[mo.bonusQuestions.idx].p:1,e.options=[],"undefined"!=typeof mo.bonusQuestions.questions[mo.bonusQuestions.idx].o)for(var t=0;t<mo.bonusQuestions.questions[mo.bonusQuestions.idx].o.length;t++)e.options[e.options.length]={text:mo.bonusQuestions.questions[mo.bonusQuestions.idx].o[t],option:t};return mo.bonusQuestions.idx=mo.bonusQuestions.idx+1,e}return mo.bonus.idx=99999,!1}return!1}catch(o){return console.log(o),uo.ga("Error","popNextBonusQuestion",o.toString()),!1}}function U(e){if("undefined"==typeof e.idx||"undefined"==typeof e.option||"undefined"==typeof e.correct)return mo.ga("Error","bonus-processing-problem",JSON.stringify(e)),alert("Can't process bonus."),!1;switch(idx=e.idx||0,option=e.option||0,correct=e.correct||0,mo.bonusQuestions.questions[idx].t){case"tx":break;case"mc":case"tf":case"yn":default:var t=option==correct?!0:!1;t?$("#question-answer-"+idx+"-"+correct).addClass("correct"):($("#question-answer-"+idx+"-"+option).addClass("wrong"),$("#question-answer-"+idx+"-"+correct).addClass("correct"))}if($.each($(".question-answer"),function(){$(this).addClass("done")}),$("#question-title").addClass("hide"),$("#question-instructions").addClass("hide"),mo.bonusQuestions.idx<mo.bonusQuestions.questions.length)Le("next-question",!0);else if($("#btn-next-question").removeClass("show").addClass("hide"),mo.bonus.count==mo.bonus.total){if(mo.ga(mo.id+": "+mo.name,"bonus-win","topic "+mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-bonus-win","topic "+mo.topic.id+": "+mo.topic.name),mo.save.status>0){mo.ga(mo.id+": "+mo.name,"save-win","topic "+mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-save-win","topic "+mo.topic.id+": "+mo.topic.name),mo.addToCount("save",1,!0),mo.setProperty("save-status",-1,!0);var o=Mustache.render(wt,{});z(o,{msgType:"success","class":"show-start-panel",timeout:0,position:"top"})}Le("next-round",!0),qe()}else mo.ga(mo.id+": "+mo.name,"bonus-lose","topic "+mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-bonus-lose","topic "+mo.topic.id+": "+mo.topic.name),mo.save.status>0?(mo.ga(mo.id+": "+mo.name,"save-lose","topic "+mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-save-lose","topic "+mo.topic.id+": "+mo.topic.name),mo.setProperty("save-status",0,!0),$e()):(Le("next-round",!0),qe());Ie("start"),Ie("feedback",!1)}function K(o){if("undefined"==typeof o)return!1;rt=!0,mo.push("char-played",o,!1);var n=uo.tileFlipDelay;if(H(o)>0){e();for(var s=0;s<mo.thwords.chs[o].m.length;s++)uo.tileFlipDelay?(oo.push([mo.thwords.chs[o].m[s][0],mo.thwords.chs[o].m[s][1]]),setTimeout(function(){Te()},n),n+=uo.tileFlipDelay):b(mo.thwords.chs[o].m[s][0],mo.thwords.chs[o].m[s][1])}else{Je();var a=mo.thwords.chs[o].v-11;t(a)}0==oo.length&&mo.status>0&&l(),rt=!1}function V(){clearTimeout(Wt),$("#overlay-btn-container").removeClass("show").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",ut.overlayBackgroundOpacity);var e=$("#overlay-btn");$(e).hasClass("process-char")&&"undefined"!=typeof $(e).attr("data-idx")?K($(e).data("idx")):$(e).hasClass("process-bonus")&&"undefined"!=typeof $(e).attr("data-correct")&&U({idx:$(e).data("idx"),option:$(e).data("option"),correct:$(e).data("correct")})}function X(){clearTimeout(Rt),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-div-container").removeClass("show").addClass("hide"),$("#overlay-div-nav").removeClass("hide"),$("#overlay-continue-btn").hasClass("process-char")&&"undefined"!=typeof $("#overlay-continue").attr("data-idx")?K($("#overlay-continue-btn").data("idx")):$("#overlay-continue-btn").hasClass("next-round")?Ge():$("#overlay-continue-btn").hasClass("show-start-panel")&&Ie("start"),d()}function Z(){var e=M();if(e.length>0){uo.validationOff(),go.validationOff(),fo.validationOff(),mo.validationOff();for(var t=0;t<e.length;t++)uo.setProperty(e[t].name,e[t].value,!0),mo.setProperty(e[t].name,e[t].value,!0);uo.validationOn(),go.validationOn(),fo.validationOn(),mo.validationOn()}}function ee(){u(),confirm("If you quit you will lose your current game.\n\nIf you want to keep your game use the Save and Exit option. \n\nAre you sure you want to quit?")&&(mo.ga(mo.id+": "+mo.name,"game-quit","points: "+go.point.total+", rounds: "+fo.count+", plays: "+mo.count),
    ne(),mo.setProperty("status",0,!0),mo.setProperty("save-status",0,!0),c(),document.location.href="/play")}function te(e,t){var o=mo.thwords.tls[e][t].l||"??";mo.thwords.tls[e][t].v||0;$("#tile-"+e+"-"+t).first().html(o)}function oe(){for(var e=(uo.tileFlipDelay,0);e<mo.thwords.tls.length;e++){for(var t=0;t<mo.thwords.tls[e].length;t++)0==mo.thwords.tls[e][t].s&&te(e,t);n(e,!0)}}function ne(){try{var e={gi:go.id,gg:go.slug,gr:go.random,sa:go.status,cc:go.category.choose,ci:go.category.choose<0?go.category.id:0,uc:go.subject.choose,ui:go.subject.choose<0?go.subject.id:0,tc:go.topic.choose,ti:go.lesson.choose<0?go.topic.id:0,lc:go.lesson.choose,li:go.lesson.choose<0?go.lesson.id:0,pb:go.bonus.on,rd:mo.count,al:go.lang,sl:go.skillLevel,kl:go.knowledgeLevel,zt:go.thword.total,zc:go.thword.count,zp:go.thword.percent,mm:go.move.max,mt:go.move.total,mc:go.move.count,mp:go.move.percent,pt:go.point.total,pc:go.point.count,pp:go.point.percent,bt:go.bonus.total,bc:go.bonus.count,bp:go.bonus.percent,ps:go.save.on,st:go.save.total,sc:go.save.count,sp:go.save.percent,hc:go.hitStreak.current,hl:go.hitStreak["long"],uid:po.id,uun:po.username,una:po.name,uem:po.email,sid:po.sessionId,gid:ho.id,gna:ho.name};try{mo.ga(mo.id+": "+mo.name,"record-stats","data: "+JSON.stringify(e))}catch(t){}var o="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/results/save?callback=?";uo.ga("API",uo.getApiDomain(),o),$.ajax({type:"POST",url:o,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",data:e,success:function(e){console.log("Game successfully recorded.")},error:function(t){try{mo.ga("Error","record-stats","data: "+JSON.stringify(e))}catch(t){}console.log("Record Stats Error:")}})}catch(t){console.log(t),uo.ga("Error","recordFinalStats",t.toString())}}function se(){go.point.count<0?$(".game-point-count").each(function(){$(this).addClass("negative")}):$(".game-point-count").each(function(){$(this).removeClass("negative")}),$("#moves-left").removeClass("txt-fail").removeClass("txt-danger"),parseInt(mo.move.remaining)<2?$("#moves-left").addClass("txt-fail"):parseInt(mo.move.remaining)<3&&$("#moves-left").addClass("txt-danger"),$(".round-moves-left-text").text(1==parseInt(mo.move.remaining)?"move left":"moves left");var e="";for(i=0;i<mo.move.strikes;i++)e+="X";$(".strike-xs").html(e)}function ae(){var e={version:lt,copyright:ct};return Mustache.render(pt,e)}function ie(){if($.isEmptyObject(mo)||$.isEmptyObject(mo.thwords)||"undefined"==typeof mo.thwords.ans)alert("Thword answers not found.");else for(var e={answers:[]},t=0;t<mo.thwords.ans.length;t++)e.answers[e.answers.length]={idx:t,answer:mo.thwords.ans[t],aux1:mo.thwords.aux1[t],aux2:mo.thwords.aux2[t],tileRack:ve(t)};return Mustache.render(ht,e)}function re(){var e={chars:[]};return $.isEmptyObject(mo)||$.isEmptyObject(mo.thwords.chs)||$.each(mo.thwords.chs,function(t,o){e.chars[e.chars.length]={idx:t,label:o.l,"class":1==o.f?" chosen":""},1==o.f&&mo.push("char-played",t,!1)}),Mustache.render(gt,e)}function le(e){var t=0,o={categories:e,lang:mo.lang,idx:function(){return t++}};return Mustache.render(ft,o)}function ce(e){var t=0,o={lessons:e,lang:mo.lang,idx:function(){return t++}};return Mustache.render(mt,o)}function de(e){var t=0,o={subjects:e,lang:mo.lang,idx:function(){return t++}};return Mustache.render(vt,o)}function ue(e){var t=0,o={topics:e,lang:mo.lang,idx:function(){return t++}};return Mustache.render(yt,o)}function pe(){var e={rounds:fo.count,plays:mo.count,thword:{total:go.thword.total,count:go.thword.count,percent:0!=go.thword.total?parseFloat(go.thword.percent).toFixed(2):""},move:{total:go.move.total,count:go.move.count,percent:0!=go.move.total?parseFloat(go.move.percent).toFixed(2):"",strikes:go.move.strikes},point:{total:go.point.total,count:go.point.count,percent:0!=go.point.percent?parseFloat(go.point.percent).toFixed(2):""},hitStreak:{"long":go.hitStreak["long"],current:go.hitStreak.current},bonus:{total:go.bonus.total,count:go.bonus.count,percent:0!=go.bonus.total?parseFloat(go.bonus.percent).toFixed(2):""},save:{total:go.save.total,count:go.save.count,percent:0!=go.save.total?parseFloat(go.save.percent).toFixed(2):""}};return Mustache.render(kt,e)}function he(){return Mustache.render(Ct,{})}function ge(){return Mustache.render(xt,{})}function fe(){var e={plays:mo.count,thword:{total:mo.thword.total,count:mo.thword.count,percent:0!=mo.thword.total?parseFloat(mo.thword.percent).toFixed(2):""},move:{total:mo.move.total,count:mo.move.count,percent:0!=mo.move.total?parseFloat(mo.move.percent).toFixed(2):"",strikes:mo.move.strikes,remaining:mo.move.remaining},point:{total:mo.point.total,count:mo.point.count,percent:0!=mo.point.total?parseFloat(mo.point.percent).toFixed(2):""},hitStreak:{"long":mo.hitStreak["long"],current:mo.hitStreak.current},bonus:{total:mo.bonus.total,count:mo.bonus.count,percent:0!=mo.bonus.total?parseFloat(mo.bonus.percent).toFixed(2):""},save:{total:mo.save.total,count:mo.save.count,percent:0!=mo.save.total?parseFloat(mo.save.percent).toFixed(2):""}};return Mustache.render(Pt,e)}function me(){return Mustache.render(St,{skillLevelOptions:eo,knowledgeLevelOptions:to,settings:uo,game:go,user:po,skillLevel:N(mo.skillLevel),knowledgeLevel:T(mo.knowledgeLevel),chooseCategory:go.category.choose>0?"Yes":"No",chooseSubject:go.subject.choose>0?"Yes":"No",chooseTopic:go.topic.choose>0?"Yes":"No",chooseLesson:go.lesson.choose>0?"Yes":"No",bonusOnOptions:go.bonus.on>0?"Yes":"No"})}function ve(e){for(var t=e%2?"odd-row":"even-row",o={idx:e,"class":t,tiles:[]},n=0;n<mo.thwords.tls[e].length;n++)o.tiles[o.tiles.length]={pos:n,label:mo.thwords.tls[e][n].l};return Mustache.render(_t,o)}function ye(){var e={tiles:[],prematureMsgClass:"hide"};return"undefined"!=typeof mo.thwords.chs?$.each(mo.thwords.chs,function(t,o){var n=o.l;!$.isEmptyObject(mo.thwords.cs.eq[o.l])&&mo.thwords.cs.eq[o.l].length>0&&(n+=" ("+mo.thwords.cs.eq[o.l].join(", ")+")"),e.tiles[e.tiles.length]={label:n,right:o.v,wrong:11-o.v}}):e.prematureMsgClass="show",Mustache.render(Dt,e)}function be(){$("#btn-topic-like").removeClass("clicked").removeClass("disabled"),$("#btn-topic-dislike").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-easy").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-hard").removeClass("clicked").removeClass("disabled"),$("#btn-topic-comment").removeClass("clicked").removeClass("disabled"),$("#btn-topic-problem").removeClass("clicked").removeClass("disabled")}function $e(){go.ga(fo.id+": "+fo.name,"round-over","points: "+fo.point.count+", plays: "+mo.count),fo.setProperty("status",0),fo.setProperty("save-status",0),w()}function we(){window.onbeforeunload=function(){},u(),mo.ga(mo.id+": "+mo.name,"game-exit","points: "+go.point.total+", rounds: "+fo.count+", plays: "+mo.count),document.location.href="/play"}function ke(){if($.isEmptyObject(mo)||"undefined"==typeof mo.thwords.ans){try{mo.ga(mo.id+": "+mo.name,"thword-answers-not-found","undefined"!=typeof mo.thwords?JSON.stringify(mo.thwords):"url"+document.location.href)}catch(e){}alert("No answers found.")}else{var t=ie();$("#game-panel-answers").html($.parseHTML(t))}}function Ce(){var e=re();$("#game-panel-chars").html(e),$(".char").bind("click",function(e){return e.preventDefault(),rt||oo.length>0?!1:void ko(this)})}function xe(){var e=document.location.toString().split(/[?#]/)[0];"/"===e.slice(-1)&&(e=e.substring(0,e.length-1)),$(".next-round-link").attr("href",e.toString().replace("/play/","/next/")+"?"+Math.floor(1e8*Math.random()+1)),0===parseInt(uo.getProperty("showAds"))?$(".next-round-link").on("click",function(e){e.preventDefault(),Ye()}):$(".next-round-link").on("click",function(e){window.onbeforeunload=function(){}})}function je(){if(fo.random){var e=P(fo.id);4!=e.id||!fo.random&&"en"!=mo.lang?e.lang="en":e.lang=D(mo.langs.length?mo.langs:Zt),mo.setProperties(e,!1),$(".game-name").html(I()),$(".game-shortName").html(_())}}function Te(){var e=oo.shift();b(e[0],e[1]),0==oo.length&&l()}function Oe(){ga("send","event","Global","panel-view","About"),u(),z(ae(),{type:"standard"})}function Le(e,t){t&&$(".btn").removeClass("show").addClass("hide"),$("#btn-"+e).removeClass("hide").addClass("show")}function Pe(){u(),z($("#debug-data").html(),{type:"standard"})}function Se(){$(".in-game-only").each(function(){$(this).removeClass("hide").addClass("show")})}function Ie(e,t){t=t||!1,t&&$(".game-panel").each(function(){$(this).removeClass("show").addClass("hide")}),$("#game-panel-"+e).removeClass("hide").addClass("show"),nt()&&($("#game-panel-stats").removeClass("hide").addClass("show"),$("#game-panel-debug").removeClass("hide").addClass("show"))}function _e(){ga("send","event","Global","panel-view","Feedback"),u(),z(he(),{type:"standard",label:"Cancel"}),$("#btn-general-feedback-cancel").on("click",function(e){e.preventDefault(),d()}),$("#btn-general-feedback-submit").on("click",function(e){e.preventDefault(),$("#general-feedback-text").val().length>0&&uo.ga("Feedback",$("#general-feedback-subject").val(),$("#general-feedback-text").val()),d()})}function De(){ga("send","event","Global","panel-view","Help"),u(),z(ge(),{type:"standard"})}function Ee(e){ga("send","event","Global","panel-view","High Scores"),e=e||{},e.gameId="undefined"!=typeof e.gameId?e.gameId:go.id,e.lang="undefined"!=typeof e.lang?e.lang:go.lang?go.lang:"en",e.knowledgeLevel="undefined"!=typeof e.knowledgeLevel?e.knowledgeLevel:go.knowledgeLevel,e.skillLevel="undefined"!=typeof e.skillLevel?e.skillLevel:mo.skillLevel,e.categoryId="undefined"!=typeof e.categoryId?e.categoryId:0,e.group="undefined"!=typeof e.group?e.group:ho.id,u(),z(Mustache.render(Tt,{}),{type:"standard"});var t="";e.gameId&&(t+="&gi="+e.gameId),e.knowledgeLevel&&(t+="&kl="+e.knowledgeLevel),e.skillLevel&&(t+="&sl="+e.skillLevel),e.lang&&(t+="&al="+e.lang),"undefined"!=typeof e.categoryId&&(t+="&ci="+e.categoryId),e.group&&(t+="&grp="+e.group),t.replace(/^&/,"");var o="http://"+uo.getApiDomain()+no.replace(/\/$/,"")+"/high-scores/get?callback=?"+t;uo.ga("API",uo.getApiDomain(),o),mo.ga(mo.id+": "+mo.name,"high-scores-get","url: "+o),o+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:o,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if($.isEmptyObject(t))var o="<h2>No scores found.</h2>";else{var n=[];$.each(t,function(e,t){t.tp=t.tp?parseFloat(t.tp).toFixed(2):"",t.mp=t.mp?parseFloat(t.mp).toFixed(2):"",t.pp=t.pp?parseFloat(t.pp).toFixed(2):"",t.bp=t.bp?parseFloat(t.bp).toFixed(2):null,t.sp=t.sp?parseFloat(t.sp).toFixed(2):null,t.sla=q(t.sl),t.kla=j(t.kl),t.tca=t.tc>0?"Y":"N",t.pba=t.pb>0?"Y":"N",n[n.length]=t})}var o=Mustache.render(jt,{scores:n});z(o,{type:"standard"}),$("#high-score-game").val(e.gameId+"-"+e.lang+"-"+e.categoryId),$("#high-score-skill-level").val(e.skillLevel),$("#high-score-game").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};Ee(o)}),$("#high-score-skill-level").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};Ee(o)})},error:function(e){console.log("Get Error 1005: url: "+o),uo.ga("Error","fetchHighScores","url: "+o),z("<p>There was a problem retrieving the high scores.</p><p>Try again later</p>",{type:"standard"})}})}function qe(){mo.topic.choose&&mo.topic.count<mo.topic.max&&Le("play-topic-again")}function Ne(){ga("send","event","Global","panel-view","Settings"),u(),z(me(),{hideNav:!0,type:"standard"}),$("#save-settings").on("click",function(e){try{mo.ga("Settings","save",""),po.name=$("#settings-user-name").val(),po.store()}catch(t){}X()}),$("#cancel-settings").on("click",function(e){X()})}function Qe(){ga("send","event","Global","panel-view","Game Stats"),u(),z(pe(),{type:"standard"})}function Me(){ga("send","event","Global","panel-view","Round Stats"),u(),z(fe(),{type:"standard"})}function Ae(){var e=Mustache.render(It,{user:po,skillLevelOptions:eo,knowledgeLevelOptions:to,chooseCategoryOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseSubjectOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseTopicOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseLessonOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],bonusOnOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],langOptions:L()});if($("#start-game-settings").html(e),Vt.indexOf(go.id)<0)$("#start-settings-langs").remove();else if("undefined"!==po.langs&&po.langs.constructor===Array)for(var t=0;t<po.langs.length;t++)$("#start-langs option[value="+po.langs[t]+"]").attr("selected",!0);if($("#start-skill-level").val(go.skillLevel),$("#start-knowledge-level").val(go.knowledgeLevel),$("#start-settings-knowledge-level").remove(),go.category.choose<=0&&$("#start-settings-category").remove(),$("#start-settings-category").remove(),go.subject.choose<=0&&$("#start-settings-subject").remove(),$("#start-settings-subject").remove(),go.topic.choose<=0&&$("#start-settings-topic").remove(),$("#start-settings-topic").remove(),go.lesson.choose<=0&&$("#start-settings-lesson").remove(),$("#start-settings-lesson").remove(),go.bonus.on>0?$("#start-bonus-on").val(go.bonus.on):$("#start-settings-bonus-on").remove(),$("#start-settings-bonus-on").remove(),!$.isEmptyObject(Nt)&&"undefined"!=typeof Nt.s&&parseInt(Nt.s)>0){if("undefined"!=typeof Nt.la){var o=!1;$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&($(this).data("lang")==go.lang?($(this).removeClass("hide").addClass("show"),o=!0):$(this).removeClass("show").addClass("hide"))}),o?$.each($(".lang-explanation-text"),function(){$(this).removeClass("show").addClass("hide")}):$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&$(this).removeClass("hide").addClass("show")})}if("undefined"!=typeof Nt.ap&&Nt.ap.length>0){for(var n=[],t=0;t<Nt.ap.length;t++){var s=O(Nt.ap[t]);s!==!1&&(n[n.length]=O(Nt.ap[t]))}n.length>1&&$("#start-settings-langs").html('<p class="label">Languages</p><p style="margin-bottom: 16px;">'+n.join(", ")+"</p>")}"undefined"!=typeof Nt.gs&&$("#start-settings-skillLevel").html('<p class="label">Skill Level: '+N(go.skillLevel)+"</p>"),"undefined"!=typeof Nt.gk&&$("#start-settings-knowledgeLevel").html('<p class="label">Knowledge Level: '+T(go.knowledgeLevel)+"</p>"),"undefined"!=typeof Nt.cc&&$("#start-settings-category").html('<p class="label">Category: '+(go.category.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Nt.uc&&$("#start-settings-subject").html('<p class="label">Subject: '+(go.subject.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Nt.tc&&$("#start-settings-topic").html('<p class="label">Topic: '+(go.topic.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Nt.lc&&$("#start-settings-lesson").html('<p class="label">Lesson: '+(go.lesson.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Nt.pb&&$("#start-settings-bonus-on").html('<p class="label">Bonus Questions: '+(go.bonus.om>0?"Yes":"No")+"</p>")}}function Be(){try{mo.ga(mo.id+": "+mo.name,"panel-view","Tile Values")}catch(e){}u(),z(ye(),{type:"standard"})}function Fe(e){for(var t,o,n=e.length;n;t=Math.floor(Math.random()*n),o=e[--n],e[n]=e[t],e[t]=o);return e}function He(){go.ga(go.id+": "+go.name,"game-start","user: "+po.name),mo.setProperties({status:0,save_status:0}),go.setProperties({status:1},!1),go.setProperty("count",go.count+1),go.ga(go.id+": "+go.name,"game-count",go.count),go.ga(go.id+": "+go.name,"game-count-"+go.skillLevel+"-knowledge-"+go.knowledgeLevel,go.count),Ie("start",!0),Ye()}function Ge(){$(".strike-xs").html(""),mo.setProperties({status:1,save_status:0}),mo.setProperty("count",mo.count+1),je(),mo.ga(mo.id+": "+mo.name,"play-start","user: "+po.name),mo.ga(mo.id+": "+mo.name,"play-count",mo.count),mo.ga(mo.id+": "+mo.name,"play-count-"+mo.skillLevel+"-knowledge-"+mo.knowledgeLevel,mo.count),mo.adjustedChooseCategory()>0?p():mo.adjustedChooseSubject()>0?g():mo.adjustedChooseTopic()>0?f():mo.adjustedChooseLesson()>0?h():v({})}function Ye(){fo.ga(fo.id+": "+fo.name,"round-start","user: "+po.name),fo.setProperties({status:1,save_status:0}),fo.setProperty("count",fo.count+1),fo.ga(fo.id+": "+fo.name,"round-count",fo.count),fo.ga(fo.id+": "+fo.name,"round-count-"+fo.skillLevel+"-knowledge-"+fo.knowledgeLevel,fo.count),Ge()}function Je(){mo.addToTotal("move",1),mo.setProperty("move-strikes",mo.move.strikes+1,!0),mo.setProperty("move-remaining",mo.move.max-mo.move.total),mo.store(),mo.setProperty("hitStreak-current",0,!0),se()}function ze(e){if($("#question-response").length){var t=parseInt($(e).data("idx")),o=parseInt($(e).data("option")),n=Re($("#question-response-prefix").text()+$("#question-response").val(),mo.bonusQuestions.questions[t].a),s=mo.bonusQuestions.questions[t].p;$("#question-response").attr("disabled","disabled"),n?($("#question-response").addClass("success"),J("Correct",{type:"success","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:uo.overlayButtonDelay})):($("#question-response").addClass("fail"),$("#text-question-answer").html("Answer: "+mo.bonusQuestions.questions[t].a).removeClass("hide").addClass("show"),J(Mustache.render(Et,{correctAnswer:mo.bonusQuestions.questions[t].a}),{type:"error","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:5e3}))}else{alert("question-response field not found.");try{ga.play("Error","bonus-input-missing","question-response input text field not found. : "+JSON.stringify(mo.bonusQuestions))}catch(a){}}}function Re(e,t){var o=e,n=t;return o=o.trim(),n=n.trim(),o=o.toLowerCase(),n=n.toLowerCase(),0===o.localeCompare(n)?1:0}function We(e,t,o){o=o||!0,mo.thwords.tls[e][t].s=o?1:0}function Ue(){nt()&&($("#game-panel-debug").css("background-color","#e8e8e8").css("color","#000").css("border","solid 1px #000").css("padding","12px"),$("#game-panel-debug").html("<b>Play</b><hr>"+JSON.stringify(mo,null,4)+"<br><br><b>Round</b><hr>"+JSON.stringify(fo,null,4)+"<br><br><b>Game</b><hr>"+JSON.stringify(go,null,4)+"<br><br><b>Settings</b><hr>"+JSON.stringify(uo,null,4)+"<br><br><b>Group</b><hr>"+JSON.stringify(ho,null,4)+"<br><br><b>User</b><hr>"+JSON.stringify(po,null,4)+"<br><br><b>Session</b>: "+so))}function Ke(e){e=e||{};var t=[],o={},n={};return $.isEmptyObject(e)||(n.id="undefined"!=typeof $(e).data("id")?$(e).data("id"):go.id,n.name="undefined"!=typeof $(e).data("name")?$(e).data("name"):go.name,n.lang="undefined"!=typeof $(e).data("lang")?$(e).data("lang"):go.lang,"undefined"==typeof Xt[n.lang]&&(t[t.length]="Invalid lang "+n.lang+".")),$("#start-langs").length&&(n.langs=$("#start-langs").val(),alert($("#start-langs").val().toSource()),!$("#start-langs").val()||[5,6,7,8].indexOf(go.id)>-1&&$("#start-langs").val().length<2?t[t.length]="Please select at least two langs":(n.langs=$("#start-langs").val(),o.langs=n.langs)),$("#start-user-name").length&&(o.name=$("#start-user-name").val()),$("#start-skill-level").length&&(n.skillLevel=parseInt($("#start-skill-level").val())),$("#start-knowledge-level").length&&(n.knowledgeLevel=parseInt($("#start-knowledge-level").val())),$("#start-choose-category").length&&(n["category-choose"]=Xe(parseInt($("#start-choose-category").val()),go.id)),$("#start-choose-subject").length&&(n["subject-choose"]=et(parseInt($("#start-choose-subject").val()),go.id)),$("#start-choose-topic").length&&(n["topic-choose"]=tt(parseInt($("#start-choose-topic").val()),go.id)),$("#start-choose-lesson").length&&(n["lesson-choose"]=Ze(parseInt($("#start-choose-lesson").val()),go.id)),$("#start-bonus-on").length&&(n["bonus-on"]=parseInt($("#start-bonus-on").val())),t.length?(alert(t.join("\n\n")),!1):($.isEmptyObject(o)||(po.setProperties(o),po.ga("User","start","user:"+po.name)),$.isEmptyObject(n)||(mo.setProperties(n,!0),"undefined"!=typeof n.id&&go.ga(go.id+": "+go.name,"game-user","user: "+po.name)),Ve(),Ue(),!0)}function Ve(){$("#embed-link").val(C()),$("#link-link").val(E({s:1}))}function Xe(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function Ze(e,t){return e=parseInt(e),t=t||!1,0}function et(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function tt(e,t){return e=parseInt(e),t=t||!1,e}function ot(){mo.ga(mo.id+": "+mo.name,"play-win",mo.topic.id+": "+mo.topic.name),mo.ga(mo.id+": "+mo.name,"skill"+mo.skillLevel+"-knowledge"+mo.knowledgeLevel+"-play-win",mo.topic.id+": "+mo.topic.name);for(var e=0;e<mo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");A("chars");var t={msg:"Congratulations",score:mo.point.count,perfectScore:mo.point.count==mo.point.total?1:0},o=Mustache.render(bt,t)+pe();z(o,{type:"success"}),mo.bonus.on>0&&r()>0?($("#btn-show-bonus").html(r()>1?"BONUS QUESTIONS":"BONUS QUESTION"),Le("show-bonus",!0),Ie("start")):(Le("next-round",!0),qe(),Ie("start"),Ie("feedback",!1))}function nt(){var e=$.cookie("debug")||0;return parseInt(e)?!0:!1}function st(e){e&&(0==e?($.removeCookie("debug"),$("#show-debug-data").addClass("hide").removeClass("show")):($.cookie.json,$.cookie("debug",1),$("#show-debug-data").addClass("show").removeClass("hide")))}function at(e,t,o,n){"use strict";t=t||{},o=o||{},this._initialized=!1,this._name=e,this._cookie=t.cookie||"Woggle-"+this._name,this._cookie.replace(/\W/g,""),this._parent=t.parent||{},this._autoStore=t.autoStore||1,this._initialProperties=o||{},this._validation=1,this._ts=Date.now(),this.addToCount=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToCount method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-count");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("total")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-count","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToCount(e,t,o,n),this.updateTimeStamp(),!0)},this.addToTotal=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToTotal method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-total");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("count")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-total","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToTotal(e,t,o,n),this.updateTimeStamp(),!0)},this.autoStore=function(e){return"undefined"!=typeof e?(this._autoStore=e,this):this._autoStore},this.ga=function(e,t,o){try{ga("send","event",e||this._name,t,o)}catch(n){}},this.getCookie=function(){return $.cookie(this._cookie)},this.getProperty=function(e){if(e.indexOf("-")>=0)var t=e.split("-");else var t=e.split("_");return this.hasOwnProperty(t[0])?2===t.length?this[t[0]].hasOwnProperty(t[1])?this[t[0]][t[1]]:(alert("2. Invalid "+this._name+" property "+e+"."),null):this[e]:(alert("Invalid "+this._name+" property "+e+"."),null)},this.getPropertyName=function(e,t){"undefined"==typeof t&&(t=!0);for(var e=e.replace("_","-"),o=!1,n=0;n<this._initialProperties.length;n++)if(e===this._initialProperties[n][0]||"undefined"!=typeof this._initialProperties[n][2]&&e===this._initialProperties[n][2]){o=this._initialProperties[n][0];break}if(o!==!1&&t){var s=o.split("-");if(2===s.length){if(!this.hasOwnProperty(s[0])||!this[s[0]].hasOwnProperty(s[1]))return!1}else if(!this.hasOwnProperty(s[0]))return!1}return o},this.load=function(e){if(e=e||[],!$.isEmptyObject(e))for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t],!1,!1);this._autoStore&&this.store()},this.name=function(e){return"undefined"!=typeof e?(this._name=e,this):this._name},this.parseJSON=function(e){e=e||!1;for(var t={},o=0;o<this._initialProperties.length;o++)t[e?this._initialProperties[o][2]:this._initialProperties[o][0]]=this.getProperty(this._initialProperties[o][0]);return t},this.push=function(e,t,o){o=o||!1;var n=this.getPropertyName(e);if(n===!1)return alert("Invalid "+this._name+" property "+e+" in append method."),!1;var s=n.split("-");if(2===s.length){if(this[s[0]][s[1]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][s[1]][this[s[0]][s[1]].length]=t,this[s[0]][s[1]].length>100&&this[s[0]][s[1]].length.shift(),this.reflowProperty(n)}else{if(this[s[0]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][this[s[0]].length]=t,this[s[0]].length>100&&this[s[0]].length.shift(),this.reflowProperty(n)}return this._autoStore&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.push(e,t,o),this.updateTimeStamp(),!0},this.reflow=function(){for(var e=0;e<this._initialProperties.length;e++)this.reflowProperty(this._initialProperties[e][0])},this.reflowProperty=function(e){var t=this.getPropertyName(e);if(t!==!1){var o=this.getProperty(t);$("."+this._name+"-"+t).text(o)}},this.setProperties=function(e,t){"undefined"==typeof t&&(t=!0);var o=!1;for(var n in e)e.hasOwnProperty(n)&&(o=this.setProperty(n,e[n],t,!1)||o);return o&&this._autoStore&&this.store(),this.updateTimeStamp(),o},this.setProperty=function(e,t,o,n){"undefined"==typeof o&&(o=!1),"undefined"==typeof n&&(n=!0);var s=!1,a=this.getPropertyName(e,!1);if(a===!1)return this._validation>0&&alert("3. Invalid "+this._name+" property "+e+"."),s;if(a.indexOf("-")<0)var i=a.split("_");else var i=a.split("-");if(2===i.length){if(this.hasOwnProperty(i[0])){if(!this[i[0]].hasOwnProperty(i[1])&&this.initialized)return alert("5. Invalid "+this._name+" property "+e+"."),s}else{if(this._initialized)return alert("4. Invalid "+this._name+" property "+e+"."),s;this[i[0]]={}}this[i[0]][i[1]]!==t&&(s=!0),this[i[0]][i[1]]=t}else{if(!this.hasOwnProperty(i[0])&&this.initialized)return alert("6. Invalid "+this._name+" property "+e+"."),!1;this[i[0]]!==t&&(s=!0),this[i[0]]=t}return s&&(this.reflowProperty(e,t),n&&this._autoStore&&this.store()),o&&this.hasOwnProperty("_parent")&&"undefined"!=typeof this._parent.setProperty&&this._parent.setProperty(e,t,o,n),this.updateTimeStamp(),s},this.store=function(){var e=new Date;e.setTime(e.getTime()+63072e6),$.cookie.json,$.cookie(this._cookie,this.stringify(!0),{path:"/",expires:e})},this.stringify=function(e){return JSON.stringify(this.parseJSON(e||!1))},this.updateTimeStamp=function(){this._ts=Date.now(),"undefined"!=typeof this.timeStamp&&(this.timeStamp=this._ts)},this.validationOff=function(){this._validation=0},this.validationOn=function(){this._validation=1};for(var s=0;s<this._initialProperties.length;s++)this.setProperty(this._initialProperties[s][0],this._initialProperties[s][1],!1,!1);"undefined"!=typeof n?this.load(n):this._autoStore&&this.store(),this._initialized=!0,this.updateTimeStamp()}if(st(Q("debug")||!1),a(),"undefined"==typeof woggle||$.isEmptyObject(woggle))return $("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1;if("undefined"==typeof woggle.game||"undefined"==typeof woggle.game.id){try{uo.ga("Error","invalid-woggle",document.location.href+", woggle: "+woggle.stringify())}catch(it){}return alert("Invalid woggle object."),$("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1}var rt=!1,lt="1.0.0",ct=2105,dt=[{id:1,name:"Thwords",shortName:"Thwords",abbrev:"TH",slug:"thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:2,name:"Thword Plays",shortName:"Thword Plays",abbrev:"TP",slug:"thword-plays",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:3,name:"Anti-Thwords",shortName:"Anti-Thwords",abbrev:"AT",slug:"anti-thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:4,name:"Foreign Thwords",shortName:"Foreign Thwords",abbrev:"FT",slug:"foreign-thwords",description:null,details:null,lang:"es",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:5,name:"Random Thwords",shortName:"Random Thwords",abbrev:"RT",slug:"random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:0,save_on:0},{id:6,name:"Random Foreign Thwords",shortName:"Random Foreign",abbrev:"RFT",slug:"random-foreign-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:7,name:"Totally Random Thwords",shortName:"Totally Random",abbrev:"TRT",slug:"totally-random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:8,name:"Language Drills",shortName:"Language Drills",abbrev:"LD",slug:"language-drills",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1}],ut={overlayBackgroundOpacity:.5},pt=document.getElementById("about-template").innerHTML,ht=document.getElementById("answers-template").innerHTML,gt=document.getElementById("char-rack-template").innerHTML,ft=document.getElementById("choose-category-template").innerHTML,mt=document.getElementById("choose-lesson-template").innerHTML,vt=document.getElementById("choose-subject-template").innerHTML,yt=document.getElementById("choose-topic-template").innerHTML,bt=document.getElementById("congrats-msg-template").innerHTML,$t=document.getElementById("end-of-game-overlay-template").innerHTML,wt=document.getElementById("game-save-template").innerHTML,kt=document.getElementById("game-stats-template").innerHTML,Ct=document.getElementById("general-feedback-template").innerHTML,xt=document.getElementById("help-template").innerHTML,jt=document.getElementById("high-scores-template").innerHTML,Tt=(document.getElementById("initializing-template").innerHTML,document.getElementById("loading-template").innerHTML),Ot=(document.getElementById("question-fill-in-the-blank-template").innerHTML,document.getElementById("question-multiple-choice-template").innerHTML),Lt=(document.getElementById("question-multi-select-template").innerHTML,document.getElementById("question-sequence-template").innerHTML,document.getElementById("question-text-template").innerHTML),Pt=document.getElementById("round-stats-template").innerHTML,St=document.getElementById("settings-template").innerHTML,It=document.getElementById("start-settings-template").innerHTML,_t=document.getElementById("tile-rack-template").innerHTML,Dt=document.getElementById("tile-values-template").innerHTML,Et=document.getElementById("wrong-answer-template").innerHTML,qt=x(woggle.game.id);if($.isEmptyObject(qt)){try{uo.ga("Error","undefined-game-id",document.location.href+" : "+JSON.stringify(woggle))}catch(it){}return alert("Game "+woggle.game.id+" not defined."),!1}var Nt=M(!0),Qt=$.cookie("Woggle-settings");Qt=Qt?$.parseJSON(Qt):{};var Mt=$.cookie("Woggle-user");Mt=Mt?$.parseJSON(Mt):{};var At=$.cookie("Woggle-group");At=At?$.parseJSON(At):{};var Bt=$.cookie("Woggle-game");
    Bt=Bt?$.parseJSON(Bt):{};var Ft=$.cookie("Woggle-round");Ft=Ft?$.parseJSON(Ft):{};var Ht=$.cookie("Woggle-play");Ht=Ht?$.parseJSON(Ht):{};var Gt=!0;if(!($.isEmptyObject(Qt)||$.isEmptyObject(Mt)||$.isEmptyObject(At)||$.isEmptyObject(Bt)||$.isEmptyObject(Ft)||$.isEmptyObject(Ht))&&"undefined"!=typeof Bt.id&&"undefined"!=typeof Bt.ga&&parseInt(Bt.ga)>0)if(Bt.id==woggle.game.id)Gt=!1;else{if(!confirm("You currently have an active game of "+Bt.gn+".\n\nIf you continue you will lose that game.\n\nDo you want to start this new game anyway?"))return document.location.href=Bt.ur,!1;Gt=!0}var Yt="en";"undefined"!=typeof Bt.al&&(Yt=Bt.al);var Jt=2;"undefined"!=typeof Bt.gs&&(Jt=Bt.gs);var zt=2;"undefined"!=typeof Bt.gk&&(zt=Bt.gk),$("#container-content").removeClass("show").addClass("hide"),$("#container-initializing").removeClass("hide").addClass("show");try{ga("send","event","Game","initialize","woggle: "+JSON.stringify(woggle))}catch(it){}var Rt,Wt,Ut=[1,2,3,4],Kt=[1,2,3],Vt=[6,7,8],Xt={de:"German",en:"English",es:"Spanish",fr:"French",is:"Icelandic",it:"Italian",pl:"Polish",po:"Portuguese",ru:"Russian",tr:"Turkish",uk:"Ukrainian"},Zt=["de","es","fr","is","it","pl","po","ru","tr","uk"],eo=[{value:1,name:"Novice",abbrev:"N"},{value:2,name:"Amateur",abbrev:"A"},{value:3,name:"Pro",abbrev:"P"},{value:4,name:"Expert",abbrev:"E"}],to=[{value:0,name:"Elementary",abbrev:"el"},{value:1,name:"High School",abbrev:"hs"},{value:2,name:"College",abbrev:"co"},{value:3,name:"Graduate",abbrev:"gr"},{value:4,name:"Doctorate",abbrev:"do"},{value:5,name:"Genius",abbrev:"ge"},{value:6,name:"Super Genius",abbrev:"g+"}],oo=[],no="/api/",so=k(),ao=[["sessionId",so,"se"],["domain",document.domain,"dm"],["apiDomain",null,"ad"],["apiDomains",[document.domain],"as"],["statsDomain",null,"sd"],["showAds",1,"ads"],["overlayDivDelay",0,"odd"],["overlayButtonDelay",500,"obd"],["tileFlipDelay",300,"tfd"],["timeStamp",Date.now(),"ts"]],io=[["sessionId",so,"se"],["id",null,"id"],["name",null,"na"],["username",null,"un"],["email",null,"em"],["lang","en","al"],["langs",[],"ap"],["timeStamp",Date.now(),"ts"]],ro=[["sessionId",so,"se"],["id",null,"id"],["name",null,"na"],["timeStamp",Date.now(),"ts"]],lo=[["sessionId",so,"se"],["id",-1,"id"],["status",-1,"ga"],["count",0,"go"],["name","Thwords","gn"],["shortName","Thwords","sn"],["abbrev","TH","ab"],["description",null,"gd"],["details",null,"gt"],["slug","thwords","gg"],["url",window.location.href,"ur"],["random",0,"gr"],["lang","en","al"],["langs",Zt,"ap"],["knowledgeLevel",2,"gk"],["skillLevel",2,"gs"],["maxPlays",-1,"gm"],["category-choose",0,"cc"],["category-id",0,"ci"],["category-name",null,"cn"],["category-max",1,"cm"],["category-count",0,"co"],["category-played",[],"cp"],["subject-choose",0,"uc"],["subject-id",0,"ui"],["subject-name",null,"un"],["subject-max",1,"um"],["subject-count",0,"uo"],["subject-played",[],"up"],["topic-choose",0,"tc"],["topic-id",0,"ti"],["topic-name",null,"tn"],["topic-lang","en","tl"],["topic-description",null,"td"],["topic-details",null,"tt"],["topic-max",1,"tm"],["topic-count",0,"to"],["topic-played",[],"tp"],["lesson-choose",0,"lc"],["lesson-id",0,"li"],["lesson-name",null,"ln"],["lesson-max",1,"lm"],["lesson-count",0,"lo"],["lesson-played",[],"lp"],["thword-total",0,"zt"],["thword-count",0,"zc"],["thword-percent",null,"zp"],["move-max",0,"mm"],["move-total",0,"mt"],["move-count",0,"mc"],["move-percent",null,"mp"],["move-strikes",0,"mx"],["move-remaining",0,"mr"],["point-total",0,"pt"],["point-count",0,"pc"],["point-percent",null,"pp"],["bonus-on",1,"pb"],["bonus-total",0,"bt"],["bonus-count",0,"bc"],["bonus-value",0,"bv"],["bonus-percent",null,"bp"],["save-on",1,"ps"],["save-status",-1,"sa"],["save-total",0,"st"],["save-count",0,"sc"],["save-percent",null,"sp"],["hitStreak-current",0,"hc"],["hitStreak-long",0,"hl"],["thwords",{},"tz"],["char-played",[],"ch"],["tile-flipped",[],"tf"],["quiz",{},"qz"],["survey",{},"su"],["bonusQuestions",{},"bq"],["timeStamp",Date.now(),"ts"]];if(Gt){for(var co in qt)qt.hasOwnProperty(co)&&"undefined"==typeof woggle.game[co]&&(woggle.game[co]=qt[co]);var uo=new at("settings",{},ao,Qt);$.isEmptyObject(woggle.settings)||$.each(woggle.settings,function(e,t){uo.setProperty(e,t)});var po=new at("user",{},io,Mt),ho=new at("group",{},ro,At),go=new at("game",{},lo,woggle.game||{}),fo=new at("round",{parent:go},lo,woggle.game||{}),mo=new at("play",{parent:fo},lo,woggle.game||{});mo.setProperty("lang",Yt,!0),mo.setProperty("skillLevel",Jt,!0),mo.setProperty("knowledgeLevel",zt,!0)}else var uo=new at("settings",{},ao,Qt),po=new at("user",{},io,Mt),ho=new at("group",{},ro,At),go=new at("game",{},lo,Bt),fo=new at("round",{parent:go},lo,Ft),mo=new at("play",{parent:fo},lo,Ht);uo.getApiDomain=function(){return this.apiDomain?this.apiDomain:this.nextApiDomain()},uo.nextApiDomain=function(){if(0===this.apiDomains.length)return uo._validation&&(uo.ga("Error","no-apiDomains-specified",document.location.href),alert("No apiDomains specified.")),null;if(1!==this.apiDomains.length&&this.apiDomain){for(var e=0;e<this.apiDomains.length;e++)if(this.apiDomains[e]===this.apiDomain){this.apiDomain=e+1<this.apiDomains.length?this.apiDomains[e+1]:this.apiDomains[0];break}return this.apiDomain}return this.setProperty("apiDomain",this.apiDomains[0]),this.apiDomain},mo.adjustedBonusOn=function(){return go.point.total>1e3?mo.bonus.on:go.point.total>2e3?0:mo.bonus.on},mo.adjustedChooseCategory=function(){return go.point.total>2e3?0:mo.category.choose},mo.adjustedChooseLesson=function(){return go.point.total>2e3?0:mo.lesson.choose},mo.adjustedChooseSubject=function(){return go.point.total>2e3?0:mo.subject.choose},mo.adjustedChooseTopic=function(){return go.point.total>2e3?0:mo.topic.choose},mo.adjustedKnowledgeLevel=function(){return go.point.total>1e3?this.knowledgeLevel<3?this.knowledgeLevel+1:this.knowledgeLevel:go.point.total>2500?4:this.knowledgeLevel},mo.adjustedSkillLevel=function(){return go.point.total>1e3?this.skillLevel<3?this.skillLevel+1:this.skillLevel:go.point.total>2500?4:this.skillLevel},mo.generateQuestion=function(e,t,o){o=o||{};var n="undefined"!=typeof o.points?o.points:1,s={t:"undefined"!=typeof o.qType?o.qType:"mc",q:e,a:null,o:[],c:null,p:n};if(t.constructor.toString().indexOf("Array")>-1){if("undefined"==typeof o.idx)return this.ga("Error","generateQuestions-no-index-specified","answers: "+JSON.stringify(t)),alert("generateQuestions method no index specified, answers: "+JSON.stringify(t)),!1;if("undefined"==typeof t[o.idx])return this.ga("Error","generateQuestions-invalid-idx","answers: "+JSON.stringify(t)),alert("generateQuestions method invalid idx "+o.idx+", answers: "+JSON.stringify(t)),!1;switch(s.a=t[o.idx],s.t){case"tx":s.a=e,s.q=t[o.idx];break;case"tf":case"yn":if(Math.random()<.5)s.c=0,s.q=s.q+" = "+s.a;else{s.c=1;var a="",i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=Fe(i);for(var r=0;r<i.length;r++)i[r].idx!=o.idx&&(a=i[r].label);s.q=s.q+" = "+a}s.o="tf"==s.t?["True","False"]:["Yes","No"];break;case"mc":default:if(m(t))return!1;var i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=Fe(i);for(var r=0;r<i.length;r++)s.o[s.o.length]=i[r].label,i[r].idx==o.idx&&(s.c=r)}}else s.t="tx",s.a=t;return s},mo.generateBonusQuestions=function(){if(this.bonusQuestions={},this.bonusQuestions.questions=[],!$.isEmptyObject(mo)&&!$.isEmptyObject(this.thwords)&&"undefined"!=typeof this.thwords.ans&&this.thwords.ans.length>1&&"undefined"!=typeof this.thwords.aux1&&this.thwords.ans.length===this.thwords.aux1.length)if(4==this.id)try{for(var e=[],t=0;t<this.thwords.ans.length;t++){var o=this.generateQuestion(this.thwords.ans[t],this.thwords.aux1,{idx:t,qType:mo.getQuestionType(this.thwords.ans[s],{gameId:this.id,lang:this.lang})});o!==!1&&(e[e.length]=o)}this.bonusQuestions.questions=Fe(e)}catch(n){console.log(n),this.ga("Error","generateBonusQuestions: multiple",n.toString())}else try{var s=Math.floor(Math.random()*this.thwords.aux1.length);if(this.thwords.aux1[s]){var o=this.generateQuestion(this.thwords.ans[s],this.thwords.aux1,{idx:s,qType:mo.getQuestionType(this.thwords.ans[s])});o!==!1&&(this.bonusQuestions.questions=[o])}}catch(n){this.ga("Error","generateBonusQuestions: single",n.toString()),console.log(n)}this.bonusQuestions.idx=this.bonusQuestions.questions.length>0?0:9999},mo.getQuestionType=function(e,t){e=e||"",t=t||{};var o=("undefined"!=typeof t.gameId?t.gameId:-1,"undefined"!=typeof t.lang?t.lang:"en");if(2==mo.id)return"mc";if(4!=mo.id)return!1;var n=this.adjustedSkillLevel(),s=Math.random();switch(n){case 3:return.2>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=12?"tx":"mc":.4>s?"tf":"mc";case 4:return.4>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=15?"tx":"mc":.6>s?"tf":"mc";case 0:case 1:case 2:default:return.25>s?"tf":"mc"}},nt()&&(window.thwordData={settings:uo,user:po,group:ho,game:go,round:fo,play:mo}),Z(),Ve(),1==Q("s")?go.ga(go.id+": "+go.name,"start-shared","url: "+document.location.href):1==Q("e")?go.ga(go.id+": "+go.name,"start-embed","url: "+document.location.href):go.ga(go.id+": "+go.name,"start-new","url: "+document.location.href),Ue(),s(),$("#container-content").removeClass("hide").addClass("show"),$("#container-initializing").removeClass("show").addClass("hide"),Se(),Gt?Ae():He();var vo=function(e){var o=parseInt($(e).data("idx")),n=parseInt($(e).data("option")),s=mo.bonusQuestions.questions[o].c,a=mo.bonusQuestions.questions[o].p;if(n==s){t(a),mo.addToCount("bonus",1,!0);var i="Correct";if(["tf","yn"].indexOf(mo.bonusQuestions.questions[o].t)>-1&&mo.bonusQuestions.questions[o].c>0){i+="<p>The right answer is "+mo.bonusQuestions.questions[o].a+".</p>";var r=5e3}else var r=uo.overlayButtonDelay;$("#submit-question-answer").removeClass("show").addClass("hide"),J(i,{type:"success","class":"process-bonus",data:{idx:o,option:n,correct:s,points:a},timeout:r})}else J(Mustache.render(Et,{correctAnswer:mo.bonusQuestions.questions[o].a}),{type:"error","class":"process-bonus",data:{idx:o,option:n,correct:s,points:a},timeout:0})},yo=function(e){if("undefined"==typeof $(e).data("category-id"))return alert("No category selected."),!1;if(parseInt($(e).data("category-id"))>0)var t=parseInt($(e).data("category-id")),o=$(e).text();else var t=0,o="WILD CARD";mo.ga(mo.id+": "+mo.name,"category-select",t+": "+o);try{mo.adjustedChooseSubject()>0?g():mo.adjustedChooseTopic()>0?f():v({category_id:t})}catch(n){console.log(n),uo.ga("Error","selectCategory",n.toString())}},bo=function(e){if("undefined"==typeof $(e).data("lesson-id"))return alert("No lesson selected."),!1;if(parseInt($(e).data("lesson-id"))>0)var t=parseInt($(e).data("lesson-id")),o=$(e).text();else var t=0,o="WILD CARD";mo.ga(mo.id+": "+mo.name,"lesson-select",t+": "+o);try{v({lesson_id:t})}catch(n){console.log(n),uo.ga("Error","selectLesson",n.toString())}},$o=function(e){if("undefined"==typeof $(e).data("subject-id"))return alert("No subject selected."),!1;if(parseInt($(e).data("subject-id"))>0)var t=parseInt($(e).data("subject-id")),o=$(e).text();else var t=0,o="WILD CARD";mo.ga(mo.id+": "+mo.name,"subject-select",t+": "+o);try{mo.adjustedChooseTopic()>0?f():v({subject_id:t})}catch(n){console.log(n),uo.ga("Error","selectSubject",n.toString())}},wo=function(e){if(be(),"undefined"==typeof $(e).data("topic-id"))return alert("No topic selected."),!1;if(parseInt($(e).data("topic-id"))>0)var t=parseInt($(e).data("topic-id")),o=$(e).text();else var t=0,o="WILD CARD";mo.ga(mo.id+": "+mo.name,"topic-select",t+": "+o);try{v({topic_id:t})}catch(n){console.log(n),uo.ga("Error","selectTopic",n.toString())}},ko=function(e){var t=$(e).data("idx")||!1;try{if(t)if($(e).hasClass("chosen"));else{$(e).addClass("chosen");var o=mo.thwords.chs[t].v,n=H(t);if(n>0){var o=o*n,s=n+(1==n?" match!":" matches!");s+="<br>"+o+(1==o?" point.":" points."),J(s,{type:"success","class":"process-char",data:{idx:t},timeout:uo.overlayButtonDelay,opacity:!1})}else{var a=Math.abs(o-11),s="Strike!";s+="<br>You lose "+a+(1==a?" point":" points."),J(s,{type:"fail","class":"process-char",data:{idx:t},timeout:uo.overlayButtonDelay,opacity:!1})}}else alert("No index.")}catch(i){console.log(i),uo.ga("Error","selectChar",i.toString())}}}()});