$(document).ready(function(){$(".game-link").on("click",function(e){return ga("Game","select",$(this).data("id")+": "+$(this).data("name")),!0});var e=document.location.toString();$("#embed-link").val('<iframe height="440" width="420" src="'+e+(e.indexOf("?")<0?"?":"&")+'e=1" frameborder="0" allowfullscreen></iframe>'),$("#btn-embed-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-embed",$("#embed-link").val())}catch(n){}$("#container-link-link").hide(),$("#container-embed-link").show(),$("#embed-link").select()}),$("#close-embed-link").on("click",function(e){e.preventDefault(),$("#container-embed-link").hide()});var t=document.location.toString();$("#link-link").val(t+(t.indexOf("?")<0?"?":"&")+"s=1"),$("#btn-link-link").on("click",function(e){try{var t=$.cookie("Woggle-game"),o=t?$.parseJSON(t):{};$.isEmptyObject(t)||ga("send","event",o.id+": "+o.gn,"share-link",$("#link-link").val())}catch(n){}$("#container-embed-link").hide(),$("#container-link-link").show(),$("#link-link").select()}),$("#close-link-link").on("click",function(e){e.preventDefault(),$("#container-link-link").hide()})}),$(document).ready(function(){!function(){function e(e){if(!e)return"";for(var t="",o=0;o<e.length;o++)t+=go[e.charAt(o)]||e.charAt(o);return t}function t(){wo.addToTotal("move",1),wo.addToCount("move",1),wo.setProperty("move-remaining",wo.move.max-wo.move.total),wo.store(),wo.setProperty("hitStreak-current",wo.hitStreak.current+1,!0),bo.hitStreak.current>bo.hitStreak["long"]&&wo.setProperty("hitStreak-long",wo.hitStreak["long"]+1,!0),re()}function o(e){var e=parseInt(e);try{wo.addToCount("point",e)}catch(t){console.log(t),mo.ga("Error","addPoints",t.toString())}re()}function n(){for(var e=!0,t=0;t<wo.thwords.tls.length;t++)s(t)||(e=!1);return e}function s(e,t){t=t||!1;try{for(var o=0;o<wo.thwords.tls[e].length;o++)if(!wo.thwords.tls[e][o].s)return t&&$("#answer-"+e).removeClass("solved").addClass("wrong"),!1}catch(n){console.log(n),mo.ga("Error","allTilesSolved",n.toString())}return $("#answer-"+e).hasClass("solved")||($("#answer-"+e).addClass("solved"),wo.addToCount("thword",1,!0)),$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show"),!0}function a(){window.onbeforeunload=function(){return!$.isEmptyObject(bo)&&"undefined"!=typeof bo.status&&bo.status?"If you leave this page you will lose your current game?":void 0},$(".quit-game").on("click",function(e){e.preventDefault(),ne()}),$(".save-and-exit-game").on("click",function(e){e.preventDefault(),xe()}),$(".select-foreign-thword").on("click",function(e){e.preventDefault(),To(this)}),$(".start-game").on("click",function(e){e.preventDefault(),et(this)&&ze()}),Oe()}function r(){$(".close-ad").on("click",function(e){e.preventDefault(),B(),1==parseInt(mo.getProperty("showAds"))&&H()}),$("#btn-topic-feedback-cancel").on("click",function(e){e.preventDefault(),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}),$("#btn-topic-feedback-submit-comment").on("click",function(e){e.preventDefault();try{wo.ga(wo.id+": "+wo.name,"topic-comment",wo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-comment").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-feedback-submit-problem").on("click",function(e){e.preventDefault();try{wo.ga(wo.id+": "+wo.name,"topic-problem",wo.topic.id+": "+$("#topic-feedback-text").val()),$("#btn-topic-problem").addClass("disabled"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("show").addClass("hide")}catch(t){}}),$("#btn-topic-dislike").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?W("You already said you liked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?W("You already said you dislike this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof wo.topic.id&&wo.topic.id>0&&(wo.ga(wo.id+": "+wo.name,"topic-dislike",wo.topic.id+": "+wo.topic.name),W("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-like").addClass("disabled"))}catch(t){}}),$("#btn-topic-like").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?W("You already said you disliked this topic.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?W("You already said you like this topic.",{type:"fail",timeout:2e3}):("undefined"!=typeof wo.topic.id&&wo.topic.id>0&&(wo.ga(wo.id+": "+wo.name,"topic-like",wo.topic.id+": "+wo.topic.name),W("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-dislike").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-easy").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?(W("You already said this topic was too hard.",{type:"fail",timeout:2e3}),alert("You already said this topic was too hard.")):$(this).hasClass("clicked")?W("You already said this topic was too easy.",{type:"fail",timeout:2e3}):("undefined"!=typeof wo.topic.id&&wo.topic.id>0&&(wo.ga(wo.id+": "+wo.name,"topic-too-easy",wo.topic.id+": "+wo.topic.name),W("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-hard").addClass("disabled"))}catch(t){}}),$("#btn-topic-too-hard").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?W("You already said this topic was too easy.",{type:"fail",timeout:2e3}):$(this).hasClass("clicked")?W("You already said this topic was too hard.",{type:"fail",timeout:2e3}):("undefined"!=typeof wo.topic.id&&wo.topic.id>0&&(wo.ga(wo.id+": "+wo.name,"topic-too-hard",wo.topic.id+": "+wo.topic.name),W("Thank you for your feedback.",{type:"success",timeout:2e3})),$(this).addClass("clicked"),$("#btn-topic-too-easy").addClass("disabled"))}catch(t){}}),$("#btn-topic-comment").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?W("You have already submitted a comment on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("hide").addClass("show"),$("#topic-feedback-instr-problem").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-comment").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-problem").removeClass("show").addClass("hide"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#btn-topic-problem").on("click",function(e){e.preventDefault();try{$(this).hasClass("disabled")?W("You have already reported a problem on this topic.",{type:"fail",timeout:2e3}):($("#topic-feedback-text").val(""),$("#topic-feedback-instr-comment").removeClass("show").addClass("hide"),$("#topic-feedback-instr-problem").removeClass("hide").addClass("show"),$("#btn-topic-feedback-submit-comment").removeClass("show").addClass("hide"),$("#btn-topic-feedback-submit-problem").removeClass("hide").addClass("show"),$("#overlay-topic-feedback-container").removeClass("hide").addClass("show"),$("#overlay-background").removeClass("hide").addClass("show"),$("#topic-feedback-text").select())}catch(t){}}),$("#hamburger").on("click",function(e){e.preventDefault(),R()}),$("#menuContentLayer").on("click",function(e){e.preventDefault(),p()}),$(".overlay-continue-btn").on("click",function(e){e.preventDefault(),te()}),$(".play-topic-again").on("click",function(e){e.preventDefault(),K()}),$(".process-char").on("click",function(e){e.preventDefault(),$(this).data("idx")&&Z($(this).data("idx"))}),$(".show-about-overlay").on("click",function(e){e.preventDefault(),Se()}),$(".show-bonus").on("click",function(e){e.preventDefault(),z()}),$(".show-debug-data-overlay").on("click",function(e){e.preventDefault(),_e()}),$(".show-game-stats-overlay").on("click",function(e){e.preventDefault(),Fe()}),$(".show-general-feedback-overlay").on("click",function(e){e.preventDefault(),Ne()}),$(".show-help-overlay").on("click",function(e){e.preventDefault(),Qe()}),$(".show-high-scores-overlay").on("click",function(e){e.preventDefault();var t={};"undefined"==typeof wo||$.isEmptyObject(wo)||(t.gameId=wo.getProperty("id"),t.lang=wo.getProperty("lang"),t.skillLevel=wo.getProperty("skillLevel"),t.knowledgeLevel=wo.getProperty("knowledgeLevel"),t.categoryId=wo.getProperty("category_id")),Me(t)}),$(".show-round-stats-overlay").on("click",function(e){e.preventDefault(),He()}),$(".show-settings-overlay").on("click",function(e){e.preventDefault(),Be()}),$(".show-tile-values-overlay").on("click",function(e){e.preventDefault(),Ye()}),$(".visit-thwords-com").on("click",function(e){e.preventDefault(),window.open("http://thwords.com"),p()})}function l(){return"undefined"==typeof wo.bonusQuestions||"undefined"==typeof wo.bonusQuestions.questions?0:wo.bonusQuestions.questions.length}function c(){n()?it():wo.move.total>=wo.move.max&&Y()}function d(){var e=new Date;e.setTime(e.getTime()-288e5),$.cookie("Woggle-play",null,{path:"/",expires:e}),$.cookie("Woggle-round",null,{path:"/",expires:e}),$.cookie("Woggle-game",null,{path:"/",expires:e})}function u(){$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),$("#overlay-div-container").removeClass().addClass("standard").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",ft.overlayBackgroundOpacity)}function p(){$("#container").unbind("touchmove"),$("#container").animate({marginLeft:["-1","easeOutExpo"]},{duration:700,complete:function(){$("#content").css("width","auto"),$("#menuContentLayer").css("display","none"),$("nav").css("opacity",0),$("#content").css("min-height","auto"),$("nav").css("display","none")}})}function h(){W("Loading Categories ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+mo.getApiDomain()+ro.replace(/\/$/,"")+"/category/get?callback=?&rn=1&mx=3&gi="+wo.id+"&al="+wo.lang+"&sl="+wo.adjustedSkillLevel()+"&kl="+wo.adjustedKnowledgeLevel();mo.ga("API",mo.getApiDomain(),e),wo.ga(wo.id+": "+wo.name,"fetch-categories","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=ue(e);$("#game-panel-choose").html(t),$(".select-category").bind("click",function(e){e.preventDefault(),Co(this)}),qe("choose",!0),bo.status>0&&qe("score",!1),ee()},error:function(t){console.log("Get Error 1000: url: "+e),mo.ga("Error","createCategorySelectList","url: "+e),confirm("Could not fetch categories. Try again?")&&(mo.nextApiDomain(),h())}})}function g(){W("Loading Lessons ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+mo.getApiDomain()+ro.replace(/\/$/,"")+"/lesson/get?callback=?&rn=1&mx=3&gi="+wo.id+"&al="+wo.lang+"&sl="+wo.adjustedSkillLevel()+"&kl="+wo.adjustedKnowledgeLevel();mo.ga("API",mo.getApiDomain(),e),wo.ga(wo.id+": "+wo.name,"fetch-lessons","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){console.log(e);var t=pe(e);$("#game-panel-choose").html(t),$(".select-subject").bind("click",function(e){e.preventDefault(),xo(this)}),qe("choose",!0),bo.status>0&&qe("score",!1),ee()},error:function(t){console.log("Get Error 1001: url: "+e),mo.ga("Error","createLessonSelectList","url: "+e),confirm("Could not fetch lessons. Try again?")&&(mo.nextApiDomain(),g())}})}function f(){W("Loading Subjects ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+mo.getApiDomain()+ro.replace(/\/$/,"")+"/subject/get?callback=?rn=1&mx=3&gi="+wo.id+"&al="+wo.lang+"&sl="+wo.adjustedSkillLevel()+"&kl="+wo.adjustedKnowledgeLevel()+"&ci="+(0===wo.category.choose?0:wo.category.id);mo.ga("API",mo.getApiDomain(),e),wo.ga(wo.id+": "+wo.name,"fetch-subjects","url: "+e),e+="?"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&wo.category.choose>0)wo.ga("Warning","no-subjects-found-for-category","url: "+e),alert("No subjects found.\n\nPlease select another category."),h();else if($.isEmptyObject(t))confirm("No subjects found.\n\nTry again?")&&(mo.nextApiDomain(),f());else{var o=he(t);$("#game-panel-choose").html(o),$(".select-subject").bind("click",function(e){e.preventDefault(),jo(this)}),qe("choose",!0),bo.status>0&&qe("score",!1),ee()}},error:function(t){console.log("Get Error 1002: url: "+e),mo.ga("Error","createSubjectSelectList","url: "+e),confirm("Could not fetch subjects. Try again?")&&(mo.nextApiDomain(),f())}})}function m(){W("Loading Topics ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var e="http://"+mo.getApiDomain()+ro.replace(/\/$/,"")+"/topic/get?callback=?&rn=1&mx=3&gi="+wo.id+"&al="+wo.lang+"&sl="+wo.adjustedSkillLevel()+"&kl="+wo.adjustedKnowledgeLevel()+"&ci="+(0===wo.category.choose?0:wo.category.id)+"&ui="+(0===wo.subject.choose?0:wo.subject.id);mo.ga("API",mo.getApiDomain(),e),wo.ga(wo.id+": "+wo.name,"fetch-topics","url: "+e),e+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:e,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if(console.log(t),$.isEmptyObject(t)&&wo.subject.choose>0)wo.ga("Warning","no-topic-found-for-subject","url: "+e),alert("No topics found.\n\nPlease select another subject."),f();else if($.isEmptyObject(t)&&wo.subject.choose>0)wo.ga("Warning","no-topic-found-for-category","url: "+e),alert("No topics found.\n\nPlease select another category."),h();else if($.isEmptyObject(t))confirm("No topics found.\n\nTry again?")&&(mo.nextApiDomain(),m());else{var o=ge(t);$("#game-panel-choose").html(o),$(".select-topic").bind("click",function(e){e.preventDefault(),To(this)}),qe("choose",!0),bo.status>0&&qe("score",!1),ee()}},error:function(t){console.log("Get Error 1003: url: "+e),mo.ga("Error","createTopicSelectList","url: "+e),confirm("Could not fetch topics. Try again?")&&(mo.nextApiDomain(),m())}})}function v(e){for(var t=e.slice(0).sort(),o=[],n=0;n<e.length-1;n++)t[n+1]==t[n]&&o.push(t[n]);return o.length>0?!0:!1}function y(e){e=e||{},W("Loading Thwords ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0});var t="http://"+mo.getApiDomain()+ro.replace(/\/$/,"")+"/game-play/get?callback=?&gi="+wo.id+"&sl="+wo.skillLevel+"&kl="+wo.knowledgeLevel+"&ci="+(wo.getProperty("category-choose")<0?wo.getProperty("category-id"):e.category_id||0)+"&ui="+(wo.getProperty("subject-choose")<0?wo.getProperty("subject-id"):e.subject_id||0)+"&ti="+(wo.getProperty("topic-choose")<0?wo.getProperty("topic-id"):e.topic_id||0)+"&li="+(wo.getProperty("lesson-choose")<0?wo.getProperty("lesson-id"):e.lesson_id||0)+"&al="+wo.lang;mo.ga("API",mo.getApiDomain(),t),wo.ga(wo.id+": "+wo.name,"fetch-play","url: "+t),t+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:t,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(e){W("Creating Tiles ...",{type:"loading","class":"loading-msg",clickable:!1,timeout:0}),G(e),ee()},error:function(o){console.log("Get Error 1004: url: "+t),mo.ga("Error","fetchPlay","url: "+t),confirm("Could not fetch Thwords. Try again?")&&(mo.nextApiDomain(),y(e))}})}function b(){for(var e=mo.tileFlipDelay,t=0;t<wo.thwords.tls.length;t++)for(var o=0;o<wo.thwords.tls[t].length;o++)wo.thwords.tls[t][o].f&&(mo.tileFlipDelay?(io.push([t,o]),setTimeout(function(){Pe()},e),e+=mo.tileFlipDelay):w(t,o))}function w(e,t){var n=(wo.thwords.tls[e][t].l||"??",wo.thwords.tls[e][t].v||0);$("#tile-"+e+"-"+t).addClass("solved"),wo.push("tile-flipped",[e,t],!1),Xe(e,t),o(n)}function k(){bo.ga(bo.id+": "+bo.name,"game-over","points: "+bo.point.count+", rounds: "+$o.count+", plays: "+wo.count),bo.setProperty("status",0),bo.setProperty("save-status",0),ie(),De("new-game",!0),U(Mustache.render(xt,{title:"Game Over",details:""})+fe(),{type:"fail"})}function C(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)}),t=new Date;return t.setTime(t.getTime()+63072e6),$.cookie("Thwords-Session",e,{path:"/",expires:t}),e}function x(){return'<iframe height="440" width="420" src="'+q({e:1})+'" frameborder="0" allowfullscreen></iframe>'}function j(e){var t={};return $.each(gt,function(o,n){if(n.id==e)for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])}),t}function T(e){for(var t=0;t<ao.length;t++)if(e==ao[t].value)return ao[t].abbrev;return"?"}function O(e){for(var t=0;t<ao.length;t++)if(e==ao[t].value)return ao[t].name;return"?"}function L(e){return"undefined"!=typeof oo[e]?oo[e]:!1}function P(){var e=[];return $.each(oo,function(t,o){"en"!=t&&(e[e.length]={value:t,name:o})}),e}function S(e){e=e||7;var t=I(e);return j(t)}function I(e){return e=e||7,5==e?eo[Math.floor(Math.random()*eo.length)]:[6,8].indexOf(e)>-1?4:Zt[Math.floor(Math.random()*Zt.length)]}function D(){return 4==wo.getProperty("id")?bo.getProperty("abbrev")+": "+L(wo.getProperty("lang"))+" Thwords":bo.getProperty("abbrev")+": "+wo.getProperty("name")}function _(){return 4==wo.getProperty("id")?bo.getProperty("abbrev")+": "+L(wo.getProperty("lang")):bo.getProperty("abbrev")+": "+wo.getProperty("shortName")}function E(e){return e=e||no,e[Math.floor(Math.random()*e.length)]}function q(e){parms=e||{},"undefined"==typeof bo||$.isEmptyObject(bo)||("undefined"!=typeof bo.lang&&bo.lang.length>0&&(e.al=bo.lang),"undefined"!=typeof bo.skillLevel&&parseInt(bo.skillLevel)>0&&(e.sl=bo.skillLevel),"undefined"!=typeof bo.knowledgeLevel&&parseInt(bo.knowledgeLevel)>0&&(e.kl=bo.knowledgeLevel),"undefined"!=typeof bo.category.choose&&parseInt(bo.category.choose)<0&&parseInt(bo.category.id)>0&&(e.cc=-1,e.ci=bo.category.id),"undefined"!=typeof bo.subject.choose&&parseInt(bo.subject.choose)<0&&parseInt(bo.subject.id)>0&&(e.uc=-1,e.ui=bo.subject.id),"undefined"!=typeof bo.topic.choose&&parseInt(bo.topic.choose)<0&&parseInt(bo.topic.id)>0&&(e.tc=-1,e.ti=bo.topic.id),"undefined"!=typeof bo.lesson.choose&&parseInt(bo.lesson.choose)<0&&parseInt(bo.lesson.id)>0&&(e.lc=-1,e.li=bo.lesson.id),to.indexOf(bo.id)>-1&&"undefined"!=typeof vo.langs&&(e.ap=vo.langs.join("|")));var t=document.location.toString().split(/[?#]/)[0];if(t=t.replace("/next/","/play/"),!$.isEmptyObject(e)){var o="";$.each(e,function(e,t){o+="&"+e+"="+encodeURIComponent(t)}),o.length>0&&(t+=(t.indexOf("?")<0?"?":"&")+o.substr(1))}return t}function N(e){for(var t=0;t<so.length;t++)if(e==so[t].value)return so[t].abbrev;return"?"}function Q(e){for(var t=0;t<so.length;t++)if(e==so[t].value)return so[t].name;return"?"}function M(e){for(var t=window.location.search.substring(1),o=t.split("&"),n=0;n<o.length;n++){var s=o[n].split("=");if(s[0]==e)return decodeURIComponent(s[1])}return null}function A(e){e=e||!1;for(var t=window.location.search.substring(1),o=t.split("&"),n=[],s={},a=0;a<o.length;a++){var i=o[a].split("=");if("undefined"!=typeof i[0]&&i[0].length>0){if("ap"==i[0])var r=decodeURIComponent(i[1]).split("|");else var r=decodeURIComponent(i[1]);n[n.length]={name:i[0],value:r},s[i[0]]=r}}return e?s:n}function B(){$("#overlay-ad").removeClass("show").addClass("hide")}function F(e){$("#game-panel-"+e).removeClass("show").addClass("hide")}function H(){var e="/ad";$.ajax({type:"GET",url:e,async:!1,contentType:"text/html",data:{},success:function(e){$("#ad-content").html(e);try{$("#ad-overlay-iframe").length?$("#ad-overlay-iframe").attr("src").length?mo.ga("Ad","load",$("#ad-overlay-iframe").attr("src")):mo.ga("Ad","load-error","No ad-overlay-iframe src attribute found."):mo.ga("Ad","load-error","No ad-overlay-iframe found.")}catch(t){}},error:function(t){try{mo.ga("Error","load-ad","url: "+e)}catch(t){}console.log("Load Ad Error:")}})}function G(e){if(!$.isEmptyObject(e)){try{"undefined"!=typeof e.ti&&parseInt(e.ti)>0&&wo.ga(wo.id+": "+wo.name,"load-topic",e.ti+": "+("undefined"!=typeof e.tn?e.tn:"")),"undefined"!=typeof e.ui&&parseInt(e.ui)>0&&wo.ga(wo.id+": "+wo.name,"load-subject",e.ui+": "+("undefined"!=typeof e.un?e.un:"")),"undefined"!=typeof e.ci&&parseInt(e.ci)>0&&wo.ga(wo.id+": "+wo.name,"load-category",e.ci+": "+("undefined"!=typeof e.cn?e.cn:"")),"undefined"!=typeof e.li&&parseInt(e.li)>0&&wo.ga(wo.id+": "+wo.name,"load-lesson",e.li+": "+("undefined"!=typeof e.ln?e.ln:""))}catch(t){try{wo.ga(wo.id+": "+wo.name,"loadPlay",t.toString()+", data: "+JSON.stringify(e))}catch(t){}}"undefined"!=typeof e.tz&&!$.isEmptyObject(e.tz),"undefined"!=typeof e.qz&&!$.isEmptyObject(e.qz),"undefined"!=typeof e.su&&!$.isEmptyObject(e.su);var o={category:{id:wo.category.id,count:wo.category.count},lesson:{id:wo.lesson.id,count:wo.lesson.count},subject:{id:wo.subject.id,count:wo.subject.count},topic:{id:wo.topic.id,count:wo.topic.count}};for(var n in e)if(e.hasOwnProperty(n))switch(n){case"pt":wo.setProperty("point-total",0,!1,!1),wo.addToTotal("point",e[n],!0,!1);break;case"zt":wo.setProperty("thword-total",0,!1,!1),wo.addToTotal("thword",e[n],!0,!1);break;default:wo.setProperty(n,e[n],!1,!1)}o.category.id>0&&wo.category.id==o.category.id?wo.addToCount("category",1):(wo.setProperty("category-count",1),wo.category.played.indexOf(wo.category.id)<0&&wo.push("category-played",wo.category.id)),o.lesson.id>0&&wo.lesson.id==o.lesson.id?wo.addToCount("lesson",1):(wo.setProperty("lesson-count",1),wo.lesson.played.indexOf(wo.lesson.id)<0&&wo.push("lesson-played",wo.lesson.id)),o.subject.id>0&&wo.subject.id==o.subject.id?wo.addToCount("subject",1):(wo.setProperty("subject-count",1),wo.subject.played.indexOf(wo.subject.id)<0&&wo.push("subject-played",wo.subject.id)),o.topic.id>0&&wo.topic.id==o.topic.id?wo.addToCount("topic",1):(wo.setProperty("topic-count",1),wo.topic.played.indexOf(wo.topic.id)<0&&wo.push("topic-played",wo.topic.id)),bo.store(),$o.store(),wo.store()}qe("topic",!0),qe("score"),$.isEmptyObject(wo.thwords)?$.isEmptyObject(wo.quiz)?alert("No Thwords or quizzes found."):alert("QUIZ - these have not been implemented yet."):(wo.adjustedBonusOn()&&($.isEmptyObject(wo.bonusQuestions)||"undefined"==typeof wo.bonusQuestions.q||0===wo.bonusQuestions.q.length)&&wo.generateBonusQuestions(),Te(),qe("chars"),je(),qe("answers"),b()),bo.store(),$o.store(),wo.store()}function Y(){wo.ga(wo.id+": "+wo.name,"play-lose","topic "+wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-play-lose","topic "+wo.topic.id+": "+wo.topic.name),$(".thw-rack").not(".solved-thword").addClass("wrong-thword"),ae();for(var e=0;e<wo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");if(F("chars"),wo.bonus.on>0&&l()>0&&wo.save.status<0){if(wo.setProperty("status",0),wo.setProperty("save-status",1,!0),wo.addToTotal("save",1,!0),l()>1){$("#btn-show-bonus").html("BONUS QUESTIONS");var t="Game Over",o="However, you can continue your game if you answer all of the following bonus questions correctly."}else{$("#btn-show-bonus").html("BONUS QUESTION");var t="Game Over",o="However, you can continue your game if you answer the following bonus question correctly."}var n=Mustache.render(xt,{title:t,details:o});U(n,{type:"fail",position:"top"}),De("show-bonus",!0)}else qe("feedback",!1),Ce();qe("start")}function J(e,t){t=t||!1;var o=wo.thwords.chs[e].m.length;if(!t)for(var n=0;n<wo.thwords.chs[e].m.length;n++){var s=wo.thwords.chs[e].m[n][0],a=wo.thwords.chs[e].m[n][1];wo.thwords.tls[s][a].f&&o--}return o}function z(){wo.addToTotal("bonus",1,!0);var e=V();if(e){switch(e.type){case"mc":case"tf":case"yn":var t=Mustache.render(It,e);break;case"tx":var o=e.answer.indexOf(" ");if(0>o)e.prefix="";else{var n=e.answer.slice(0,o+1);wo.thwords.cs.p.indexOf(n)>-1&&wo.adjustedSkillLevel()<3?(e.prefix=n,e.answer=e.answer.slice(o+1)):e.prefix=""}var t=Mustache.render(Dt,e);break;default:alert("Invalid question type")}$("#game-panel-bonus").html(t),$.each($(".question-answer"),function(){$(this).removeClass("hide").addClass("show")}),$(".question-answer").bind("click",function(e){$(this).hasClass("done")||(e.preventDefault(),ko(this))}),$("#submit-question-answer").on("click",function(e){e.preventDefault(),Ke(this)}),$("#question-response").on("keypress",function(e){13==e.which&&(e.preventDefault(),Ke($("#submit-question-answer")))}),$(".next-question").on("click",function(e){e.preventDefault(),z()}),"tx"==e.type&&$("#question-response").focus(),qe("score",!0),qe("bonus",!1)}else Re()}function R(){$("nav").css("display","block"),$("#content").css("min-height",$(window).height()),$("nav").css("opacity",1);var e=$("#content").width();$("#content").css("width",e),$("#menuContentLayer").css("display","block"),$("#container").bind("touchmove",function(e){e.preventDefault()}),$("#container").animate({marginLeft:["30%","easeOutExpo"]},{duration:700})}function W(e,t){$("#overlay-btn-container").hasClass("show")&&ee(),t=t||{};var o=t.type||"standard",n=t["class"]||"",s=t.data||{},a=t.clickable||!0,i="undefined"!=typeof t.timeout?t.timeout:mo.overlayButtonDelay,r="undefined"!=typeof t.opacity?t.opacity:ft.overlayBackgroundOpacity,l=document.createElement("button");$(l).attr("id","overlay-btn"),$(l).addClass("btn").addClass("thw-btn").addClass("overlay-btn").addClass(o).addClass("show"),n&&$(l).addClass(n),$(l).html(e),$.each(s,function(e,t){$(l).attr("data-"+e,t)}),a&&$(l).on("click",function(e){ee()}),r!==!1&&($("#overlay-background").css("opacity",r),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-btn-container").html("").append(l).removeClass("hide").addClass("show"),i&&(Xt=setTimeout(function(){ee()},i))}function U(e,t){t=t||{},mo=mo||{},ft=ft||{};var o=t.type||"standard",n="undefined"!=typeof t.timeout?t.timeout:mo.overlayDivDelay||0,s=t["class"]||"",a=t.data||{},i=t.label||"Continue",r=t.position||"bottom",l=t.bindAction||!1,c=t.hideNav||!1,d="undefined"!=typeof t.opacity?t.opacity:ft.overlayBackgroundOpacity||.5;if(c&&$("#overlay-div-nav").addClass("hide"),$("#overlay-div-content-top").html(""),$("#overlay-div-content").html(""),"top"==r?$("#overlay-div-content-top").html(e):$("#overlay-div-content").html(e),$("#overlay-continue-btn").text(i),$("#overlay-continue-btn").removeClass().addClass("btn").addClass("thw-btn").addClass("overlay-continue-btn").addClass("show"),s&&$("#overlay-continue-btn").addClass(s),$.each(a,function(e,t){$("#overlay-continue-btn").attr("data-"+e,t)}),d!==!1&&($("#overlay-background").css("opacity",d),$("#overlay-background").removeClass("hide").addClass("show")),$("#overlay-div-container").removeClass().addClass(o).addClass("show"),s&&$("#overlay-div-container").addClass(s),l)switch(l){}n&&(Vt=setTimeout(function(){te()},n))}function K(){wo.ga(wo.id+": "+wo.name,"topic-repeat","topic "+wo.topic.id+": "+wo.topic.name),wo.setProperties({status:1,save_status:0}),wo.setProperty("count",wo.count+1),$(".strike-xs").html(""),y({topic_id:wo.topic.id})}function V(){try{if(l()<0)return!1;if("undefined"!=typeof wo.bonusQuestions||"undefined"!=typeof wo.bonusQuestions.questions){if("undefined"==typeof wo.bonusQuestions.idx)return wo.bonusQuestions.idx=99999,!1;if("undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx]&&wo.bonusQuestions.idx<=wo.bonus.total){var e={idx:wo.bonusQuestions.idx,title:wo.bonusQuestions.title?wo.bonusQuestions.title:wo.bonusQuestions.questions.length>0?"Bonus Questions":"Bonus Question",instructions:wo.bonusQuestions.label?wo.bonusQuestions.label:"Select the answer that best matches."};if(e.type="undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx].t?wo.bonusQuestions.questions[wo.bonusQuestions.idx].t:!1,e.question="undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx].q?wo.bonusQuestions.questions[wo.bonusQuestions.idx].q:"",e.answer="undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx].a?wo.bonusQuestions.questions[wo.bonusQuestions.idx].a:"",e.points="undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx].p?wo.bonusQuestions.questions[wo.bonusQuestions.idx].p:1,e.options=[],"undefined"!=typeof wo.bonusQuestions.questions[wo.bonusQuestions.idx].o)for(var t=0;t<wo.bonusQuestions.questions[wo.bonusQuestions.idx].o.length;t++)e.options[e.options.length]={text:wo.bonusQuestions.questions[wo.bonusQuestions.idx].o[t],option:t};return wo.bonusQuestions.idx=wo.bonusQuestions.idx+1,e}return wo.bonus.idx=99999,!1}return!1}catch(o){return console.log(o),mo.ga("Error","popNextBonusQuestion",o.toString()),!1}}function X(e){if("undefined"==typeof e.idx||"undefined"==typeof e.option||"undefined"==typeof e.correct)return wo.ga("Error","bonus-processing-problem",JSON.stringify(e)),alert("Can't process bonus."),!1;switch(idx=e.idx||0,option=e.option||0,correct=e.correct||0,wo.bonusQuestions.questions[idx].t){case"tx":break;case"mc":case"tf":case"yn":default:var t=option==correct?!0:!1;t?$("#question-answer-"+idx+"-"+correct).addClass("correct"):($("#question-answer-"+idx+"-"+option).addClass("wrong"),$("#question-answer-"+idx+"-"+correct).addClass("correct"))}if($.each($(".question-answer"),function(){$(this).addClass("done")}),$("#question-title").addClass("hide"),$("#question-instructions").addClass("hide"),wo.bonusQuestions.idx<wo.bonusQuestions.questions.length)De("next-question",!0);else if($("#btn-next-question").removeClass("show").addClass("hide"),wo.bonus.count==wo.bonus.total){if(wo.ga(wo.id+": "+wo.name,"bonus-win","topic "+wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-bonus-win","topic "+wo.topic.id+": "+wo.topic.name),wo.save.status>0){wo.ga(wo.id+": "+wo.name,"save-win","topic "+wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-save-win","topic "+wo.topic.id+": "+wo.topic.name),wo.addToCount("save",1,!0),wo.setProperty("save-status",-1,!0);var o=Mustache.render(jt,{});U(o,{msgType:"success","class":"show-start-panel",timeout:0,position:"top"})}De("next-round",!0),Ae()}else wo.ga(wo.id+": "+wo.name,"bonus-lose","topic "+wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-bonus-lose","topic "+wo.topic.id+": "+wo.topic.name),wo.save.status>0?(wo.ga(wo.id+": "+wo.name,"save-lose","topic "+wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-save-lose","topic "+wo.topic.id+": "+wo.topic.name),wo.setProperty("save-status",0,!0),Ce()):(De("next-round",!0),Ae());qe("start"),qe("feedback",!1)}function Z(e){if("undefined"==typeof e)return!1;ut=!0,wo.push("char-played",e,!1);var n=mo.tileFlipDelay;if(J(e)>0){t();for(var s=0;s<wo.thwords.chs[e].m.length;s++)mo.tileFlipDelay?(io.push([wo.thwords.chs[e].m[s][0],wo.thwords.chs[e].m[s][1]]),setTimeout(function(){Pe()},n),n+=mo.tileFlipDelay):w(wo.thwords.chs[e].m[s][0],wo.thwords.chs[e].m[s][1])}else{Ue();var a=wo.thwords.chs[e].v-11;o(a)}0==io.length&&wo.status>0&&c(),ut=!1}function ee(){clearTimeout(Xt),$("#overlay-btn-container").removeClass("show").addClass("hide"),$("#overlay-background").removeClass("show").addClass("hide"),$("#overlay-background").css("opacity",ft.overlayBackgroundOpacity);var e=$("#overlay-btn");$(e).hasClass("process-char")&&"undefined"!=typeof $(e).attr("data-idx")?Z($(e).data("idx")):$(e).hasClass("process-bonus")&&"undefined"!=typeof $(e).attr("data-correct")&&X({idx:$(e).data("idx"),option:$(e).data("option"),correct:$(e).data("correct")})}function te(){clearTimeout(Vt),$("#overlay-background").removeClass("show").addClass("hide"),
    $("#overlay-div-container").removeClass("show").addClass("hide"),$("#overlay-div-nav").removeClass("hide"),$("#overlay-continue-btn").hasClass("process-char")&&"undefined"!=typeof $("#overlay-continue").attr("data-idx")?Z($("#overlay-continue-btn").data("idx")):$("#overlay-continue-btn").hasClass("next-round")?Re():$("#overlay-continue-btn").hasClass("show-start-panel")&&qe("start"),u()}function oe(){var e=A();if(e.length>0){mo.validationOff(),bo.validationOff(),$o.validationOff(),wo.validationOff();for(var t=0;t<e.length;t++)mo.setProperty(e[t].name,e[t].value,!0),wo.setProperty(e[t].name,e[t].value,!0);mo.validationOn(),bo.validationOn(),$o.validationOn(),wo.validationOn()}}function ne(){p(),confirm("If you quit you will lose your current game.\n\nIf you want to keep your game use the Save and Exit option. \n\nAre you sure you want to quit?")&&(wo.ga(wo.id+": "+wo.name,"game-quit","points: "+bo.point.total+", rounds: "+$o.count+", plays: "+wo.count),ie(),wo.setProperty("status",0,!0),wo.setProperty("save-status",0,!0),d(),document.location.href="/play")}function se(e,t){var o=wo.thwords.tls[e][t].l||"??";wo.thwords.tls[e][t].v||0;$("#tile-"+e+"-"+t).first().html(o)}function ae(){for(var e=(mo.tileFlipDelay,0);e<wo.thwords.tls.length;e++){for(var t=0;t<wo.thwords.tls[e].length;t++)0==wo.thwords.tls[e][t].s&&se(e,t);s(e,!0)}}function ie(){try{var e={gi:bo.id,gg:bo.slug,gr:bo.random,sa:bo.status,cc:bo.category.choose,ci:bo.category.choose<0?bo.category.id:0,uc:bo.subject.choose,ui:bo.subject.choose<0?bo.subject.id:0,tc:bo.topic.choose,ti:bo.lesson.choose<0?bo.topic.id:0,lc:bo.lesson.choose,li:bo.lesson.choose<0?bo.lesson.id:0,pb:bo.bonus.on,rd:wo.count,al:bo.lang,sl:bo.skillLevel,kl:bo.knowledgeLevel,zt:bo.thword.total,zc:bo.thword.count,zp:bo.thword.percent,mm:bo.move.max,mt:bo.move.total,mc:bo.move.count,mp:bo.move.percent,pt:bo.point.total,pc:bo.point.count,pp:bo.point.percent,bt:bo.bonus.total,bc:bo.bonus.count,bp:bo.bonus.percent,ps:bo.save.on,st:bo.save.total,sc:bo.save.count,sp:bo.save.percent,hc:bo.hitStreak.current,hl:bo.hitStreak["long"],uid:vo.id,uun:vo.username,una:vo.name,uem:vo.email,sid:vo.sessionId,gid:yo.id,gna:yo.name};try{wo.ga(wo.id+": "+wo.name,"record-stats","data: "+JSON.stringify(e))}catch(t){}statsDomain=mo.getStatsDomain();var o="http://"+statsDomain+ro.replace(/\/$/,"")+"/results/save?callback=?";mo.ga("API",statsDomain,o),$.ajax({type:"POST",url:o,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",data:e,success:function(e){console.log("Game successfully recorded.")},error:function(t){try{wo.ga("Error","record-stats","data: "+JSON.stringify(e))}catch(t){}console.log("Record Stats Error:")}})}catch(t){console.log(t),mo.ga("Error","recordFinalStats",t.toString())}}function re(){bo.point.count<0?$(".game-point-count").each(function(){$(this).addClass("negative")}):$(".game-point-count").each(function(){$(this).removeClass("negative")}),$("#moves-left").removeClass("txt-fail").removeClass("txt-danger"),parseInt(wo.move.remaining)<2?$("#moves-left").addClass("txt-fail"):parseInt(wo.move.remaining)<3&&$("#moves-left").addClass("txt-danger"),$(".round-moves-left-text").text(1==parseInt(wo.move.remaining)?"move left":"moves left");var e="";for(i=0;i<wo.move.strikes;i++)e+="X";$(".strike-xs").html(e)}function le(){var e={version:pt,copyright:ht};return Mustache.render(mt,e)}function ce(){if($.isEmptyObject(wo)||$.isEmptyObject(wo.thwords)||"undefined"==typeof wo.thwords.ans)alert("Thword answers not found.");else for(var e={answers:[]},t=0;t<wo.thwords.ans.length;t++)e.answers[e.answers.length]={idx:t,answer:wo.thwords.ans[t],aux1:wo.thwords.aux1[t],aux2:wo.thwords.aux2[t],tileRack:$e(t)};return Mustache.render(vt,e)}function de(){var e={chars:[]};return $.isEmptyObject(wo)||$.isEmptyObject(wo.thwords.chs)||$.each(wo.thwords.chs,function(t,o){e.chars[e.chars.length]={idx:t,label:o.l,"class":1==o.f?" chosen":""},1==o.f&&wo.push("char-played",t,!1)}),Mustache.render(yt,e)}function ue(e){var t=0,o={categories:e,lang:wo.lang,idx:function(){return t++}};return Mustache.render(bt,o)}function pe(e){var t=0,o={lessons:e,lang:wo.lang,idx:function(){return t++}};return Mustache.render($t,o)}function he(e){var t=0,o={subjects:e,lang:wo.lang,idx:function(){return t++}};return Mustache.render(wt,o)}function ge(e){var t=0,o={topics:e,lang:wo.lang,idx:function(){return t++}};return Mustache.render(kt,o)}function fe(){var e={rounds:$o.count,plays:wo.count,thword:{total:bo.thword.total,count:bo.thword.count,percent:0!=bo.thword.total?parseFloat(bo.thword.percent).toFixed(2):""},move:{total:bo.move.total,count:bo.move.count,percent:0!=bo.move.total?parseFloat(bo.move.percent).toFixed(2):"",strikes:bo.move.strikes},point:{total:bo.point.total,count:bo.point.count,percent:0!=bo.point.percent?parseFloat(bo.point.percent).toFixed(2):""},hitStreak:{"long":bo.hitStreak["long"],current:bo.hitStreak.current},bonus:{total:bo.bonus.total,count:bo.bonus.count,percent:0!=bo.bonus.total?parseFloat(bo.bonus.percent).toFixed(2):""},save:{total:bo.save.total,count:bo.save.count,percent:0!=bo.save.total?parseFloat(bo.save.percent).toFixed(2):""}};return Mustache.render(Tt,e)}function me(){return Mustache.render(Ot,{})}function ve(){return Mustache.render(Lt,{})}function ye(){var e={plays:wo.count,thword:{total:wo.thword.total,count:wo.thword.count,percent:0!=wo.thword.total?parseFloat(wo.thword.percent).toFixed(2):""},move:{total:wo.move.total,count:wo.move.count,percent:0!=wo.move.total?parseFloat(wo.move.percent).toFixed(2):"",strikes:wo.move.strikes,remaining:wo.move.remaining},point:{total:wo.point.total,count:wo.point.count,percent:0!=wo.point.total?parseFloat(wo.point.percent).toFixed(2):""},hitStreak:{"long":wo.hitStreak["long"],current:wo.hitStreak.current},bonus:{total:wo.bonus.total,count:wo.bonus.count,percent:0!=wo.bonus.total?parseFloat(wo.bonus.percent).toFixed(2):""},save:{total:wo.save.total,count:wo.save.count,percent:0!=wo.save.total?parseFloat(wo.save.percent).toFixed(2):""}};return Mustache.render(_t,e)}function be(){return Mustache.render(Et,{skillLevelOptions:so,knowledgeLevelOptions:ao,settings:mo,game:bo,user:vo,skillLevel:Q(wo.skillLevel),knowledgeLevel:O(wo.knowledgeLevel),chooseCategory:bo.category.choose>0?"Yes":"No",chooseSubject:bo.subject.choose>0?"Yes":"No",chooseTopic:bo.topic.choose>0?"Yes":"No",chooseLesson:bo.lesson.choose>0?"Yes":"No",bonusOnOptions:bo.bonus.on>0?"Yes":"No"})}function $e(e){for(var t=e%2?"odd-row":"even-row",o={idx:e,"class":t,tiles:[]},n=0;n<wo.thwords.tls[e].length;n++)o.tiles[o.tiles.length]={pos:n,label:wo.thwords.tls[e][n].l};return Mustache.render(Nt,o)}function we(){var e={tiles:[],prematureMsgClass:"hide"};return"undefined"!=typeof wo.thwords.chs?$.each(wo.thwords.chs,function(t,o){var n=o.l;!$.isEmptyObject(wo.thwords.cs.eq[o.l])&&wo.thwords.cs.eq[o.l].length>0&&(n+=" ("+wo.thwords.cs.eq[o.l].join(", ")+")"),e.tiles[e.tiles.length]={label:n,right:o.v,wrong:11-o.v}}):e.prematureMsgClass="show",Mustache.render(Qt,e)}function ke(){$("#btn-topic-like").removeClass("clicked").removeClass("disabled"),$("#btn-topic-dislike").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-easy").removeClass("clicked").removeClass("disabled"),$("#btn-topic-too-hard").removeClass("clicked").removeClass("disabled"),$("#btn-topic-comment").removeClass("clicked").removeClass("disabled"),$("#btn-topic-problem").removeClass("clicked").removeClass("disabled")}function Ce(){bo.ga($o.id+": "+$o.name,"round-over","points: "+$o.point.count+", plays: "+wo.count),$o.setProperty("status",0),$o.setProperty("save-status",0),k()}function xe(){window.onbeforeunload=function(){},p(),wo.ga(wo.id+": "+wo.name,"game-exit","points: "+bo.point.total+", rounds: "+$o.count+", plays: "+wo.count),document.location.href="/play"}function je(){if($.isEmptyObject(wo)||"undefined"==typeof wo.thwords.ans){try{wo.ga(wo.id+": "+wo.name,"thword-answers-not-found","undefined"!=typeof wo.thwords?JSON.stringify(wo.thwords):"url"+document.location.href)}catch(e){}alert("No answers found.")}else{var t=ce();$("#game-panel-answers").html($.parseHTML(t))}}function Te(){var e=de();$("#game-panel-chars").html(e),$(".char").bind("click",function(e){return e.preventDefault(),ut||io.length>0?!1:void Oo(this)})}function Oe(){var e=document.location.toString().split(/[?#]/)[0];switch("/"===e.slice(-1)&&(e=e.substring(0,e.length-1)),$(".next-round-link").attr("href",e.toString().replace("/play/","/next/")+"?"+Math.floor(1e8*Math.random()+1)),parseInt(mo.getProperty("showAds"))){case 1:B(),H(),$(".next-round-link").on("click",function(e){e.preventDefault(),Ie(),We()});break;case 2:$(".next-round-link").on("click",function(e){window.onbeforeunload=function(){}});break;case 0:default:$(".next-round-link").on("click",function(e){e.preventDefault(),We()})}}function Le(){if($o.random){var e=S($o.id);4!=e.id||!$o.random&&"en"!=wo.lang?e.lang="en":e.lang=E(wo.langs.length?wo.langs:no),wo.setProperties(e,!1),$(".game-name").html(D()),$(".game-shortName").html(_())}}function Pe(){var e=io.shift();w(e[0],e[1]),0==io.length&&c()}function Se(){ga("send","event","Global","panel-view","About"),p(),U(le(),{type:"standard"})}function Ie(){try{$("#ad-overlay-iframe").length?$("#ad-overlay-iframe").attr("src").length?mo.ga("Ad","show",$("#ad-overlay-iframe").attr("src")):mo.ga("Ad","show-error","No ad-overlay-iframe src attribute found."):mo.ga("Ad","show-error","No ad-overlay-iframe found.")}catch(e){}$("#overlay-ad").removeClass("hide").addClass("show")}function De(e,t){t&&$(".btn").removeClass("show").addClass("hide"),$("#btn-"+e).removeClass("hide").addClass("show")}function _e(){p(),U($("#debug-data").html(),{type:"standard"})}function Ee(){$(".in-game-only").each(function(){$(this).removeClass("hide").addClass("show")})}function qe(e,t){t=t||!1,t&&$(".game-panel").each(function(){$(this).removeClass("show").addClass("hide")}),$("#game-panel-"+e).removeClass("hide").addClass("show"),rt()&&($("#game-panel-stats").removeClass("hide").addClass("show"),$("#game-panel-debug").removeClass("hide").addClass("show"))}function Ne(){ga("send","event","Global","panel-view","Feedback"),p(),U(me(),{type:"standard",label:"Cancel"}),$("#btn-general-feedback-cancel").on("click",function(e){e.preventDefault(),u()}),$("#btn-general-feedback-submit").on("click",function(e){e.preventDefault(),$("#general-feedback-text").val().length>0&&mo.ga("Feedback",$("#general-feedback-subject").val(),$("#general-feedback-text").val()),u()})}function Qe(){ga("send","event","Global","panel-view","Help"),p(),U(ve(),{type:"standard"})}function Me(e){ga("send","event","Global","panel-view","High Scores"),e=e||{},e.gameId="undefined"!=typeof e.gameId?e.gameId:bo.id,e.lang="undefined"!=typeof e.lang?e.lang:bo.lang?bo.lang:"en",e.knowledgeLevel="undefined"!=typeof e.knowledgeLevel?e.knowledgeLevel:bo.knowledgeLevel,e.skillLevel="undefined"!=typeof e.skillLevel?e.skillLevel:wo.skillLevel,e.categoryId="undefined"!=typeof e.categoryId?e.categoryId:0,e.group="undefined"!=typeof e.group?e.group:yo.id,p(),U(Mustache.render(St,{}),{type:"standard"});var t="";e.gameId&&(t+="&gi="+e.gameId),e.knowledgeLevel&&(t+="&kl="+e.knowledgeLevel),e.skillLevel&&(t+="&sl="+e.skillLevel),e.lang&&(t+="&al="+e.lang),"undefined"!=typeof e.categoryId&&(t+="&ci="+e.categoryId),e.group&&(t+="&grp="+e.group),t.replace(/^&/,"");var o=mo.getStatsDomain(),n="http://"+o+ro.replace(/\/$/,"")+"/high-scores/get?callback=?"+t;mo.ga("API",o,n),wo.ga(wo.id+": "+wo.name,"high-scores-get","url: "+n),n+="&"+Math.floor(1e8*Math.random()+1),$.ajax({type:"GET",url:n,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(t){if($.isEmptyObject(t))var o="<h2>No scores found.</h2>";else{var n=[];$.each(t,function(e,t){t.tp=t.tp?parseFloat(t.tp).toFixed(2):"",t.mp=t.mp?parseFloat(t.mp).toFixed(2):"",t.pp=t.pp?parseFloat(t.pp).toFixed(2):"",t.bp=t.bp?parseFloat(t.bp).toFixed(2):null,t.sp=t.sp?parseFloat(t.sp).toFixed(2):null,t.sla=N(t.sl),t.kla=T(t.kl),t.tca=t.tc>0?"Y":"N",t.pba=t.pb>0?"Y":"N",n[n.length]=t})}var o=Mustache.render(Pt,{scores:n});U(o,{type:"standard"}),$("#high-score-game").val(e.gameId+"-"+e.lang+"-"+e.categoryId),$("#high-score-skill-level").val(e.skillLevel),$("#high-score-game").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};Me(o)}),$("#high-score-skill-level").on("change",function(e){var t=$("#high-score-game").val().split("-"),o={gameId:parseInt(t[0]),lang:t[1],skillLevel:parseInt($("#high-score-skill-level").val()),categoryId:t[2]};Me(o)})},error:function(e){console.log("Get Error 1005: url: "+n),mo.ga("Error","fetchHighScores","url: "+n),U("<p>There was a problem retrieving the high scores.</p><p>Try again later</p>",{type:"standard"})}})}function Ae(){wo.topic.choose&&wo.topic.count<wo.topic.max&&De("play-topic-again")}function Be(){ga("send","event","Global","panel-view","Settings"),p(),U(be(),{hideNav:!0,type:"standard"}),$("#save-settings").on("click",function(e){try{wo.ga("Settings","save",""),vo.name=$("#settings-user-name").val(),vo.store()}catch(t){}te()}),$("#cancel-settings").on("click",function(e){te()})}function Fe(){ga("send","event","Global","panel-view","Game Stats"),p(),U(fe(),{type:"standard"})}function He(){ga("send","event","Global","panel-view","Round Stats"),p(),U(ye(),{type:"standard"})}function Ge(){var e=Mustache.render(qt,{user:vo,skillLevelOptions:so,knowledgeLevelOptions:ao,chooseCategoryOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseSubjectOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseTopicOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],chooseLessonOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],bonusOnOptions:[{value:1,name:"Yes"},{value:0,name:"No"}],langOptions:P()});if($("#start-game-settings").html(e),to.indexOf(bo.id)<0)$("#start-settings-langs").remove();else if("undefined"!==vo.langs&&vo.langs.constructor===Array)for(var t=0;t<vo.langs.length;t++)$("#start-langs option[value="+vo.langs[t]+"]").attr("selected",!0);if($("#start-skill-level").val(bo.skillLevel),$("#start-knowledge-level").val(bo.knowledgeLevel),$("#start-settings-knowledge-level").remove(),bo.category.choose<=0&&$("#start-settings-category").remove(),$("#start-settings-category").remove(),bo.subject.choose<=0&&$("#start-settings-subject").remove(),$("#start-settings-subject").remove(),bo.topic.choose<=0&&$("#start-settings-topic").remove(),$("#start-settings-topic").remove(),bo.lesson.choose<=0&&$("#start-settings-lesson").remove(),$("#start-settings-lesson").remove(),bo.bonus.on>0?$("#start-bonus-on").val(bo.bonus.on):$("#start-settings-bonus-on").remove(),$("#start-settings-bonus-on").remove(),!$.isEmptyObject(Bt)&&"undefined"!=typeof Bt.s&&parseInt(Bt.s)>0){if("undefined"!=typeof Bt.la){var o=!1;$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&($(this).data("lang")==bo.lang?($(this).removeClass("hide").addClass("show"),o=!0):$(this).removeClass("show").addClass("hide"))}),o?$.each($(".lang-explanation-text"),function(){$(this).removeClass("show").addClass("hide")}):$.each($(".lang-btn"),function(){"undefined"!==$(this).data("lang")&&$(this).removeClass("hide").addClass("show")})}if("undefined"!=typeof Bt.ap&&Bt.ap.length>0){for(var n=[],t=0;t<Bt.ap.length;t++){var s=L(Bt.ap[t]);s!==!1&&(n[n.length]=L(Bt.ap[t]))}n.length>1&&$("#start-settings-langs").html('<p class="label">Languages</p><p style="margin-bottom: 16px;">'+n.join(", ")+"</p>")}"undefined"!=typeof Bt.gs&&$("#start-settings-skillLevel").html('<p class="label">Skill Level: '+Q(bo.skillLevel)+"</p>"),"undefined"!=typeof Bt.gk&&$("#start-settings-knowledgeLevel").html('<p class="label">Knowledge Level: '+O(bo.knowledgeLevel)+"</p>"),"undefined"!=typeof Bt.cc&&$("#start-settings-category").html('<p class="label">Category: '+(bo.category.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Bt.uc&&$("#start-settings-subject").html('<p class="label">Subject: '+(bo.subject.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Bt.tc&&$("#start-settings-topic").html('<p class="label">Topic: '+(bo.topic.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Bt.lc&&$("#start-settings-lesson").html('<p class="label">Lesson: '+(bo.lesson.choose>0?"Yes":"No")+"</p>"),"undefined"!=typeof Bt.pb&&$("#start-settings-bonus-on").html('<p class="label">Bonus Questions: '+(bo.bonus.om>0?"Yes":"No")+"</p>")}}function Ye(){try{wo.ga(wo.id+": "+wo.name,"panel-view","Tile Values")}catch(e){}p(),U(we(),{type:"standard"})}function Je(e){for(var t,o,n=e.length;n;t=Math.floor(Math.random()*n),o=e[--n],e[n]=e[t],e[t]=o);return e}function ze(){bo.ga(bo.id+": "+bo.name,"game-start","user: "+vo.name),wo.setProperties({status:0,save_status:0}),bo.setProperties({status:1},!1),bo.setProperty("count",bo.count+1),bo.ga(bo.id+": "+bo.name,"game-count",bo.count),bo.ga(bo.id+": "+bo.name,"game-count-"+bo.skillLevel+"-knowledge-"+bo.knowledgeLevel,bo.count),qe("start",!0),We()}function Re(){$(".strike-xs").html(""),wo.setProperties({status:1,save_status:0}),wo.setProperty("count",wo.count+1),Le(),wo.ga(wo.id+": "+wo.name,"play-start","user: "+vo.name),wo.ga(wo.id+": "+wo.name,"play-count",wo.count),wo.ga(wo.id+": "+wo.name,"play-count-"+wo.skillLevel+"-knowledge-"+wo.knowledgeLevel,wo.count),wo.adjustedChooseCategory()>0?h():wo.adjustedChooseSubject()>0?f():wo.adjustedChooseTopic()>0?m():wo.adjustedChooseLesson()>0?g():y({})}function We(){$o.ga($o.id+": "+$o.name,"round-start","user: "+vo.name),$o.setProperties({status:1,save_status:0}),$o.setProperty("count",$o.count+1),$o.ga($o.id+": "+$o.name,"round-count",$o.count),$o.ga($o.id+": "+$o.name,"round-count-"+$o.skillLevel+"-knowledge-"+$o.knowledgeLevel,$o.count),Re()}function Ue(){wo.addToTotal("move",1),wo.setProperty("move-strikes",wo.move.strikes+1,!0),wo.setProperty("move-remaining",wo.move.max-wo.move.total),wo.store(),wo.setProperty("hitStreak-current",0,!0),re()}function Ke(e){if($("#question-response").length){var t=parseInt($(e).data("idx")),o=parseInt($(e).data("option")),n=Ve($("#question-response-prefix").text()+$("#question-response").val(),wo.bonusQuestions.questions[t].a,!0),s=wo.bonusQuestions.questions[t].p;$("#question-response").attr("disabled","disabled"),n?($("#question-response").addClass("success"),$("#question-response").html(wo.bonusQuestions.questions[t].a),W("Correct",{type:"success","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:mo.overlayButtonDelay})):($("#question-response").addClass("fail"),$("#text-question-answer").html("Answer: "+wo.bonusQuestions.questions[t].a).removeClass("hide").addClass("show"),W(Mustache.render(Mt,{correctAnswer:wo.bonusQuestions.questions[t].a}),{type:"error","class":"process-bonus",data:{idx:t,option:o,correct:n,points:s},timeout:5e3}))}else{alert("question-response field not found.");try{ga.play("Error","bonus-input-missing","question-response input text field not found. : "+JSON.stringify(wo.bonusQuestions))}catch(a){}}}function Ve(t,o,n){var s=t,a=o;return n="undefined"!=typeof n?n:!1,s=s.trim(),a=a.trim(),s=s.toLowerCase(),a=a.toLowerCase(),n&&(s=e(s),a=e(a)),0===s.localeCompare(a)?1:0}function Xe(e,t,o){o=o||!0,wo.thwords.tls[e][t].s=o?1:0}function Ze(){rt()&&($("#game-panel-debug").css("background-color","#e8e8e8").css("color","#000").css("border","solid 1px #000").css("padding","12px"),$("#game-panel-debug").html("<b>Play</b><hr>"+JSON.stringify(wo,null,4)+"<br><br><b>Round</b><hr>"+JSON.stringify($o,null,4)+"<br><br><b>Game</b><hr>"+JSON.stringify(bo,null,4)+"<br><br><b>Settings</b><hr>"+JSON.stringify(mo,null,4)+"<br><br><b>Group</b><hr>"+JSON.stringify(yo,null,4)+"<br><br><b>User</b><hr>"+JSON.stringify(vo,null,4)+"<br><br><b>Session</b>: "+lo))}function et(e){e=e||{};var t=[],o={},n={};return $.isEmptyObject(e)||(n.id="undefined"!=typeof $(e).data("id")?$(e).data("id"):bo.id,n.name="undefined"!=typeof $(e).data("name")?$(e).data("name"):bo.name,n.lang="undefined"!=typeof $(e).data("lang")?$(e).data("lang"):bo.lang,"undefined"==typeof oo[n.lang]&&(t[t.length]="Invalid lang "+n.lang+".")),$("#start-langs").length&&(n.langs=$("#start-langs").val(),!$("#start-langs").val()||[5,6,7,8].indexOf(bo.id)>-1&&$("#start-langs").val().length<2?t[t.length]="Please select at least two langs":(n.langs=$("#start-langs").val(),o.langs=n.langs)),$("#start-user-name").length&&(o.name=$("#start-user-name").val()),$("#start-skill-level").length&&(n.skillLevel=parseInt($("#start-skill-level").val())),$("#start-knowledge-level").length&&(n.knowledgeLevel=parseInt($("#start-knowledge-level").val())),$("#start-choose-category").length&&(n["category-choose"]=ot(parseInt($("#start-choose-category").val()),bo.id)),$("#start-choose-subject").length&&(n["subject-choose"]=st(parseInt($("#start-choose-subject").val()),bo.id)),$("#start-choose-topic").length&&(n["topic-choose"]=at(parseInt($("#start-choose-topic").val()),bo.id)),$("#start-choose-lesson").length&&(n["lesson-choose"]=nt(parseInt($("#start-choose-lesson").val()),bo.id)),$("#start-bonus-on").length&&(n["bonus-on"]=parseInt($("#start-bonus-on").val())),t.length?(alert(t.join("\n\n")),!1):($.isEmptyObject(o)||(vo.setProperties(o),vo.ga("User","start","user:"+vo.name)),$.isEmptyObject(n)||(wo.setProperties(n,!0),"undefined"!=typeof n.id&&bo.ga(bo.id+": "+bo.name,"game-user","user: "+vo.name)),tt(),Ze(),!0)}function tt(){$("#embed-link").val(x()),$("#link-link").val(q({s:1}))}function ot(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function nt(e,t){return e=parseInt(e),t=t||!1,0}function st(e,t){return e=parseInt(e),t=t||!1,t&&e&&[1,3].indexOf(t)>=0?e:e}function at(e,t){return e=parseInt(e),t=t||!1,e}function it(){wo.ga(wo.id+": "+wo.name,"play-win",wo.topic.id+": "+wo.topic.name),wo.ga(wo.id+": "+wo.name,"skill"+wo.skillLevel+"-knowledge"+wo.knowledgeLevel+"-play-win",wo.topic.id+": "+wo.topic.name);for(var e=0;e<wo.thwords.ans.length;e++)$("#answer-"+e+" > .aux2").removeClass("hide").addClass("show");F("chars");var t={msg:"Congratulations",score:wo.point.count,perfectScore:wo.point.count==wo.point.total?1:0},o=Mustache.render(Ct,t)+fe();U(o,{type:"success"}),wo.bonus.on>0&&l()>0?($("#btn-show-bonus").html(l()>1?"BONUS QUESTIONS":"BONUS QUESTION"),De("show-bonus",!0),qe("start")):(De("next-round",!0),Ae(),qe("start"),qe("feedback",!1))}function rt(){var e=$.cookie("debug")||0;return parseInt(e)?!0:!1}function lt(e){e&&(0==e?($.removeCookie("debug"),$("#show-debug-data").addClass("hide").removeClass("show")):($.cookie.json,$.cookie("debug",1),$("#show-debug-data").addClass("show").removeClass("hide")))}function ct(e,t,o,n){"use strict";t=t||{},o=o||{},this._initialized=!1,this._name=e,this._cookie=t.cookie||"Woggle-"+this._name,this._cookie.replace(/\W/g,""),this._parent=t.parent||{},this._autoStore=t.autoStore||1,this._initialProperties=o||{},this._validation=1,this._ts=Date.now(),this.addToCount=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToCount method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-count");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToCount method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("total")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-count","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToCount(e,t,o,n),this.updateTimeStamp(),!0)},this.addToTotal=function(e,t,o,n){if("undefined"==typeof t)return alert("No points specified for "+this._name+" property "+e+" in addToTotal method."),!1;"undefined"==typeof o&&(o=!0),"undefined"==typeof n&&(n=!0);var s=this.getPropertyName(e+"-total");if(s===!1)return alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1;var a=s.split("-");return a.length>2?(alert("Invalid "+this._name+" property "+e+" in addToTotal method."),!1):(this[a[0]][a[1]]=this[a[0]][a[1]]+t,this.reflowProperty(s),this[a[0]].hasOwnProperty("count")&&this[a[0]].hasOwnProperty("percent")&&(this[a[0]].percent=100*(this[a[0]].count/this[a[0]].total),this.reflowProperty(s.replace("-total","-percent"))),this._autoStore&&n&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.addToTotal(e,t,o,n),this.updateTimeStamp(),!0)},this.autoStore=function(e){return"undefined"!=typeof e?(this._autoStore=e,this):this._autoStore},this.ga=function(e,t,o){try{ga("send","event",e||this._name,t,o)}catch(n){}},this.getCookie=function(){return $.cookie(this._cookie)},this.getProperty=function(e){if(e.indexOf("-")>=0)var t=e.split("-");else var t=e.split("_");return this.hasOwnProperty(t[0])?2===t.length?this[t[0]].hasOwnProperty(t[1])?this[t[0]][t[1]]:(alert("2. Invalid "+this._name+" property "+e+"."),null):this[e]:(alert("Invalid "+this._name+" property "+e+"."),null)},this.getPropertyName=function(e,t){"undefined"==typeof t&&(t=!0);for(var e=e.replace("_","-"),o=!1,n=0;n<this._initialProperties.length;n++)if(e===this._initialProperties[n][0]||"undefined"!=typeof this._initialProperties[n][2]&&e===this._initialProperties[n][2]){o=this._initialProperties[n][0];break}if(o!==!1&&t){var s=o.split("-");if(2===s.length){if(!this.hasOwnProperty(s[0])||!this[s[0]].hasOwnProperty(s[1]))return!1}else if(!this.hasOwnProperty(s[0]))return!1}return o},this.load=function(e){if(e=e||[],!$.isEmptyObject(e))for(var t in e)e.hasOwnProperty(t)&&this.setProperty(t,e[t],!1,!1);this._autoStore&&this.store()},this.name=function(e){return"undefined"!=typeof e?(this._name=e,this):this._name},this.parseJSON=function(e){e=e||!1;for(var t={},o=0;o<this._initialProperties.length;o++)t[e?this._initialProperties[o][2]:this._initialProperties[o][0]]=this.getProperty(this._initialProperties[o][0]);return t},this.push=function(e,t,o){o=o||!1;var n=this.getPropertyName(e);if(n===!1)return alert("Invalid "+this._name+" property "+e+" in append method."),!1;var s=n.split("-");if(2===s.length){if(this[s[0]][s[1]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][s[1]][this[s[0]][s[1]].length]=t,this[s[0]][s[1]].length>100&&this[s[0]][s[1]].length.shift(),this.reflowProperty(n)}else{if(this[s[0]].constructor!==Array)return alert(this._name+" property "+e+" in append method is not an array."),!1;this[s[0]][this[s[0]].length]=t,this[s[0]].length>100&&this[s[0]].length.shift(),this.reflowProperty(n)}return this._autoStore&&this.store(),o&&!$.isEmptyObject(this._parent)&&this._parent.push(e,t,o),this.updateTimeStamp(),!0},this.reflow=function(){for(var e=0;e<this._initialProperties.length;e++)this.reflowProperty(this._initialProperties[e][0])},this.reflowProperty=function(e){var t=this.getPropertyName(e);if(t!==!1){var o=this.getProperty(t);$("."+this._name+"-"+t).text(o)}},this.setProperties=function(e,t){"undefined"==typeof t&&(t=!0);var o=!1;for(var n in e)e.hasOwnProperty(n)&&(o=this.setProperty(n,e[n],t,!1)||o);return o&&this._autoStore&&this.store(),this.updateTimeStamp(),o},this.setProperty=function(e,t,o,n){"undefined"==typeof o&&(o=!1),"undefined"==typeof n&&(n=!0);var s=!1,a=this.getPropertyName(e,!1);if(a===!1)return this._validation>0&&alert("3. Invalid "+this._name+" property "+e+"."),s;if(a.indexOf("-")<0)var i=a.split("_");else var i=a.split("-");if(2===i.length){if(this.hasOwnProperty(i[0])){if(!this[i[0]].hasOwnProperty(i[1])&&this.initialized)return alert("5. Invalid "+this._name+" property "+e+"."),s}else{if(this._initialized)return alert("4. Invalid "+this._name+" property "+e+"."),s;this[i[0]]={}}this[i[0]][i[1]]!==t&&(s=!0),this[i[0]][i[1]]=t}else{if(!this.hasOwnProperty(i[0])&&this.initialized)return alert("6. Invalid "+this._name+" property "+e+"."),!1;this[i[0]]!==t&&(s=!0),this[i[0]]=t}return s&&(this.reflowProperty(e,t),n&&this._autoStore&&this.store()),o&&this.hasOwnProperty("_parent")&&"undefined"!=typeof this._parent.setProperty&&this._parent.setProperty(e,t,o,n),this.updateTimeStamp(),s},this.store=function(){var e=new Date;e.setTime(e.getTime()+63072e6),$.cookie.json,$.cookie(this._cookie,this.stringify(!0),{path:"/",expires:e})},this.stringify=function(e){return JSON.stringify(this.parseJSON(e||!1))},this.updateTimeStamp=function(){this._ts=Date.now(),"undefined"!=typeof this.timeStamp&&(this.timeStamp=this._ts)},this.validationOff=function(){this._validation=0},this.validationOn=function(){this._validation=1};for(var s=0;s<this._initialProperties.length;s++)this.setProperty(this._initialProperties[s][0],this._initialProperties[s][1],!1,!1);"undefined"!=typeof n?this.load(n):this._autoStore&&this.store(),this._initialized=!0,this.updateTimeStamp()}if(lt(M("debug")||!1),r(),"undefined"==typeof woggle||$.isEmptyObject(woggle))return $("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1;if("undefined"==typeof woggle.game||"undefined"==typeof woggle.game.id){try{mo.ga("Error","invalid-woggle",document.location.href+", woggle: "+woggle.stringify())}catch(dt){}return alert("Invalid woggle object."),$("#container-initializing").removeClass("show").addClass("hide"),$("#container-content").removeClass("hide").addClass("show"),!1}var ut=!1,pt="1.0.2",ht=2015,gt=[{id:1,name:"Thwords",shortName:"Thwords",abbrev:"TH",slug:"thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:2,name:"Thword Plays",shortName:"Thword Plays",abbrev:"TP",slug:"thword-plays",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:3,name:"Anti-Thwords",shortName:"Anti-Thwords",abbrev:"AT",slug:"anti-thwords",description:null,details:null,lang:"en",random:0,category_choose:0,subject_choose:0,topic_choose:0,lesson_choose:0,bonus_on:0,save_on:0},{id:4,name:"Foreign Thwords",shortName:"Foreign Thwords",abbrev:"FT",slug:"foreign-thwords",description:null,details:null,lang:"es",random:0,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:5,name:"Random Thwords",shortName:"Random Thwords",abbrev:"RT",slug:"random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:0,save_on:0},{id:6,name:"Random Foreign Thwords",shortName:"Random Foreign",abbrev:"RFT",slug:"random-foreign-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:7,name:"Totally Random Thwords",shortName:"Totally Random",abbrev:"TRT",slug:"totally-random-thwords",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1},{id:8,name:"Language Drills",shortName:"Language Drills",abbrev:"LD",slug:"language-drills",description:null,details:null,lang:"en",random:1,category_choose:0,subject_choose:0,topic_choose:1,lesson_choose:0,bonus_on:1,save_on:1}],ft={overlayBackgroundOpacity:.5},mt=document.getElementById("about-template").innerHTML,vt=document.getElementById("answers-template").innerHTML,yt=document.getElementById("char-rack-template").innerHTML,bt=document.getElementById("choose-category-template").innerHTML,$t=document.getElementById("choose-lesson-template").innerHTML,wt=document.getElementById("choose-subject-template").innerHTML,kt=document.getElementById("choose-topic-template").innerHTML,Ct=document.getElementById("congrats-msg-template").innerHTML,xt=document.getElementById("end-of-game-overlay-template").innerHTML,jt=document.getElementById("game-save-template").innerHTML,Tt=document.getElementById("game-stats-template").innerHTML,Ot=document.getElementById("general-feedback-template").innerHTML,Lt=document.getElementById("help-template").innerHTML,Pt=document.getElementById("high-scores-template").innerHTML,St=(document.getElementById("initializing-template").innerHTML,
    document.getElementById("loading-template").innerHTML),It=(document.getElementById("question-fill-in-the-blank-template").innerHTML,document.getElementById("question-multiple-choice-template").innerHTML),Dt=(document.getElementById("question-multi-select-template").innerHTML,document.getElementById("question-sequence-template").innerHTML,document.getElementById("question-text-template").innerHTML),_t=document.getElementById("round-stats-template").innerHTML,Et=document.getElementById("settings-template").innerHTML,qt=document.getElementById("start-settings-template").innerHTML,Nt=document.getElementById("tile-rack-template").innerHTML,Qt=document.getElementById("tile-values-template").innerHTML,Mt=document.getElementById("wrong-answer-template").innerHTML,At=j(woggle.game.id);if($.isEmptyObject(At)){try{mo.ga("Error","undefined-game-id",document.location.href+" : "+JSON.stringify(woggle))}catch(dt){}return alert("Game "+woggle.game.id+" not defined."),!1}var Bt=A(!0),Ft=$.cookie("Woggle-settings");Ft=Ft?$.parseJSON(Ft):{};var Ht=$.cookie("Woggle-user");Ht=Ht?$.parseJSON(Ht):{};var Gt=$.cookie("Woggle-group");Gt=Gt?$.parseJSON(Gt):{};var Yt=$.cookie("Woggle-game");Yt=Yt?$.parseJSON(Yt):{};var Jt=$.cookie("Woggle-round");Jt=Jt?$.parseJSON(Jt):{};var zt=$.cookie("Woggle-play");zt=zt?$.parseJSON(zt):{};var Rt=!0;if(!($.isEmptyObject(Ft)||$.isEmptyObject(Ht)||$.isEmptyObject(Gt)||$.isEmptyObject(Yt)||$.isEmptyObject(Jt)||$.isEmptyObject(zt))&&"undefined"!=typeof Yt.id&&"undefined"!=typeof Yt.ga&&parseInt(Yt.ga)>0)if(Yt.id==woggle.game.id)Rt=!1;else{if(!confirm("You currently have an active game of "+Yt.gn+".\n\nIf you continue you will lose that game.\n\nDo you want to start this new game anyway?"))return document.location.href=Yt.ur,!1;Rt=!0}var Wt="en";"undefined"!=typeof Yt.al&&(Wt=Yt.al);var Ut=2;"undefined"!=typeof Yt.gs&&(Ut=Yt.gs);var Kt=2;"undefined"!=typeof Yt.gk&&(Kt=Yt.gk),$("#container-content").removeClass("show").addClass("hide"),$("#container-initializing").removeClass("hide").addClass("show");try{ga("send","event","Game","initialize","woggle: "+JSON.stringify(woggle))}catch(dt){}var Vt,Xt,Zt=[1,2,3,4],eo=[1,2,3],to=[6,7,8],oo={de:"German",en:"English",es:"Spanish",fr:"French",is:"Icelandic",it:"Italian",pl:"Polish",pt:"Portuguese",ru:"Russian",tr:"Turkish",uk:"Ukrainian"},no=["de","es","fr","is","it","pl","pt","ru","tr","uk"],so=[{value:1,name:"Novice",abbrev:"N"},{value:2,name:"Amateur",abbrev:"A"},{value:3,name:"Pro",abbrev:"P"},{value:4,name:"Expert",abbrev:"E"}],ao=[{value:0,name:"Elementary",abbrev:"el"},{value:1,name:"High School",abbrev:"hs"},{value:2,name:"College",abbrev:"co"},{value:3,name:"Graduate",abbrev:"gr"},{value:4,name:"Doctorate",abbrev:"do"},{value:5,name:"Genius",abbrev:"ge"},{value:6,name:"Super Genius",abbrev:"g+"}],io=[],ro="/api/",lo=C(),co=[["sessionId",lo,"se"],["domain",document.domain,"dm"],["apiDomain",null,"ad"],["apiDomains",[document.domain],"as"],["statsDomain",null,"sd"],["showAds",0,"ads"],["overlayDivDelay",0,"odd"],["overlayButtonDelay",500,"obd"],["tileFlipDelay",300,"tfd"],["timeStamp",Date.now(),"ts"]],uo=[["sessionId",lo,"se"],["id",null,"id"],["name",null,"na"],["username",null,"un"],["email",null,"em"],["lang","en","al"],["langs",[],"ap"],["timeStamp",Date.now(),"ts"]],po=[["sessionId",lo,"se"],["id",null,"id"],["name",null,"na"],["timeStamp",Date.now(),"ts"]],ho=[["sessionId",lo,"se"],["id",-1,"id"],["status",-1,"ga"],["count",0,"go"],["name","Thwords","gn"],["shortName","Thwords","sn"],["abbrev","TH","ab"],["description",null,"gd"],["details",null,"gt"],["slug","thwords","gg"],["url",window.location.href,"ur"],["random",0,"gr"],["lang","en","al"],["langs",no,"ap"],["knowledgeLevel",2,"gk"],["skillLevel",2,"gs"],["maxPlays",-1,"gm"],["category-choose",0,"cc"],["category-id",0,"ci"],["category-name",null,"cn"],["category-max",1,"cm"],["category-count",0,"co"],["category-played",[],"cp"],["subject-choose",0,"uc"],["subject-id",0,"ui"],["subject-name",null,"un"],["subject-max",1,"um"],["subject-count",0,"uo"],["subject-played",[],"up"],["topic-choose",0,"tc"],["topic-id",0,"ti"],["topic-name",null,"tn"],["topic-lang","en","tl"],["topic-description",null,"td"],["topic-details",null,"tt"],["topic-max",1,"tm"],["topic-count",0,"to"],["topic-played",[],"tp"],["lesson-choose",0,"lc"],["lesson-id",0,"li"],["lesson-name",null,"ln"],["lesson-max",1,"lm"],["lesson-count",0,"lo"],["lesson-played",[],"lp"],["thword-total",0,"zt"],["thword-count",0,"zc"],["thword-percent",null,"zp"],["move-max",0,"mm"],["move-total",0,"mt"],["move-count",0,"mc"],["move-percent",null,"mp"],["move-strikes",0,"mx"],["move-remaining",0,"mr"],["point-total",0,"pt"],["point-count",0,"pc"],["point-percent",null,"pp"],["bonus-on",1,"pb"],["bonus-total",0,"bt"],["bonus-count",0,"bc"],["bonus-value",0,"bv"],["bonus-percent",null,"bp"],["save-on",1,"ps"],["save-status",-1,"sa"],["save-total",0,"st"],["save-count",0,"sc"],["save-percent",null,"sp"],["hitStreak-current",0,"hc"],["hitStreak-long",0,"hl"],["thwords",{},"tz"],["char-played",[],"ch"],["tile-flipped",[],"tf"],["quiz",{},"qz"],["survey",{},"su"],["bonusQuestions",{},"bq"],["timeStamp",Date.now(),"ts"]],go={"á":"a","à":"a","ä":"a","â":"a","å":"a","æ":"a","α":"a","ã":"a","ç":"c","é":"e","è":"e","ë":"e","ê":"e","ε":"e","η":"e","ğ":"g","í":"i","ì":"i","ï":"i","î":"i","ι":"i","ı":"i","ñ":"n","ó":"o","ò":"o","ö":"o","ô":"o","œ":"o","ο":"o","ω":"o","ø":"o","õ":"o","ş":"s","ú":"u","ù":"u","ü":"u","û":"u","υ":"u","ÿ":"y"};if(Rt){for(var fo in At)At.hasOwnProperty(fo)&&"undefined"==typeof woggle.game[fo]&&(woggle.game[fo]=At[fo]);var mo=new ct("settings",{},co,Ft);$.isEmptyObject(woggle.settings)||$.each(woggle.settings,function(e,t){mo.setProperty(e,t)});var vo=new ct("user",{},uo,Ht),yo=new ct("group",{},po,Gt),bo=new ct("game",{},ho,woggle.game||{}),$o=new ct("round",{parent:bo},ho,woggle.game||{}),wo=new ct("play",{parent:$o},ho,woggle.game||{});wo.setProperty("lang",Wt,!0),wo.setProperty("skillLevel",Ut,!0),wo.setProperty("knowledgeLevel",Kt,!0)}else var mo=new ct("settings",{},co,Ft),vo=new ct("user",{},uo,Ht),yo=new ct("group",{},po,Gt),bo=new ct("game",{},ho,Yt),$o=new ct("round",{parent:bo},ho,Jt),wo=new ct("play",{parent:$o},ho,zt);mo.getApiDomain=function(){return this.apiDomain?this.apiDomain:this.nextApiDomain()},mo.nextApiDomain=function(){if(0===this.apiDomains.length)return mo._validation&&(mo.ga("Error","no-apiDomains-specified",document.location.href),alert("No apiDomains specified.")),null;if(1!==this.apiDomains.length&&this.apiDomain){for(var e=0;e<this.apiDomains.length;e++)if(this.apiDomains[e]===this.apiDomain){this.apiDomain=e+1<this.apiDomains.length?this.apiDomains[e+1]:this.apiDomains[0];break}return this.apiDomain}return this.setProperty("apiDomain",this.apiDomains[0]),this.apiDomain},mo.getStatsDomain=function(){return this.statsDomain?this.statsDomain:this.getApiDomain()},wo.adjustedBonusOn=function(){return bo.point.total>1e3?wo.bonus.on:bo.point.total>2e3?0:wo.bonus.on},wo.adjustedChooseCategory=function(){return bo.point.total>2e3?0:wo.category.choose},wo.adjustedChooseLesson=function(){return bo.point.total>2e3?0:wo.lesson.choose},wo.adjustedChooseSubject=function(){return bo.point.total>2e3?0:wo.subject.choose},wo.adjustedChooseTopic=function(){return bo.point.total>2e3?0:wo.topic.choose},wo.adjustedKnowledgeLevel=function(){return bo.point.total>1e3?this.knowledgeLevel<3?this.knowledgeLevel+1:this.knowledgeLevel:bo.point.total>2500?4:this.knowledgeLevel},wo.adjustedSkillLevel=function(){return bo.point.total>1e3?this.skillLevel<3?this.skillLevel+1:this.skillLevel:bo.point.total>2500?4:this.skillLevel},wo.generateQuestion=function(e,t,o){o=o||{};var n="undefined"!=typeof o.points?o.points:1,s={t:"undefined"!=typeof o.qType?o.qType:"mc",q:e,a:null,o:[],c:null,p:n};if(t.constructor.toString().indexOf("Array")>-1){if("undefined"==typeof o.idx)return this.ga("Error","generateQuestions-no-index-specified","answers: "+JSON.stringify(t)),alert("generateQuestions method no index specified, answers: "+JSON.stringify(t)),!1;if("undefined"==typeof t[o.idx])return this.ga("Error","generateQuestions-invalid-idx","answers: "+JSON.stringify(t)),alert("generateQuestions method invalid idx "+o.idx+", answers: "+JSON.stringify(t)),!1;switch(s.a=t[o.idx],s.t){case"tx":s.a=e,s.q=t[o.idx];break;case"tf":case"yn":if(Math.random()<.5)s.c=0,s.q=s.q+" = "+s.a;else{s.c=1;var a="",i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=Je(i);for(var r=0;r<i.length;r++)i[r].idx!=o.idx&&(a=i[r].label);s.q=s.q+" = "+a}s.o="tf"==s.t?["True","False"]:["Yes","No"];break;case"mc":default:if(v(t))return!1;var i=[];$.each(t,function(e,t){i[i.length]={idx:e,label:t}}),i=Je(i);for(var r=0;r<i.length;r++)s.o[s.o.length]=i[r].label,i[r].idx==o.idx&&(s.c=r)}}else s.t="tx",s.a=t;return s},wo.generateBonusQuestions=function(){if(this.bonusQuestions={},this.bonusQuestions.questions=[],!$.isEmptyObject(wo)&&!$.isEmptyObject(this.thwords)&&"undefined"!=typeof this.thwords.ans&&this.thwords.ans.length>1&&"undefined"!=typeof this.thwords.aux1&&this.thwords.ans.length===this.thwords.aux1.length)if(4==this.id)try{for(var e=[],t=0;t<this.thwords.ans.length;t++){var o=this.generateQuestion(this.thwords.ans[t],this.thwords.aux1,{idx:t,qType:wo.getQuestionType(this.thwords.ans[s],{gameId:this.id,lang:this.lang})});o!==!1&&(e[e.length]=o)}this.bonusQuestions.questions=Je(e)}catch(n){console.log(n),this.ga("Error","generateBonusQuestions: multiple",n.toString())}else try{var s=Math.floor(Math.random()*this.thwords.aux1.length);if(this.thwords.aux1[s]){var o=this.generateQuestion(this.thwords.ans[s],this.thwords.aux1,{idx:s,qType:wo.getQuestionType(this.thwords.ans[s])});o!==!1&&(this.bonusQuestions.questions=[o])}}catch(n){this.ga("Error","generateBonusQuestions: single",n.toString()),console.log(n)}this.bonusQuestions.idx=this.bonusQuestions.questions.length>0?0:9999},wo.getQuestionType=function(e,t){e=e||"",t=t||{};var o=("undefined"!=typeof t.gameId?t.gameId:-1,"undefined"!=typeof t.lang?t.lang:"en");if(2==wo.id)return"mc";if(4!=wo.id)return!1;var n=this.adjustedSkillLevel(),s=Math.random();switch(n){case 3:return.2>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=12?"tx":"mc":.4>s?"tf":"mc";case 4:return.4>s?["ru","uk"].indexOf(o)>-1?"mc":e.length<=15?"tx":"mc":.6>s?"tf":"mc";case 0:case 1:case 2:default:return.25>s?"tf":"mc"}},rt()&&(window.thwordData={settings:mo,user:vo,group:yo,game:bo,round:$o,play:wo}),oe(),tt(),1==M("s")?bo.ga(bo.id+": "+bo.name,"start-shared","url: "+document.location.href):1==M("e")?bo.ga(bo.id+": "+bo.name,"start-embed","url: "+document.location.href):bo.ga(bo.id+": "+bo.name,"start-new","url: "+document.location.href),Ze(),a(),$("#container-content").removeClass("hide").addClass("show"),$("#container-initializing").removeClass("show").addClass("hide"),Ee(),Rt?Ge():ze();var ko=function(e){var t=parseInt($(e).data("idx")),n=parseInt($(e).data("option")),s=wo.bonusQuestions.questions[t].c,a=wo.bonusQuestions.questions[t].p;if(n==s){o(a),wo.addToCount("bonus",1,!0);var i="Correct";if(["tf","yn"].indexOf(wo.bonusQuestions.questions[t].t)>-1&&wo.bonusQuestions.questions[t].c>0){i+="<p>The right answer is "+wo.bonusQuestions.questions[t].a+".</p>";var r=5e3}else var r=mo.overlayButtonDelay;$("#submit-question-answer").removeClass("show").addClass("hide"),W(i,{type:"success","class":"process-bonus",data:{idx:t,option:n,correct:s,points:a},timeout:r})}else W(Mustache.render(Mt,{correctAnswer:wo.bonusQuestions.questions[t].a}),{type:"error","class":"process-bonus",data:{idx:t,option:n,correct:s,points:a},timeout:0})},Co=function(e){if("undefined"==typeof $(e).data("category-id"))return alert("No category selected."),!1;if(parseInt($(e).data("category-id"))>0)var t=parseInt($(e).data("category-id")),o=$(e).text();else var t=0,o="WILD CARD";wo.ga(wo.id+": "+wo.name,"category-select",t+": "+o);try{wo.adjustedChooseSubject()>0?f():wo.adjustedChooseTopic()>0?m():y({category_id:t})}catch(n){console.log(n),mo.ga("Error","selectCategory",n.toString())}},xo=function(e){if("undefined"==typeof $(e).data("lesson-id"))return alert("No lesson selected."),!1;if(parseInt($(e).data("lesson-id"))>0)var t=parseInt($(e).data("lesson-id")),o=$(e).text();else var t=0,o="WILD CARD";wo.ga(wo.id+": "+wo.name,"lesson-select",t+": "+o);try{y({lesson_id:t})}catch(n){console.log(n),mo.ga("Error","selectLesson",n.toString())}},jo=function(e){if("undefined"==typeof $(e).data("subject-id"))return alert("No subject selected."),!1;if(parseInt($(e).data("subject-id"))>0)var t=parseInt($(e).data("subject-id")),o=$(e).text();else var t=0,o="WILD CARD";wo.ga(wo.id+": "+wo.name,"subject-select",t+": "+o);try{wo.adjustedChooseTopic()>0?m():y({subject_id:t})}catch(n){console.log(n),mo.ga("Error","selectSubject",n.toString())}},To=function(e){if(ke(),"undefined"==typeof $(e).data("topic-id"))return alert("No topic selected."),!1;if(parseInt($(e).data("topic-id"))>0)var t=parseInt($(e).data("topic-id")),o=$(e).text();else var t=0,o="WILD CARD";wo.ga(wo.id+": "+wo.name,"topic-select",t+": "+o);try{y({topic_id:t})}catch(n){console.log(n),mo.ga("Error","selectTopic",n.toString())}},Oo=function(e){var t=$(e).data("idx")||!1;try{if(t)if($(e).hasClass("chosen"));else{$(e).addClass("chosen");var o=wo.thwords.chs[t].v,n=J(t);if(n>0){var o=o*n,s=n+(1==n?" match!":" matches!");s+="<br>"+o+(1==o?" point.":" points."),W(s,{type:"success","class":"process-char",data:{idx:t},timeout:mo.overlayButtonDelay,opacity:!1})}else{var a=Math.abs(o-11),s="Strike!";s+="<br>You lose "+a+(1==a?" point":" points."),W(s,{type:"fail","class":"process-char",data:{idx:t},timeout:mo.overlayButtonDelay,opacity:!1})}}else alert("No index.")}catch(i){console.log(i),mo.ga("Error","selectChar",i.toString())}}}()});